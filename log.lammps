LAMMPS (15 Sep 2022)
### command to run:

### basic setting
units		metal
dimension	3
boundary	p p p # y need to be periodic, otherwise the empty region of the simulation box will be removed
atom_style	atomic
atom_modify map array
comm_style tiled # for load balancing we need tiled

### neighbor setting
neighbor	2 bin

### global variables
variable nrun equal 4
variable ndump equal 2
variable nThermo equal 1
variable nrunIdle equal 0*${nrun}
variable nrunIdle equal 0*4

### set these parameters correctly, rest will be compited accordingly
variable Height equal 50 # Height of the newly created region.
variable lx equal 301 # add 1 so that 'floor' functions behave accordingly. lx>${DistanceLaserShot} for Laser
variable ly equal 501
variable lz equal 3
variable random01 equal random(0,1,123456)

lattice		fcc 3.52 orient x 1 0 0 orient y 0 1 0 orient z 0 0 1
Lattice spacing in x,y,z = 3.52 3.52 3.52

region		box block 0 ${lx} ${Height} ${ly} 0 ${lz}
region		box block 0 301 ${Height} ${ly} 0 ${lz}
region		box block 0 301 50 ${ly} 0 ${lz}
region		box block 0 301 50 501 0 ${lz}
region		box block 0 301 50 501 0 3
create_box	2 box
Created orthogonal box = (0 176 0) to (1059.52 1763.52 10.56)
  2 by 3 by 1 MPI processor grid
### Initial atomic region
region		BlockInitial block INF INF 45 200 INF INF

###create_atoms
#create_atoms	1 box
#delete_atoms group all
create_atoms	1 region BlockInitial
Created 543606 atoms
  using lattice units in orthogonal box = (0 176 0) to (1059.52 1763.52 10.56)
  create_atoms CPU = 0.097 seconds
mass	1 58.71
mass	2 58.71

### create other regions, dummy. So that it can be deleted in the recurssive block
variable y1 equal ${Height}
variable y1 equal 50
variable y2 equal 3*${Height}
variable y2 equal 3*50
variable y3 equal 4*${Height}
variable y3 equal 4*50
variable y_Inside equal ${y1}+2
variable y_Inside equal 50+2
variable z2 equal 0.0
variable z3 equal ${lz}
variable z3 equal 3
region		BlockDeleteAtomsBottom_01 block INF INF INF ${y1} INF INF
region		BlockDeleteAtomsBottom_01 block INF INF INF 50 INF INF
group GroupDeleteAtomsBottom_01 region BlockDeleteAtomsBottom_01
1806 atoms in group GroupDeleteAtomsBottom_01
region		BlockCreateAtomsTop_01 block INF INF ${y2} ${y3} INF INF
region		BlockCreateAtomsTop_01 block INF INF 150 ${y3} INF INF
region		BlockCreateAtomsTop_01 block INF INF 150 200 INF INF
group GroupCreateAtomsTop_01 region BlockCreateAtomsTop_01
182406 atoms in group GroupCreateAtomsTop_01
region		BlockInside block INF INF ${y_Inside} INF INF INF
region		BlockInside block INF INF 52 INF INF INF
group GroupInside region BlockInside
536382 atoms in group GroupInside

variable nAtomsAll equal count(all)
variable nAtomsInitial equal ${nAtomsAll}
variable nAtomsInitial equal 543606
print "nAtomsInitial: ${nAtomsInitial}"
nAtomsInitial: 543606
variable nAtomsNew equal count(GroupCreateAtomsTop_01)
variable nAtomsDelete equal count(GroupDeleteAtomsBottom_01)

### EAM potentials
pair_style	eam/alloy
#pair_coeff      * * /home/schakraborty/MyRepository/LAMMPS_02/potentials/NiAlH_jea.eam.alloy Ni Ni  # in GUIDO
pair_coeff     * * /mnt/f/MyRepositories/LAMMPS_02/potentials/NiAlH_jea.eam.alloy Ni Ni  # in WSL
Reading eam/alloy potential file /mnt/f/MyRepositories/LAMMPS_02/potentials/NiAlH_jea.eam.alloy with DATE: 2007-11-30

### initial velocities
variable T equal 800
variable T2 equal 2*$T # put twice the desired system temperature
variable T2 equal 2*800 
compute	  	Temperature all temp
velocity	all create ${T2} 187723 temp Temperature
velocity	all create 1600 187723 temp Temperature

### compute
### CNA and centro in region all, dump 2 times, 1 in all, 1 in dumpregion
compute		CNA all cna/atom 3.00
compute		CENTRO all centro/atom fcc
compute		PE all pe/atom
compute		KE all ke/atom
compute		stress all stress/atom Temperature
compute		p all pressure Temperature

### Compute temperature
variable TotalKE equal ke(GroupCreateAtomsTop_01)
variable Temp02 equal (v_TotalKE/(v_nAtomsNew*8.6*1.0e-05))*(2/3)  # KE=(dim/2)*N*K_b*T);)K_b = 8.6*1.0e-05 eV/K


### run
timestep	0.005
thermo		${nThermo}
thermo		1
thermo_style	custom step temp pe ke v_Temp02

####minimize the system energy and press, statistic equilibirum
#fix		systemminimize all box/relax iso 0 nreset 5 vmax 0.001
#minimize	1E-10 1E-10 2000 2000

###define fix
fix             1 all npt temp $T $T 0.2 drag 0.5 x 0.0 0.0 5 z 0.0 0.0 5 couple none
fix             1 all npt temp 800 $T 0.2 drag 0.5 x 0.0 0.0 5 z 0.0 0.0 5 couple none
fix             1 all npt temp 800 800 0.2 drag 0.5 x 0.0 0.0 5 z 0.0 0.0 5 couple none
#fix 1 all nve

dump	dumpCFG all cfg ${ndump} dump_*.cfg mass type xs ys zs id c_CNA c_PE c_KE vy fy
dump	dumpCFG all cfg 2 dump_*.cfg mass type xs ys zs id c_CNA c_PE c_KE vy fy
dump_modify dumpCFG first yes

dump	dump02 all custom ${ndump} dump_*.dump id mass type xs ys zs id c_CNA c_PE c_KE vy fy
dump	dump02 all custom 2 dump_*.dump id mass type xs ys zs id c_CNA c_PE c_KE vy fy
dump_modify dump02 first yes

### to output in a file using 'fix print'
variable Step equal step
variable Temp equal temp
variable PE equal pe
variable KE equal ke
fix extra all print ${nThermo} "${Step} ${Temp} ${PE} ${KE} ${Temp02}" 		file Output_Thermo.out screen no title "${Step} ${Temp} ${PE} ${KE} ${Temp02}"
fix extra all print 1 "${Step} ${Temp} ${PE} ${KE} ${Temp02}" 		file Output_Thermo.out screen no title "${Step} ${Temp} ${PE} ${KE} ${Temp02}"

balance 1.1 rcb  # load balancing
Balancing ...
Neighbor list info ...
  update: every = 1 steps, delay = 10 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 7.65
  ghost atom cutoff = 7.65
  binsize = 3.825, bins = 277 416 3
  3 neighbor lists, perpetual/occasional/extra = 1 2 0
  (1) pair eam/alloy, perpetual
      attributes: half, newton on
      pair build: half/bin/atomonly/newton
      stencil: half/bin/3d
      bin: standard
  (2) compute cna/atom, occasional
      attributes: full, newton on
      pair build: full/bin/atomonly
      stencil: full/bin/3d
      bin: standard
  (3) compute centro/atom, occasional
      attributes: full, newton on
      pair build: full/bin/atomonly
      stencil: full/bin/3d
      bin: standard
 rebalancing time: 0.305 seconds
  iteration count = 0
  initial/final maximal load/proc = 271803 90601
  initial/final imbalance factor  = 3 1

run ${nrun}  # Dynamics equiulibriation
run 4  
Per MPI rank memory allocation (min/avg/max) = 225.1 | 232.7 | 247.5 Mbytes
   Step          Temp          PotEng         KinEng        v_Temp02   
         0   1600          -2416145.4      112426.34      1605.4458    
         1   1529.5229     -2411188.5      107474.16      1534.7999    
         2   1334.7852     -2397443.9      93790.63       1339.6083    
         3   1061.8599     -2378077.4      74613.136      1066.0411    
         4   774.07854     -2357613.1      54391.759      777.5612     
Loop time of 5.96587 on 6 procs for 4 steps with 543606 atoms

Performance: 0.290 ns/day, 82.859 hours/ns, 0.670 timesteps/s
94.7% CPU use with 6 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 1.7748     | 1.79       | 1.8081     |   0.9 | 30.00
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.035575   | 0.047367   | 0.063409   |   3.9 |  0.79
Output  | 4.0345     | 4.0346     | 4.0346     |   0.0 | 67.63
Modify  | 0.079906   | 0.088492   | 0.1033     |   3.4 |  1.48
Other   |            | 0.005483   |            |       |  0.09

Nlocal:          90601 ave       91203 max       90000 min
Histogram: 2 0 0 0 2 0 0 0 0 2
Nghost:         157754 ave      161247 max      152962 min
Histogram: 2 0 0 0 0 0 0 1 2 1
Neighs:    7.93015e+06 ave 7.98435e+06 max 7.89965e+06 min
Histogram: 4 0 0 0 0 0 0 0 0 2
FullNghs:  1.58603e+07 ave 1.59657e+07 max 1.57548e+07 min
Histogram: 2 0 0 0 0 2 0 0 0 2

Total # of neighbors = 95161752
Ave neighs/atom = 175.05648
Neighbor list builds = 0
Dangerous builds = 0
reset_timestep 0

unfix 1
#fix 1 GroupInside nve
fix  1 GroupInside npt temp $T $T 0.2 drag 0.5 x 0.0 0.0 5 z 0.0 0.0 5 couple none
fix  1 GroupInside npt temp 800 $T 0.2 drag 0.5 x 0.0 0.0 5 z 0.0 0.0 5 couple none
fix  1 GroupInside npt temp 800 800 0.2 drag 0.5 x 0.0 0.0 5 z 0.0 0.0 5 couple none
fix fPushParticles GroupCreateAtomsTop_01 addforce 0.0 0.0 0.0 every 1
fix fLangevin GroupDeleteAtomsBottom_01 langevin ${T} ${T} 0.2 123456
fix fLangevin GroupDeleteAtomsBottom_01 langevin 800 ${T} 0.2 123456
fix fLangevin GroupDeleteAtomsBottom_01 langevin 800 800 0.2 123456
run ${nrun}
run 4
Per MPI rank memory allocation (min/avg/max) = 225.1 | 232.7 | 247.5 Mbytes
   Step          Temp          PotEng         KinEng        v_Temp02   
         0   774.07854     -2357613.1      54391.759      777.5612     
         1   539.60387     -2340924.7      37916.054      539.39501    
         2   399.84261     -2331035.4      28095.525      397.32496    
         3   368.06128     -2328882.9      25862.363      364.88839    
         4   424.01234     -2332990.7      29793.847      421.57737    
Loop time of 5.88292 on 6 procs for 4 steps with 543606 atoms

Performance: 0.294 ns/day, 81.707 hours/ns, 0.680 timesteps/s
97.0% CPU use with 6 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 1.5339     | 1.5601     | 1.5855     |   1.2 | 26.52
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.026283   | 0.046669   | 0.06174    |   5.2 |  0.79
Output  | 4.1893     | 4.1893     | 4.1893     |   0.0 | 71.21
Modify  | 0.074872   | 0.080407   | 0.090254   |   2.4 |  1.37
Other   |            | 0.006403   |            |       |  0.11

Nlocal:          90601 ave       91182 max       90017 min
Histogram: 1 1 0 0 0 1 2 0 0 1
Nghost:         157754 ave      161268 max      152713 min
Histogram: 2 0 0 0 0 0 0 1 2 1
Neighs:    7.84948e+06 ave 7.90232e+06 max 7.82316e+06 min
Histogram: 2 0 2 0 1 0 0 0 0 1
FullNghs:   1.5699e+07 ave 1.58001e+07 max  1.5618e+07 min
Histogram: 1 0 1 1 0 2 0 0 0 1

Total # of neighbors = 94193770
Ave neighs/atom = 173.27581
Neighbor list builds = 0
Dangerous builds = 0

print "*****LAMMPS Initilization DONE******"
*****LAMMPS Initilization DONE******

### to run AM script in loop
label labelSetAMLoop
variable nLoop equal floor((${ly}-${y3})/${Height})
variable nLoop equal floor((501-${y3})/${Height})
variable nLoop equal floor((501-200)/${Height})
variable nLoop equal floor((501-200)/50)
print "Total AM Loop: ${nLoop}"
Total AM Loop: 6
variable loop01 loop ${nLoop}
variable loop01 loop 6
label labelAMLoop
print "loop: ${loop01}"
loop: 1
next loop01
jump script_LAMMPS_AM.inp
### command to run recurssively for AM simulation
### Delete previous fix, region, group etc. before redefining

### delete the bottom atom righ at the begining and reassign before the next run for T-control
delete_atoms region BlockDeleteAtomsBottom_01
Deleted 0 atoms, new total = 543606

unfix 1
unfix fPushParticles
unfix fLangevin
region BlockInside delete
group GroupInside delete
region BlockDeleteAtomsBottom_01 delete
group GroupDeleteAtomsBottom_01 delete
region BlockCreateAtomsTop_01 delete
group GroupCreateAtomsTop_01 delete

variable delta_y equal (step/${nrun})*${Height}
variable delta_y equal (step/4)*${Height}
variable delta_y equal (step/4)*50
if "${nAtomsAll} > ${nAtomsInitial}" then "variable y1 equal ${y1}+${Height}" # This will make sure that total number of atom is close to initial atoms
variable y2 equal ${y2}+${Height}
variable y2 equal 150+${Height}
variable y2 equal 150+50
variable y3 equal ${y3}+${Height}
variable y3 equal 200+${Height}
variable y3 equal 200+50
variable y_Inside equal ${y1}+2
variable y_Inside equal 50+2

### update other regions
region		BlockDeleteAtomsBottom_01 block INF INF INF ${y1} INF INF # delete all atom down the interface
region		BlockDeleteAtomsBottom_01 block INF INF INF 50 INF INF 
region		BlockCreateAtomsTop_01 block INF INF ${y2} ${y3} INF INF
region		BlockCreateAtomsTop_01 block INF INF 200 ${y3} INF INF
region		BlockCreateAtomsTop_01 block INF INF 200 250 INF INF
region		BlockInside block INF INF ${y_Inside} INF INF INF
region		BlockInside block INF INF 52 INF INF INF

###----create atoms i.e, spherical powder particles in a loop-----
print "*** Powder particle creation begins***"
*** Powder particle creation begins***
variable nParticles equal floor(${lx}/(${Height})) # square box shaped
variable nParticles equal floor(301/(${Height})) 
variable nParticles equal floor(301/(50)) 
variable radiusIdeal equal ${Height}/2
variable radiusIdeal equal 50/2
variable vloopParticle loop ${nParticles}
variable vloopParticle loop 6
label labelParticleCreation
print "Grain creation loop: ${vloopParticle}"
Grain creation loop: 1
variable perturb01 equal v_random01
if "(${vloopParticle} == 0) || (${vloopParticle} == ${nParticles})" then "variable perturb01 equal 0.00"

variable radius equal (0.75+0.25*${perturb01})*${radiusIdeal}
variable radius equal (0.75+0.25*0.543193161487579)*${radiusIdeal}
variable radius equal (0.75+0.25*0.543193161487579)*25
variable temp01 equal ${perturb01}*${radiusIdeal}  #((step/${nrun})%2)*${radius}
variable temp01 equal 0.652336478233337*${radiusIdeal}  
variable temp01 equal 0.652336478233337*25  
variable temp02 equal 2*${radiusIdeal}*(${vloopParticle}-1)+${radiusIdeal}
variable temp02 equal 2*25*(${vloopParticle}-1)+${radiusIdeal}
variable temp02 equal 2*25*(1-1)+${radiusIdeal}
variable temp02 equal 2*25*(1-1)+25
variable cx equal ${temp01}+${temp02} #((step/${nrun})%2)*10 + 100*${vloopParticle} - 50
variable cx equal 16.3084119558334+${temp02} 
variable cx equal 16.3084119558334+25 
variable cy equal (${y2}+${y3})/2
variable cy equal (200+${y3})/2
variable cy equal (200+250)/2
variable cz equal (${z2}+${z3})/2
variable cz equal (0+${z3})/2
variable cz equal (0+3)/2
print "Grain parameters cx: ${cx} cy: ${cy} cz: ${cz} radius: ${radius}"
Grain parameters cx: 41.3084119558334 cy: 225 cz: 1.5 radius: 22.1449572592974
region Particle sphere ${cx} ${cy} ${cz} ${radius}
region Particle sphere 41.3084119558334 ${cy} ${cz} ${radius}
region Particle sphere 41.3084119558334 225 ${cz} ${radius}
region Particle sphere 41.3084119558334 225 1.5 ${radius}
region Particle sphere 41.3084119558334 225 1.5 22.1449572592974

create_atoms 1 region Particle
Created 21530 atoms
  using lattice units in orthogonal box = (-0.038088577 176 -0.00037930073) to (1059.5581 1763.52 10.560379)
  create_atoms CPU = 0.013 seconds
group Particle region Particle
21530 atoms in group Particle

variable theta_z equal ${random01}*90  # angle to rotate the grain
variable theta_z equal 0.612226366996765*90  
displace_atoms Particle rotate ${cx} ${cy} ${cz} 0 0 1 ${theta_z} # rotate wrt z-axis
displace_atoms Particle rotate 41.3084119558334 ${cy} ${cz} 0 0 1 ${theta_z} 
displace_atoms Particle rotate 41.3084119558334 225 ${cz} 0 0 1 ${theta_z} 
displace_atoms Particle rotate 41.3084119558334 225 1.5 0 0 1 ${theta_z} 
displace_atoms Particle rotate 41.3084119558334 225 1.5 0 0 1 55.1003730297089 
Displacing atoms ...

group GroupCreateAtomsTop_01 union GroupCreateAtomsTop_01 Particle
21530 atoms in group GroupCreateAtomsTop_01
region Particle delete
group Particle delete

next vloopParticle
jump SELF labelParticleCreation
print "Grain creation loop: ${vloopParticle}"
Grain creation loop: 2
variable perturb01 equal v_random01
if "(${vloopParticle} == 0) || (${vloopParticle} == ${nParticles})" then "variable perturb01 equal 0.00"

variable radius equal (0.75+0.25*${perturb01})*${radiusIdeal}
variable radius equal (0.75+0.25*0.619038879871368)*${radiusIdeal}
variable radius equal (0.75+0.25*0.619038879871368)*25
variable temp01 equal ${perturb01}*${radiusIdeal}  #((step/${nrun})%2)*${radius}
variable temp01 equal 0.0782623291015625*${radiusIdeal}  
variable temp01 equal 0.0782623291015625*25  
variable temp02 equal 2*${radiusIdeal}*(${vloopParticle}-1)+${radiusIdeal}
variable temp02 equal 2*25*(${vloopParticle}-1)+${radiusIdeal}
variable temp02 equal 2*25*(2-1)+${radiusIdeal}
variable temp02 equal 2*25*(2-1)+25
variable cx equal ${temp01}+${temp02} #((step/${nrun})%2)*10 + 100*${vloopParticle} - 50
variable cx equal 1.95655822753906+${temp02} 
variable cx equal 1.95655822753906+75 
variable cy equal (${y2}+${y3})/2
variable cy equal (200+${y3})/2
variable cy equal (200+250)/2
variable cz equal (${z2}+${z3})/2
variable cz equal (0+${z3})/2
variable cz equal (0+3)/2
print "Grain parameters cx: ${cx} cy: ${cy} cz: ${cz} radius: ${radius}"
Grain parameters cx: 76.9565582275391 cy: 225 cz: 1.5 radius: 22.618992999196
region Particle sphere ${cx} ${cy} ${cz} ${radius}
region Particle sphere 76.9565582275391 ${cy} ${cz} ${radius}
region Particle sphere 76.9565582275391 225 ${cz} ${radius}
region Particle sphere 76.9565582275391 225 1.5 ${radius}
region Particle sphere 76.9565582275391 225 1.5 22.618992999196

create_atoms 1 region Particle
Created 22454 atoms
  using lattice units in orthogonal box = (-0.038088577 176 -0.00037930073) to (1059.5581 1763.52 10.560379)
  create_atoms CPU = 0.015 seconds
group Particle region Particle
24794 atoms in group Particle

variable theta_z equal ${random01}*90  # angle to rotate the grain
variable theta_z equal 0.358080863952637*90  
displace_atoms Particle rotate ${cx} ${cy} ${cz} 0 0 1 ${theta_z} # rotate wrt z-axis
displace_atoms Particle rotate 76.9565582275391 ${cy} ${cz} 0 0 1 ${theta_z} 
displace_atoms Particle rotate 76.9565582275391 225 ${cz} 0 0 1 ${theta_z} 
displace_atoms Particle rotate 76.9565582275391 225 1.5 0 0 1 ${theta_z} 
displace_atoms Particle rotate 76.9565582275391 225 1.5 0 0 1 32.2272777557373 
Displacing atoms ...

group GroupCreateAtomsTop_01 union GroupCreateAtomsTop_01 Particle
43984 atoms in group GroupCreateAtomsTop_01
region Particle delete
group Particle delete

next vloopParticle
jump SELF labelParticleCreation
print "Grain creation loop: ${vloopParticle}"
Grain creation loop: 3
variable perturb01 equal v_random01
if "(${vloopParticle} == 0) || (${vloopParticle} == ${nParticles})" then "variable perturb01 equal 0.00"

variable radius equal (0.75+0.25*${perturb01})*${radiusIdeal}
variable radius equal (0.75+0.25*0.803503632545471)*${radiusIdeal}
variable radius equal (0.75+0.25*0.803503632545471)*25
variable temp01 equal ${perturb01}*${radiusIdeal}  #((step/${nrun})%2)*${radius}
variable temp01 equal 0.0261417627334595*${radiusIdeal}  
variable temp01 equal 0.0261417627334595*25  
variable temp02 equal 2*${radiusIdeal}*(${vloopParticle}-1)+${radiusIdeal}
variable temp02 equal 2*25*(${vloopParticle}-1)+${radiusIdeal}
variable temp02 equal 2*25*(3-1)+${radiusIdeal}
variable temp02 equal 2*25*(3-1)+25
variable cx equal ${temp01}+${temp02} #((step/${nrun})%2)*10 + 100*${vloopParticle} - 50
variable cx equal 0.653544068336487+${temp02} 
variable cx equal 0.653544068336487+125 
variable cy equal (${y2}+${y3})/2
variable cy equal (200+${y3})/2
variable cy equal (200+250)/2
variable cz equal (${z2}+${z3})/2
variable cz equal (0+${z3})/2
variable cz equal (0+3)/2
print "Grain parameters cx: ${cx} cy: ${cy} cz: ${cz} radius: ${radius}"
Grain parameters cx: 125.653544068336 cy: 225 cz: 1.5 radius: 23.7718977034092
region Particle sphere ${cx} ${cy} ${cz} ${radius}
region Particle sphere 125.653544068336 ${cy} ${cz} ${radius}
region Particle sphere 125.653544068336 225 ${cz} ${radius}
region Particle sphere 125.653544068336 225 1.5 ${radius}
region Particle sphere 125.653544068336 225 1.5 23.7718977034092

create_atoms 1 region Particle
Created 24807 atoms
  using lattice units in orthogonal box = (-0.038088577 176 -0.00037930073) to (1059.5581 1763.52 10.560379)
  create_atoms CPU = 0.015 seconds
group Particle region Particle
24807 atoms in group Particle

variable theta_z equal ${random01}*90  # angle to rotate the grain
variable theta_z equal 0.032852828502655*90  
displace_atoms Particle rotate ${cx} ${cy} ${cz} 0 0 1 ${theta_z} # rotate wrt z-axis
displace_atoms Particle rotate 125.653544068336 ${cy} ${cz} 0 0 1 ${theta_z} 
displace_atoms Particle rotate 125.653544068336 225 ${cz} 0 0 1 ${theta_z} 
displace_atoms Particle rotate 125.653544068336 225 1.5 0 0 1 ${theta_z} 
displace_atoms Particle rotate 125.653544068336 225 1.5 0 0 1 2.95675456523895 
Displacing atoms ...

group GroupCreateAtomsTop_01 union GroupCreateAtomsTop_01 Particle
68791 atoms in group GroupCreateAtomsTop_01
region Particle delete
group Particle delete

next vloopParticle
jump SELF labelParticleCreation
print "Grain creation loop: ${vloopParticle}"
Grain creation loop: 4
variable perturb01 equal v_random01
if "(${vloopParticle} == 0) || (${vloopParticle} == ${nParticles})" then "variable perturb01 equal 0.00"

variable radius equal (0.75+0.25*${perturb01})*${radiusIdeal}
variable radius equal (0.75+0.25*0.0400077104568481)*${radiusIdeal}
variable radius equal (0.75+0.25*0.0400077104568481)*25
variable temp01 equal ${perturb01}*${radiusIdeal}  #((step/${nrun})%2)*${radius}
variable temp01 equal 0.535777807235718*${radiusIdeal}  
variable temp01 equal 0.535777807235718*25  
variable temp02 equal 2*${radiusIdeal}*(${vloopParticle}-1)+${radiusIdeal}
variable temp02 equal 2*25*(${vloopParticle}-1)+${radiusIdeal}
variable temp02 equal 2*25*(4-1)+${radiusIdeal}
variable temp02 equal 2*25*(4-1)+25
variable cx equal ${temp01}+${temp02} #((step/${nrun})%2)*10 + 100*${vloopParticle} - 50
variable cx equal 13.3944451808929+${temp02} 
variable cx equal 13.3944451808929+175 
variable cy equal (${y2}+${y3})/2
variable cy equal (200+${y3})/2
variable cy equal (200+250)/2
variable cz equal (${z2}+${z3})/2
variable cz equal (0+${z3})/2
variable cz equal (0+3)/2
print "Grain parameters cx: ${cx} cy: ${cy} cz: ${cz} radius: ${radius}"
Grain parameters cx: 188.394445180893 cy: 225 cz: 1.5 radius: 19.0000481903553
region Particle sphere ${cx} ${cy} ${cz} ${radius}
region Particle sphere 188.394445180893 ${cy} ${cz} ${radius}
region Particle sphere 188.394445180893 225 ${cz} ${radius}
region Particle sphere 188.394445180893 225 1.5 ${radius}
region Particle sphere 188.394445180893 225 1.5 19.0000481903553

create_atoms 1 region Particle
Created 15820 atoms
  using lattice units in orthogonal box = (-0.038088577 176 -0.00037930073) to (1059.5581 1763.52 10.560379)
  create_atoms CPU = 0.011 seconds
group Particle region Particle
15820 atoms in group Particle

variable theta_z equal ${random01}*90  # angle to rotate the grain
variable theta_z equal 0.0990321040153503*90  
displace_atoms Particle rotate ${cx} ${cy} ${cz} 0 0 1 ${theta_z} # rotate wrt z-axis
displace_atoms Particle rotate 188.394445180893 ${cy} ${cz} 0 0 1 ${theta_z} 
displace_atoms Particle rotate 188.394445180893 225 ${cz} 0 0 1 ${theta_z} 
displace_atoms Particle rotate 188.394445180893 225 1.5 0 0 1 ${theta_z} 
displace_atoms Particle rotate 188.394445180893 225 1.5 0 0 1 8.91288936138153 
Displacing atoms ...

group GroupCreateAtomsTop_01 union GroupCreateAtomsTop_01 Particle
84611 atoms in group GroupCreateAtomsTop_01
region Particle delete
group Particle delete

next vloopParticle
jump SELF labelParticleCreation
print "Grain creation loop: ${vloopParticle}"
Grain creation loop: 5
variable perturb01 equal v_random01
if "(${vloopParticle} == 0) || (${vloopParticle} == ${nParticles})" then "variable perturb01 equal 0.00"

variable radius equal (0.75+0.25*${perturb01})*${radiusIdeal}
variable radius equal (0.75+0.25*0.359844505786896)*${radiusIdeal}
variable radius equal (0.75+0.25*0.359844505786896)*25
variable temp01 equal ${perturb01}*${radiusIdeal}  #((step/${nrun})%2)*${radius}
variable temp01 equal 0.571093380451202*${radiusIdeal}  
variable temp01 equal 0.571093380451202*25  
variable temp02 equal 2*${radiusIdeal}*(${vloopParticle}-1)+${radiusIdeal}
variable temp02 equal 2*25*(${vloopParticle}-1)+${radiusIdeal}
variable temp02 equal 2*25*(5-1)+${radiusIdeal}
variable temp02 equal 2*25*(5-1)+25
variable cx equal ${temp01}+${temp02} #((step/${nrun})%2)*10 + 100*${vloopParticle} - 50
variable cx equal 14.27733451128+${temp02} 
variable cx equal 14.27733451128+225 
variable cy equal (${y2}+${y3})/2
variable cy equal (200+${y3})/2
variable cy equal (200+250)/2
variable cz equal (${z2}+${z3})/2
variable cz equal (0+${z3})/2
variable cz equal (0+3)/2
print "Grain parameters cx: ${cx} cy: ${cy} cz: ${cz} radius: ${radius}"
Grain parameters cx: 239.27733451128 cy: 225 cz: 1.5 radius: 20.9990281611681
region Particle sphere ${cx} ${cy} ${cz} ${radius}
region Particle sphere 239.27733451128 ${cy} ${cz} ${radius}
region Particle sphere 239.27733451128 225 ${cz} ${radius}
region Particle sphere 239.27733451128 225 1.5 ${radius}
region Particle sphere 239.27733451128 225 1.5 20.9990281611681

create_atoms 1 region Particle
Created 19324 atoms
  using lattice units in orthogonal box = (-0.038088577 176 -0.00037930073) to (1059.5581 1763.52 10.560379)
  create_atoms CPU = 0.011 seconds
group Particle region Particle
19324 atoms in group Particle

variable theta_z equal ${random01}*90  # angle to rotate the grain
variable theta_z equal 0.289885520935059*90  
displace_atoms Particle rotate ${cx} ${cy} ${cz} 0 0 1 ${theta_z} # rotate wrt z-axis
displace_atoms Particle rotate 239.27733451128 ${cy} ${cz} 0 0 1 ${theta_z} 
displace_atoms Particle rotate 239.27733451128 225 ${cz} 0 0 1 ${theta_z} 
displace_atoms Particle rotate 239.27733451128 225 1.5 0 0 1 ${theta_z} 
displace_atoms Particle rotate 239.27733451128 225 1.5 0 0 1 26.0896968841553 
Displacing atoms ...

group GroupCreateAtomsTop_01 union GroupCreateAtomsTop_01 Particle
103935 atoms in group GroupCreateAtomsTop_01
region Particle delete
group Particle delete

next vloopParticle
jump SELF labelParticleCreation
print "Grain creation loop: ${vloopParticle}"
Grain creation loop: 6
variable perturb01 equal v_random01
if "(${vloopParticle} == 0) || (${vloopParticle} == ${nParticles})" then "variable perturb01 equal 0.00"
variable perturb01 equal 0.00

variable radius equal (0.75+0.25*${perturb01})*${radiusIdeal}
variable radius equal (0.75+0.25*0)*${radiusIdeal}
variable radius equal (0.75+0.25*0)*25
variable temp01 equal ${perturb01}*${radiusIdeal}  #((step/${nrun})%2)*${radius}
variable temp01 equal 0*${radiusIdeal}  
variable temp01 equal 0*25  
variable temp02 equal 2*${radiusIdeal}*(${vloopParticle}-1)+${radiusIdeal}
variable temp02 equal 2*25*(${vloopParticle}-1)+${radiusIdeal}
variable temp02 equal 2*25*(6-1)+${radiusIdeal}
variable temp02 equal 2*25*(6-1)+25
variable cx equal ${temp01}+${temp02} #((step/${nrun})%2)*10 + 100*${vloopParticle} - 50
variable cx equal 0+${temp02} 
variable cx equal 0+275 
variable cy equal (${y2}+${y3})/2
variable cy equal (200+${y3})/2
variable cy equal (200+250)/2
variable cz equal (${z2}+${z3})/2
variable cz equal (0+${z3})/2
variable cz equal (0+3)/2
print "Grain parameters cx: ${cx} cy: ${cy} cz: ${cz} radius: ${radius}"
Grain parameters cx: 275 cy: 225 cz: 1.5 radius: 18.75
region Particle sphere ${cx} ${cy} ${cz} ${radius}
region Particle sphere 275 ${cy} ${cz} ${radius}
region Particle sphere 275 225 ${cz} ${radius}
region Particle sphere 275 225 1.5 ${radius}
region Particle sphere 275 225 1.5 18.75

create_atoms 1 region Particle
Created 15432 atoms
  using lattice units in orthogonal box = (-0.038088577 176 -0.00037930073) to (1059.5581 1763.52 10.560379)
  create_atoms CPU = 0.010 seconds
group Particle region Particle
16067 atoms in group Particle

variable theta_z equal ${random01}*90  # angle to rotate the grain
variable theta_z equal 0.542750537395477*90  
displace_atoms Particle rotate ${cx} ${cy} ${cz} 0 0 1 ${theta_z} # rotate wrt z-axis
displace_atoms Particle rotate 275 ${cy} ${cz} 0 0 1 ${theta_z} 
displace_atoms Particle rotate 275 225 ${cz} 0 0 1 ${theta_z} 
displace_atoms Particle rotate 275 225 1.5 0 0 1 ${theta_z} 
displace_atoms Particle rotate 275 225 1.5 0 0 1 48.8475483655929 
Displacing atoms ...

group GroupCreateAtomsTop_01 union GroupCreateAtomsTop_01 Particle
119367 atoms in group GroupCreateAtomsTop_01
region Particle delete
group Particle delete

next vloopParticle
jump SELF labelParticleCreation

### Assign velocity/Temperature to the newly created atoms
#group GroupCreateAtomsTop_01 region BlockCreateAtomsTop_01
delete_atoms overlap 2.25 GroupCreateAtomsTop_01 all  # atoms from the first group will be deleted
System init for delete_atoms ...
Neighbor list info ...
  update: every = 1 steps, delay = 10 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 7.65
  ghost atom cutoff = 7.65
  binsize = 3.825, bins = 278 416 3
  4 neighbor lists, perpetual/occasional/extra = 1 3 0
  (1) command delete_atoms, occasional
      attributes: full, newton on
      pair build: full/bin/atomonly
      stencil: full/bin/3d
      bin: standard
  (2) pair eam/alloy, perpetual
      attributes: half, newton on
      pair build: half/bin/atomonly/newton
      stencil: half/bin/3d
      bin: standard
  (3) compute cna/atom, occasional
      attributes: full, newton on
      pair build: full/bin/atomonly
      stencil: full/bin/3d
      bin: standard
  (4) compute centro/atom, occasional
      attributes: full, newton on
      pair build: full/bin/atomonly
      stencil: full/bin/3d
      bin: standard
Deleted 19783 atoms, new total = 643190
velocity	GroupCreateAtomsTop_01 create ${T2} 187723 #temp Temperature # assign velocity of the newly created atoms
velocity	GroupCreateAtomsTop_01 create 1600 187723 

### Redefine the group, fix etc.
group GroupDeleteAtomsBottom_01 region BlockDeleteAtomsBottom_01
0 atoms in group GroupDeleteAtomsBottom_01
group GroupInside region BlockInside
635902 atoms in group GroupInside
#fix 1 GroupInside nve
fix  1 GroupInside npt temp $T $T 0.2 drag 0.5 x 0.0 0.0 5 z 0.0 0.0 5 couple none
fix  1 GroupInside npt temp 800 $T 0.2 drag 0.5 x 0.0 0.0 5 z 0.0 0.0 5 couple none
fix  1 GroupInside npt temp 800 800 0.2 drag 0.5 x 0.0 0.0 5 z 0.0 0.0 5 couple none
fix fPushParticles GroupCreateAtomsTop_01 addforce 0.0 -0.2 0.0 every 1
fix fLangevin GroupDeleteAtomsBottom_01 langevin ${T} ${T} 0.5 123456
fix fLangevin GroupDeleteAtomsBottom_01 langevin 800 ${T} 0.5 123456
fix fLangevin GroupDeleteAtomsBottom_01 langevin 800 800 0.5 123456

print "nAtomsAll: ${nAtomsAll}; nAtomsInitial: ${nAtomsInitial}; nAtomsNew: ${nAtomsNew}"
nAtomsAll: 643190; nAtomsInitial: 543606; nAtomsNew: 99584

balance 1.1 rcb  # load balancing
Balancing ...
Neighbor list info ...
  update: every = 1 steps, delay = 10 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 7.65
  ghost atom cutoff = 7.65
  binsize = 3.825, bins = 278 416 3
  3 neighbor lists, perpetual/occasional/extra = 1 2 0
  (1) pair eam/alloy, perpetual
      attributes: half, newton on
      pair build: half/bin/atomonly/newton
      stencil: half/bin/3d
      bin: standard
  (2) compute cna/atom, occasional
      attributes: full, newton on
      pair build: full/bin/atomonly
      stencil: full/bin/3d
      bin: standard
  (3) compute centro/atom, occasional
      attributes: full, newton on
      pair build: full/bin/atomonly
      stencil: full/bin/3d
      bin: standard
 rebalancing time: 0.126 seconds
  iteration count = 0
  initial/final maximal load/proc = 126203 107199
  initial/final imbalance factor  = 1.1772851 1.0000062

run ${nrun}
run 4
Per MPI rank memory allocation (min/avg/max) = 187.3 | 192.6 | 199.9 Mbytes
   Step          Temp          PotEng         KinEng        v_Temp02   
         4   606.08628     -2771953.6      50389.227      1603.2105    
         5   681.26763     -2778379.6      56639.707      1535.8112    
         6   739.38073     -2783279.3      61471.155      1348.6289    
         7   759.823       -2784922.2      63170.699      1084.683     
         8   741.34255     -2783229.2      61634.259      805.68072    
Loop time of 8.17425 on 6 procs for 4 steps with 643190 atoms

Performance: 0.211 ns/day, 113.531 hours/ns, 0.489 timesteps/s
95.4% CPU use with 6 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 1.996      | 2.0067     | 2.0316     |   0.8 | 24.55
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.029843   | 0.052668   | 0.063844   |   4.9 |  0.64
Output  | 6.0156     | 6.0157     | 6.0157     |   0.0 | 73.59
Modify  | 0.090753   | 0.091844   | 0.093361   |   0.3 |  1.12
Other   |            | 0.007348   |            |       |  0.09

Nlocal:         107198 ave      107199 max      107198 min
Histogram: 4 0 0 0 0 0 0 0 0 2
Nghost:         184327 ave      187770 max      182535 min
Histogram: 4 0 0 0 0 0 0 0 1 1
Neighs:    9.18984e+06 ave 9.24596e+06 max 9.06807e+06 min
Histogram: 1 1 0 0 0 0 0 0 0 4
FullNghs:  1.83745e+07 ave 1.84639e+07 max 1.81745e+07 min
Histogram: 1 1 0 0 0 0 0 0 0 4

Total # of neighbors = 1.1024679e+08
Ave neighs/atom = 171.40625
Neighbor list builds = 0
Dangerous builds = 0

###----mimic the short pulse of laser to a localized region----
print "*** Laser pulse begins***"
*** Laser pulse begins***
## Create ellipsoidal region of atoms
variable ellipse_a equal ${Height}/2 # spread of laser shot
variable ellipse_a equal 50/2 
variable ellipse_b equal 2*${Height} # depth of laser shot, melt-pool depth for SLM
variable ellipse_b equal 2*50 
variable ellipse_c equal ${ellipse_a}
variable ellipse_c equal 25

variable DistanceLaserShot equal 1.0*${Height}  # center to center distance between laser shots
variable DistanceLaserShot equal 1.0*50  
variable nLaserShot equal floor(${lx}/${DistanceLaserShot})
variable nLaserShot equal floor(301/${DistanceLaserShot})
variable nLaserShot equal floor(301/50)
variable vloopLaser loop ${nLaserShot}
variable vloopLaser loop 6
label labelLaserPulse
print "Laser loop: ${vloopLaser}"
Laser loop: 1

variable temp01 equal 0.00 #((step/${nrun})%2)*${Height}
variable temp02 equal ${DistanceLaserShot}*(${vloopLaser}-1)+${Height}/2
variable temp02 equal 50*(${vloopLaser}-1)+${Height}/2
variable temp02 equal 50*(1-1)+${Height}/2
variable temp02 equal 50*(1-1)+50/2
variable cx equal ${temp01}+${temp02} #((step/${nrun})%2)*10 + 100*${vloopLaser} - 50
variable cx equal 0+${temp02} 
variable cx equal 0+25 
variable cy equal ${y3}
variable cy equal 250
variable cz equal (${z2}+${z3})/2
variable cz equal (0+${z3})/2
variable cz equal (0+3)/2
region AreaLaser01 ellipsoid ${cx} ${cy} ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 25 ${cy} ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 25 250 ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 25 250 1.5 ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 25 250 1.5 25 ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 25 250 1.5 25 100 ${ellipse_c}
region AreaLaser01 ellipsoid 25 250 1.5 25 100 25
group AreaLaser01 region AreaLaser01
31734 atoms in group AreaLaser01
#delete_atoms group AreaLaser01
displace_atoms AreaLaser01 random 0.05 0.1 0.05 123456
Displacing atoms ...
run ${nrun}
run 4
Per MPI rank memory allocation (min/avg/max) = 268.5 | 274.2 | 288 Mbytes
   Step          Temp          PotEng         KinEng        v_Temp02   
         8   741.34255     -2772606.8      61634.259      805.68072    
         9   708.2267      -2769667.6      58881.05       601.95966    
        10   689.04477     -2767921        57286.289      535.94845    
        11   694.80282     -2768285.8      57765.006      592.67901    
        12   726.93319     -2770867.7      60436.283      721.85156    
Loop time of 9.15787 on 6 procs for 4 steps with 643190 atoms

Performance: 0.189 ns/day, 127.193 hours/ns, 0.437 timesteps/s
95.1% CPU use with 6 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2.2254     | 2.244      | 2.2659     |   1.0 | 24.50
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.036978   | 0.057922   | 0.077248   |   6.1 |  0.63
Output  | 6.7546     | 6.7547     | 6.7549     |   0.0 | 73.76
Modify  | 0.092908   | 0.094207   | 0.094971   |   0.2 |  1.03
Other   |            | 0.007023   |            |       |  0.08

Nlocal:         107198 ave      107267 max      107165 min
Histogram: 3 0 0 0 2 0 0 0 0 1
Nghost:         184324 ave      187752 max      182524 min
Histogram: 4 0 0 0 0 0 0 0 1 1
Neighs:    9.17075e+06 ave 9.25118e+06 max 9.01773e+06 min
Histogram: 2 0 0 0 0 0 0 0 0 4
FullNghs:  1.83296e+07 ave 1.84845e+07 max 1.80288e+07 min
Histogram: 2 0 0 0 0 0 0 0 0 4

Total # of neighbors = 1.0997735e+08
Ave neighs/atom = 170.98734
Neighbor list builds = 0
Dangerous builds = 0

region AreaLaser01 delete
group AreaLaser01 delete

next vloopLaser
jump SELF labelLaserPulse
print "Laser loop: ${vloopLaser}"
Laser loop: 2

variable temp01 equal 0.00 #((step/${nrun})%2)*${Height}
variable temp02 equal ${DistanceLaserShot}*(${vloopLaser}-1)+${Height}/2
variable temp02 equal 50*(${vloopLaser}-1)+${Height}/2
variable temp02 equal 50*(2-1)+${Height}/2
variable temp02 equal 50*(2-1)+50/2
variable cx equal ${temp01}+${temp02} #((step/${nrun})%2)*10 + 100*${vloopLaser} - 50
variable cx equal 0+${temp02} 
variable cx equal 0+75 
variable cy equal ${y3}
variable cy equal 250
variable cz equal (${z2}+${z3})/2
variable cz equal (0+${z3})/2
variable cz equal (0+3)/2
region AreaLaser01 ellipsoid ${cx} ${cy} ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 75 ${cy} ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 75 250 ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 75 250 1.5 ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 75 250 1.5 25 ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 75 250 1.5 25 100 ${ellipse_c}
region AreaLaser01 ellipsoid 75 250 1.5 25 100 25
group AreaLaser01 region AreaLaser01
39874 atoms in group AreaLaser01
#delete_atoms group AreaLaser01
displace_atoms AreaLaser01 random 0.05 0.1 0.05 123456
Displacing atoms ...
run ${nrun}
run 4
Per MPI rank memory allocation (min/avg/max) = 268.5 | 274.2 | 288.1 Mbytes
   Step          Temp          PotEng         KinEng        v_Temp02   
        12   726.93319     -2757444.6      60436.283      721.85156    
        13   791.87189     -2762803.8      65835.203      910.76593    
        14   884.50788     -2770506        73536.839      1133.3393    
        15   978.51002     -2778302.8      81352.054      1319.6766    
        16   1049.6767     -2784147.5      87268.761      1426.8924    
Loop time of 10.0403 on 6 procs for 4 steps with 643190 atoms

Performance: 0.172 ns/day, 139.448 hours/ns, 0.398 timesteps/s
95.4% CPU use with 6 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2.4556     | 2.4889     | 2.53       |   1.5 | 24.79
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.037414   | 0.079397   | 0.11397    |   8.6 |  0.79
Output  | 7.3644     | 7.3645     | 7.3646     |   0.0 | 73.35
Modify  | 0.098233   | 0.099063   | 0.099853   |   0.2 |  0.99
Other   |            | 0.008387   |            |       |  0.08

Nlocal:         107198 ave      107232 max      107168 min
Histogram: 1 0 2 0 0 0 1 1 0 1
Nghost:         184324 ave      187751 max      182521 min
Histogram: 4 0 0 0 0 0 0 0 1 1
Neighs:    9.16145e+06 ave 9.25167e+06 max 8.96888e+06 min
Histogram: 1 1 0 0 0 0 0 0 0 4
FullNghs:  1.83327e+07 ave 1.84941e+07 max 1.79858e+07 min
Histogram: 1 1 0 0 0 0 0 0 0 4

Total # of neighbors = 1.0999634e+08
Ave neighs/atom = 171.01687
Neighbor list builds = 0
Dangerous builds = 0

region AreaLaser01 delete
group AreaLaser01 delete

next vloopLaser
jump SELF labelLaserPulse
print "Laser loop: ${vloopLaser}"
Laser loop: 3

variable temp01 equal 0.00 #((step/${nrun})%2)*${Height}
variable temp02 equal ${DistanceLaserShot}*(${vloopLaser}-1)+${Height}/2
variable temp02 equal 50*(${vloopLaser}-1)+${Height}/2
variable temp02 equal 50*(3-1)+${Height}/2
variable temp02 equal 50*(3-1)+50/2
variable cx equal ${temp01}+${temp02} #((step/${nrun})%2)*10 + 100*${vloopLaser} - 50
variable cx equal 0+${temp02} 
variable cx equal 0+125 
variable cy equal ${y3}
variable cy equal 250
variable cz equal (${z2}+${z3})/2
variable cz equal (0+${z3})/2
variable cz equal (0+3)/2
region AreaLaser01 ellipsoid ${cx} ${cy} ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 125 ${cy} ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 125 250 ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 125 250 1.5 ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 125 250 1.5 25 ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 125 250 1.5 25 100 ${ellipse_c}
region AreaLaser01 ellipsoid 125 250 1.5 25 100 25
group AreaLaser01 region AreaLaser01
39767 atoms in group AreaLaser01
#delete_atoms group AreaLaser01
displace_atoms AreaLaser01 random 0.05 0.1 0.05 123456
Displacing atoms ...
run ${nrun}
run 4
Per MPI rank memory allocation (min/avg/max) = 268.5 | 274.2 | 288.1 Mbytes
   Step          Temp          PotEng         KinEng        v_Temp02   
        16   1049.6767     -2770997.5      87268.761      1426.8924    
        17   1095.7618     -2774741.8      91100.218      1490.2623    
        18   1121.5026     -2776799.4      93240.276      1558.7254    
        19   1123.3307     -2776838.8      93392.257      1629.7312    
        20   1103.3469     -2775009.8      91730.827      1695.4986    
Loop time of 10.236 on 6 procs for 4 steps with 643190 atoms

Performance: 0.169 ns/day, 142.167 hours/ns, 0.391 timesteps/s
94.1% CPU use with 6 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2.5996     | 2.6376     | 2.7062     |   2.1 | 25.77
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.034564   | 0.10365    | 0.14084    |  10.9 |  1.01
Output  | 7.38       | 7.3801     | 7.3801     |   0.0 | 72.10
Modify  | 0.10671    | 0.10789    | 0.1092     |   0.2 |  1.05
Other   |            | 0.006777   |            |       |  0.07

Nlocal:         107198 ave      107253 max      107135 min
Histogram: 1 0 0 0 1 2 0 1 0 1
Nghost:         184326 ave      187770 max      182480 min
Histogram: 4 0 0 0 0 0 0 0 0 2
Neighs:     9.1673e+06 ave 9.26566e+06 max 8.95138e+06 min
Histogram: 1 1 0 0 0 0 0 0 0 4
FullNghs:  1.83364e+07 ave 1.85111e+07 max 1.79469e+07 min
Histogram: 1 1 0 0 0 0 0 0 0 4

Total # of neighbors = 1.100186e+08
Ave neighs/atom = 171.05148
Neighbor list builds = 0
Dangerous builds = 0

region AreaLaser01 delete
group AreaLaser01 delete

next vloopLaser
jump SELF labelLaserPulse
print "Laser loop: ${vloopLaser}"
Laser loop: 4

variable temp01 equal 0.00 #((step/${nrun})%2)*${Height}
variable temp02 equal ${DistanceLaserShot}*(${vloopLaser}-1)+${Height}/2
variable temp02 equal 50*(${vloopLaser}-1)+${Height}/2
variable temp02 equal 50*(4-1)+${Height}/2
variable temp02 equal 50*(4-1)+50/2
variable cx equal ${temp01}+${temp02} #((step/${nrun})%2)*10 + 100*${vloopLaser} - 50
variable cx equal 0+${temp02} 
variable cx equal 0+175 
variable cy equal ${y3}
variable cy equal 250
variable cz equal (${z2}+${z3})/2
variable cz equal (0+${z3})/2
variable cz equal (0+3)/2
region AreaLaser01 ellipsoid ${cx} ${cy} ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 175 ${cy} ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 175 250 ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 175 250 1.5 ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 175 250 1.5 25 ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 175 250 1.5 25 100 ${ellipse_c}
region AreaLaser01 ellipsoid 175 250 1.5 25 100 25
group AreaLaser01 region AreaLaser01
29834 atoms in group AreaLaser01
#delete_atoms group AreaLaser01
displace_atoms AreaLaser01 random 0.05 0.1 0.05 123456
Displacing atoms ...
run ${nrun}
run 4
Per MPI rank memory allocation (min/avg/max) = 268.5 | 274.2 | 288.1 Mbytes
   Step          Temp          PotEng         KinEng        v_Temp02   
        20   1103.3469     -2765067.7      91730.827      1695.4986    
        21   1078.9156     -2762854.5      89699.644      1773.5395    
        22   1067.5155     -2761746.6      88751.855      1875.908     
        23   1071.2766     -2761913.4      89064.547      1979.9517    
        24   1087.0692     -2763080.2      90377.528      2061.5101    
Loop time of 9.41294 on 6 procs for 4 steps with 643190 atoms

Performance: 0.184 ns/day, 130.735 hours/ns, 0.425 timesteps/s
96.7% CPU use with 6 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2.3331     | 2.3842     | 2.4062     |   1.6 | 25.33
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.045097   | 0.065669   | 0.11804    |   9.5 |  0.70
Output  | 6.8574     | 6.8575     | 6.8575     |   0.0 | 72.85
Modify  | 0.095      | 0.096411   | 0.097323   |   0.3 |  1.02
Other   |            | 0.009178   |            |       |  0.10

Nlocal:         107198 ave      107299 max      107073 min
Histogram: 2 0 0 0 0 1 0 0 2 1
Nghost:         184328 ave      187911 max      182434 min
Histogram: 4 0 0 0 0 0 0 0 1 1
Neighs:    9.16102e+06 ave 9.26576e+06 max 8.94684e+06 min
Histogram: 2 0 0 0 0 0 0 0 0 4
FullNghs:  1.83131e+07 ave 1.84989e+07 max 1.79342e+07 min
Histogram: 2 0 0 0 0 0 0 0 0 4

Total # of neighbors = 1.0987881e+08
Ave neighs/atom = 170.83414
Neighbor list builds = 0
Dangerous builds = 0

region AreaLaser01 delete
group AreaLaser01 delete

next vloopLaser
jump SELF labelLaserPulse
print "Laser loop: ${vloopLaser}"
Laser loop: 5

variable temp01 equal 0.00 #((step/${nrun})%2)*${Height}
variable temp02 equal ${DistanceLaserShot}*(${vloopLaser}-1)+${Height}/2
variable temp02 equal 50*(${vloopLaser}-1)+${Height}/2
variable temp02 equal 50*(5-1)+${Height}/2
variable temp02 equal 50*(5-1)+50/2
variable cx equal ${temp01}+${temp02} #((step/${nrun})%2)*10 + 100*${vloopLaser} - 50
variable cx equal 0+${temp02} 
variable cx equal 0+225 
variable cy equal ${y3}
variable cy equal 250
variable cz equal (${z2}+${z3})/2
variable cz equal (0+${z3})/2
variable cz equal (0+3)/2
region AreaLaser01 ellipsoid ${cx} ${cy} ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 225 ${cy} ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 225 250 ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 225 250 1.5 ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 225 250 1.5 25 ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 225 250 1.5 25 100 ${ellipse_c}
region AreaLaser01 ellipsoid 225 250 1.5 25 100 25
group AreaLaser01 region AreaLaser01
33010 atoms in group AreaLaser01
#delete_atoms group AreaLaser01
displace_atoms AreaLaser01 random 0.05 0.1 0.05 123456
Displacing atoms ...
run ${nrun}
run 4
Per MPI rank memory allocation (min/avg/max) = 268.5 | 274.2 | 288.1 Mbytes
   Step          Temp          PotEng         KinEng        v_Temp02   
        24   1087.0692     -2752059.7      90377.528      2061.5101    
        25   1118.8366     -2754576.8      93018.627      2133.7638    
        26   1165.3006     -2758336.6      96881.577      2209.2166    
        27   1210.4114     -2761965.3      100632.03      2268.3469    
        28   1240.2057     -2764272.3      103109.09      2297.8527    
Loop time of 9.08919 on 6 procs for 4 steps with 643190 atoms

Performance: 0.190 ns/day, 126.239 hours/ns, 0.440 timesteps/s
96.7% CPU use with 6 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2.2156     | 2.2734     | 2.3071     |   2.2 | 25.01
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.040677   | 0.076      | 0.13102    |  11.8 |  0.84
Output  | 6.6373     | 6.6373     | 6.6373     |   0.0 | 73.02
Modify  | 0.092961   | 0.094512   | 0.097392   |   0.5 |  1.04
Other   |            | 0.007955   |            |       |  0.09

Nlocal:         107198 ave      107354 max      106952 min
Histogram: 2 0 0 0 0 0 1 0 0 3
Nghost:         184326 ave      188027 max      182377 min
Histogram: 4 0 0 0 0 0 0 0 1 1
Neighs:    9.15004e+06 ave 9.26087e+06 max 8.92728e+06 min
Histogram: 2 0 0 0 0 0 0 0 0 4
FullNghs:  1.83004e+07 ave 1.85012e+07 max 1.78853e+07 min
Histogram: 1 1 0 0 0 0 0 0 0 4

Total # of neighbors = 1.0980228e+08
Ave neighs/atom = 170.71515
Neighbor list builds = 0
Dangerous builds = 0

region AreaLaser01 delete
group AreaLaser01 delete

next vloopLaser
jump SELF labelLaserPulse
print "Laser loop: ${vloopLaser}"
Laser loop: 6

variable temp01 equal 0.00 #((step/${nrun})%2)*${Height}
variable temp02 equal ${DistanceLaserShot}*(${vloopLaser}-1)+${Height}/2
variable temp02 equal 50*(${vloopLaser}-1)+${Height}/2
variable temp02 equal 50*(6-1)+${Height}/2
variable temp02 equal 50*(6-1)+50/2
variable cx equal ${temp01}+${temp02} #((step/${nrun})%2)*10 + 100*${vloopLaser} - 50
variable cx equal 0+${temp02} 
variable cx equal 0+275 
variable cy equal ${y3}
variable cy equal 250
variable cz equal (${z2}+${z3})/2
variable cz equal (0+${z3})/2
variable cz equal (0+3)/2
region AreaLaser01 ellipsoid ${cx} ${cy} ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 275 ${cy} ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 275 250 ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 275 250 1.5 ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 275 250 1.5 25 ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 275 250 1.5 25 100 ${ellipse_c}
region AreaLaser01 ellipsoid 275 250 1.5 25 100 25
group AreaLaser01 region AreaLaser01
33903 atoms in group AreaLaser01
#delete_atoms group AreaLaser01
displace_atoms AreaLaser01 random 0.05 0.1 0.05 123456
Displacing atoms ...
run ${nrun}
run 4
Per MPI rank memory allocation (min/avg/max) = 268.5 | 274.2 | 288.1 Mbytes
   Step          Temp          PotEng         KinEng        v_Temp02   
        28   1240.2057     -2753087.7      103109.09      2297.8527    
        29   1258.0025     -2754373.3      104588.69      2326.4969    
        30   1270.8243     -2755238        105654.69      2382.4158    
        31   1276.0972     -2755451.6      106093.07      2450.4274    
        32   1273.5396     -2754981        105880.43      2513.0869    
Loop time of 9.14584 on 6 procs for 4 steps with 643190 atoms

Performance: 0.189 ns/day, 127.026 hours/ns, 0.437 timesteps/s
96.0% CPU use with 6 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2.275      | 2.3089     | 2.3345     |   1.3 | 25.24
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.038507   | 0.062519   | 0.094009   |   7.1 |  0.68
Output  | 6.6711     | 6.6712     | 6.6712     |   0.0 | 72.94
Modify  | 0.094382   | 0.095611   | 0.096829   |   0.3 |  1.05
Other   |            | 0.007667   |            |       |  0.08

Nlocal:         107198 ave      107429 max      106886 min
Histogram: 2 0 0 0 0 0 1 0 2 1
Nghost:         184320 ave      188077 max      182301 min
Histogram: 3 1 0 0 0 0 0 0 1 1
Neighs:    9.14553e+06 ave 9.26935e+06 max 8.90158e+06 min
Histogram: 2 0 0 0 0 0 0 0 0 4
FullNghs:  1.82856e+07 ave 1.85093e+07 max 1.78389e+07 min
Histogram: 2 0 0 0 0 0 0 0 0 4

Total # of neighbors = 1.0971344e+08
Ave neighs/atom = 170.57704
Neighbor list builds = 0
Dangerous builds = 0

region AreaLaser01 delete
group AreaLaser01 delete

next vloopLaser
jump SELF labelLaserPulse

print "*** Idle run begins***"
*** Idle run begins***
run ${nrunIdle}
run 0
Per MPI rank memory allocation (min/avg/max) = 268.6 | 274.3 | 288.1 Mbytes
   Step          Temp          PotEng         KinEng        v_Temp02   
        32   1273.5396     -2754981        105880.43      2513.0869    
Loop time of 5.71667e-06 on 6 procs for 0 steps with 643190 atoms

0.0% CPU use with 6 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0          | 0          | 0          |   0.0 |  0.00
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 5.717e-06  |            |       |100.00

Nlocal:         107198 ave      107445 max      106851 min
Histogram: 2 0 0 0 0 0 1 0 2 1
Nghost:         184317 ave      188117 max      182288 min
Histogram: 3 1 0 0 0 0 0 0 1 1
Neighs:    9.13803e+06 ave 9.26597e+06 max 8.88264e+06 min
Histogram: 2 0 0 0 0 0 0 0 0 4
FullNghs:  1.82856e+07 ave 1.85093e+07 max 1.78389e+07 min
Histogram: 2 0 0 0 0 0 0 0 0 4

Total # of neighbors = 1.0971344e+08
Ave neighs/atom = 170.57704
Neighbor list builds = 0
Dangerous builds = 0

print "******LAMMPS loop finished******"
******LAMMPS loop finished******


jump script_LAMMPS_Basic.inp labelAMLoop
print "loop: ${loop01}"
loop: 2
next loop01
jump script_LAMMPS_AM.inp
### command to run recurssively for AM simulation
### Delete previous fix, region, group etc. before redefining

### delete the bottom atom righ at the begining and reassign before the next run for T-control
delete_atoms region BlockDeleteAtomsBottom_01
Deleted 0 atoms, new total = 643190

unfix 1
unfix fPushParticles
unfix fLangevin
region BlockInside delete
group GroupInside delete
region BlockDeleteAtomsBottom_01 delete
group GroupDeleteAtomsBottom_01 delete
region BlockCreateAtomsTop_01 delete
group GroupCreateAtomsTop_01 delete

variable delta_y equal (step/${nrun})*${Height}
variable delta_y equal (step/4)*${Height}
variable delta_y equal (step/4)*50
if "${nAtomsAll} > ${nAtomsInitial}" then "variable y1 equal ${y1}+${Height}" # This will make sure that total number of atom is close to initial atoms
variable y1 equal ${y1}+${Height}
variable y1 equal 50+${Height}
variable y1 equal 50+50
variable y2 equal ${y2}+${Height}
variable y2 equal 200+${Height}
variable y2 equal 200+50
variable y3 equal ${y3}+${Height}
variable y3 equal 250+${Height}
variable y3 equal 250+50
variable y_Inside equal ${y1}+2
variable y_Inside equal 100+2

### update other regions
region		BlockDeleteAtomsBottom_01 block INF INF INF ${y1} INF INF # delete all atom down the interface
region		BlockDeleteAtomsBottom_01 block INF INF INF 100 INF INF 
region		BlockCreateAtomsTop_01 block INF INF ${y2} ${y3} INF INF
region		BlockCreateAtomsTop_01 block INF INF 250 ${y3} INF INF
region		BlockCreateAtomsTop_01 block INF INF 250 300 INF INF
region		BlockInside block INF INF ${y_Inside} INF INF INF
region		BlockInside block INF INF 102 INF INF INF

###----create atoms i.e, spherical powder particles in a loop-----
print "*** Powder particle creation begins***"
*** Powder particle creation begins***
variable nParticles equal floor(${lx}/(${Height})) # square box shaped
variable nParticles equal floor(301/(${Height})) 
variable nParticles equal floor(301/(50)) 
variable radiusIdeal equal ${Height}/2
variable radiusIdeal equal 50/2
variable vloopParticle loop ${nParticles}
variable vloopParticle loop 6
label labelParticleCreation
print "Grain creation loop: ${vloopParticle}"
Grain creation loop: 1
variable perturb01 equal v_random01
if "(${vloopParticle} == 0) || (${vloopParticle} == ${nParticles})" then "variable perturb01 equal 0.00"

variable radius equal (0.75+0.25*${perturb01})*${radiusIdeal}
variable radius equal (0.75+0.25*0.628145217895508)*${radiusIdeal}
variable radius equal (0.75+0.25*0.628145217895508)*25
variable temp01 equal ${perturb01}*${radiusIdeal}  #((step/${nrun})%2)*${radius}
variable temp01 equal 0.82283890247345*${radiusIdeal}  
variable temp01 equal 0.82283890247345*25  
variable temp02 equal 2*${radiusIdeal}*(${vloopParticle}-1)+${radiusIdeal}
variable temp02 equal 2*25*(${vloopParticle}-1)+${radiusIdeal}
variable temp02 equal 2*25*(1-1)+${radiusIdeal}
variable temp02 equal 2*25*(1-1)+25
variable cx equal ${temp01}+${temp02} #((step/${nrun})%2)*10 + 100*${vloopParticle} - 50
variable cx equal 20.5709725618362+${temp02} 
variable cx equal 20.5709725618362+25 
variable cy equal (${y2}+${y3})/2
variable cy equal (250+${y3})/2
variable cy equal (250+300)/2
variable cz equal (${z2}+${z3})/2
variable cz equal (0+${z3})/2
variable cz equal (0+3)/2
print "Grain parameters cx: ${cx} cy: ${cy} cz: ${cz} radius: ${radius}"
Grain parameters cx: 45.5709725618362 cy: 275 cz: 1.5 radius: 22.6759076118469
region Particle sphere ${cx} ${cy} ${cz} ${radius}
region Particle sphere 45.5709725618362 ${cy} ${cz} ${radius}
region Particle sphere 45.5709725618362 275 ${cz} ${radius}
region Particle sphere 45.5709725618362 275 1.5 ${radius}
region Particle sphere 45.5709725618362 275 1.5 22.6759076118469

create_atoms 1 region Particle
Created 22587 atoms
  using lattice units in orthogonal box = (-0.96306058 176 -0.0096088328) to (1060.4831 1763.52 10.569609)
  create_atoms CPU = 0.017 seconds
group Particle region Particle
22587 atoms in group Particle

variable theta_z equal ${random01}*90  # angle to rotate the grain
variable theta_z equal 0.0854009389877319*90  
displace_atoms Particle rotate ${cx} ${cy} ${cz} 0 0 1 ${theta_z} # rotate wrt z-axis
displace_atoms Particle rotate 45.5709725618362 ${cy} ${cz} 0 0 1 ${theta_z} 
displace_atoms Particle rotate 45.5709725618362 275 ${cz} 0 0 1 ${theta_z} 
displace_atoms Particle rotate 45.5709725618362 275 1.5 0 0 1 ${theta_z} 
displace_atoms Particle rotate 45.5709725618362 275 1.5 0 0 1 7.68608450889587 
Displacing atoms ...

group GroupCreateAtomsTop_01 union GroupCreateAtomsTop_01 Particle
22587 atoms in group GroupCreateAtomsTop_01
region Particle delete
group Particle delete

next vloopParticle
jump SELF labelParticleCreation
print "Grain creation loop: ${vloopParticle}"
Grain creation loop: 2
variable perturb01 equal v_random01
if "(${vloopParticle} == 0) || (${vloopParticle} == ${nParticles})" then "variable perturb01 equal 0.00"

variable radius equal (0.75+0.25*${perturb01})*${radiusIdeal}
variable radius equal (0.75+0.25*0.117181956768036)*${radiusIdeal}
variable radius equal (0.75+0.25*0.117181956768036)*25
variable temp01 equal ${perturb01}*${radiusIdeal}  #((step/${nrun})%2)*${radius}
variable temp01 equal 0.883491039276123*${radiusIdeal}  
variable temp01 equal 0.883491039276123*25  
variable temp02 equal 2*${radiusIdeal}*(${vloopParticle}-1)+${radiusIdeal}
variable temp02 equal 2*25*(${vloopParticle}-1)+${radiusIdeal}
variable temp02 equal 2*25*(2-1)+${radiusIdeal}
variable temp02 equal 2*25*(2-1)+25
variable cx equal ${temp01}+${temp02} #((step/${nrun})%2)*10 + 100*${vloopParticle} - 50
variable cx equal 22.0872759819031+${temp02} 
variable cx equal 22.0872759819031+75 
variable cy equal (${y2}+${y3})/2
variable cy equal (250+${y3})/2
variable cy equal (250+300)/2
variable cz equal (${z2}+${z3})/2
variable cz equal (0+${z3})/2
variable cz equal (0+3)/2
print "Grain parameters cx: ${cx} cy: ${cy} cz: ${cz} radius: ${radius}"
Grain parameters cx: 97.0872759819031 cy: 275 cz: 1.5 radius: 19.4823872298002
region Particle sphere ${cx} ${cy} ${cz} ${radius}
region Particle sphere 97.0872759819031 ${cy} ${cz} ${radius}
region Particle sphere 97.0872759819031 275 ${cz} ${radius}
region Particle sphere 97.0872759819031 275 1.5 ${radius}
region Particle sphere 97.0872759819031 275 1.5 19.4823872298002

create_atoms 1 region Particle
Created 16633 atoms
  using lattice units in orthogonal box = (-0.96306058 176 -0.0096088328) to (1060.4831 1763.52 10.569609)
  create_atoms CPU = 0.013 seconds
group Particle region Particle
16633 atoms in group Particle

variable theta_z equal ${random01}*90  # angle to rotate the grain
variable theta_z equal 0.764850556850433*90  
displace_atoms Particle rotate ${cx} ${cy} ${cz} 0 0 1 ${theta_z} # rotate wrt z-axis
displace_atoms Particle rotate 97.0872759819031 ${cy} ${cz} 0 0 1 ${theta_z} 
displace_atoms Particle rotate 97.0872759819031 275 ${cz} 0 0 1 ${theta_z} 
displace_atoms Particle rotate 97.0872759819031 275 1.5 0 0 1 ${theta_z} 
displace_atoms Particle rotate 97.0872759819031 275 1.5 0 0 1 68.836550116539 
Displacing atoms ...

group GroupCreateAtomsTop_01 union GroupCreateAtomsTop_01 Particle
39220 atoms in group GroupCreateAtomsTop_01
region Particle delete
group Particle delete

next vloopParticle
jump SELF labelParticleCreation
print "Grain creation loop: ${vloopParticle}"
Grain creation loop: 3
variable perturb01 equal v_random01
if "(${vloopParticle} == 0) || (${vloopParticle} == ${nParticles})" then "variable perturb01 equal 0.00"

variable radius equal (0.75+0.25*${perturb01})*${radiusIdeal}
variable radius equal (0.75+0.25*0.965079188346863)*${radiusIdeal}
variable radius equal (0.75+0.25*0.965079188346863)*25
variable temp01 equal ${perturb01}*${radiusIdeal}  #((step/${nrun})%2)*${radius}
variable temp01 equal 0.35373055934906*${radiusIdeal}  
variable temp01 equal 0.35373055934906*25  
variable temp02 equal 2*${radiusIdeal}*(${vloopParticle}-1)+${radiusIdeal}
variable temp02 equal 2*25*(${vloopParticle}-1)+${radiusIdeal}
variable temp02 equal 2*25*(3-1)+${radiusIdeal}
variable temp02 equal 2*25*(3-1)+25
variable cx equal ${temp01}+${temp02} #((step/${nrun})%2)*10 + 100*${vloopParticle} - 50
variable cx equal 8.8432639837265+${temp02} 
variable cx equal 8.8432639837265+125 
variable cy equal (${y2}+${y3})/2
variable cy equal (250+${y3})/2
variable cy equal (250+300)/2
variable cz equal (${z2}+${z3})/2
variable cz equal (0+${z3})/2
variable cz equal (0+3)/2
print "Grain parameters cx: ${cx} cy: ${cy} cz: ${cz} radius: ${radius}"
Grain parameters cx: 133.843263983727 cy: 275 cz: 1.5 radius: 24.7817449271679
region Particle sphere ${cx} ${cy} ${cz} ${radius}
region Particle sphere 133.843263983727 ${cy} ${cz} ${radius}
region Particle sphere 133.843263983727 275 ${cz} ${radius}
region Particle sphere 133.843263983727 275 1.5 ${radius}
region Particle sphere 133.843263983727 275 1.5 24.7817449271679

create_atoms 1 region Particle
Created 26976 atoms
  using lattice units in orthogonal box = (-0.96306058 176 -0.0096088328) to (1060.4831 1763.52 10.569609)
  create_atoms CPU = 0.015 seconds
group Particle region Particle
28683 atoms in group Particle

variable theta_z equal ${random01}*90  # angle to rotate the grain
variable theta_z equal 0.101518869400024*90  
displace_atoms Particle rotate ${cx} ${cy} ${cz} 0 0 1 ${theta_z} # rotate wrt z-axis
displace_atoms Particle rotate 133.843263983727 ${cy} ${cz} 0 0 1 ${theta_z} 
displace_atoms Particle rotate 133.843263983727 275 ${cz} 0 0 1 ${theta_z} 
displace_atoms Particle rotate 133.843263983727 275 1.5 0 0 1 ${theta_z} 
displace_atoms Particle rotate 133.843263983727 275 1.5 0 0 1 9.13669824600216 
Displacing atoms ...

group GroupCreateAtomsTop_01 union GroupCreateAtomsTop_01 Particle
66196 atoms in group GroupCreateAtomsTop_01
region Particle delete
group Particle delete

next vloopParticle
jump SELF labelParticleCreation
print "Grain creation loop: ${vloopParticle}"
Grain creation loop: 4
variable perturb01 equal v_random01
if "(${vloopParticle} == 0) || (${vloopParticle} == ${nParticles})" then "variable perturb01 equal 0.00"

variable radius equal (0.75+0.25*${perturb01})*${radiusIdeal}
variable radius equal (0.75+0.25*0.815828323364258)*${radiusIdeal}
variable radius equal (0.75+0.25*0.815828323364258)*25
variable temp01 equal ${perturb01}*${radiusIdeal}  #((step/${nrun})%2)*${radius}
variable temp01 equal 0.45826530456543*${radiusIdeal}  
variable temp01 equal 0.45826530456543*25  
variable temp02 equal 2*${radiusIdeal}*(${vloopParticle}-1)+${radiusIdeal}
variable temp02 equal 2*25*(${vloopParticle}-1)+${radiusIdeal}
variable temp02 equal 2*25*(4-1)+${radiusIdeal}
variable temp02 equal 2*25*(4-1)+25
variable cx equal ${temp01}+${temp02} #((step/${nrun})%2)*10 + 100*${vloopParticle} - 50
variable cx equal 11.4566326141358+${temp02} 
variable cx equal 11.4566326141358+175 
variable cy equal (${y2}+${y3})/2
variable cy equal (250+${y3})/2
variable cy equal (250+300)/2
variable cz equal (${z2}+${z3})/2
variable cz equal (0+${z3})/2
variable cz equal (0+3)/2
print "Grain parameters cx: ${cx} cy: ${cy} cz: ${cz} radius: ${radius}"
Grain parameters cx: 186.456632614136 cy: 275 cz: 1.5 radius: 23.8489270210266
region Particle sphere ${cx} ${cy} ${cz} ${radius}
region Particle sphere 186.456632614136 ${cy} ${cz} ${radius}
region Particle sphere 186.456632614136 275 ${cz} ${radius}
region Particle sphere 186.456632614136 275 1.5 ${radius}
region Particle sphere 186.456632614136 275 1.5 23.8489270210266

create_atoms 1 region Particle
Created 24987 atoms
  using lattice units in orthogonal box = (-0.96306058 176 -0.0096088328) to (1060.4831 1763.52 10.569609)
  create_atoms CPU = 0.017 seconds
group Particle region Particle
24987 atoms in group Particle

variable theta_z equal ${random01}*90  # angle to rotate the grain
variable theta_z equal 0.113553762435913*90  
displace_atoms Particle rotate ${cx} ${cy} ${cz} 0 0 1 ${theta_z} # rotate wrt z-axis
displace_atoms Particle rotate 186.456632614136 ${cy} ${cz} 0 0 1 ${theta_z} 
displace_atoms Particle rotate 186.456632614136 275 ${cz} 0 0 1 ${theta_z} 
displace_atoms Particle rotate 186.456632614136 275 1.5 0 0 1 ${theta_z} 
displace_atoms Particle rotate 186.456632614136 275 1.5 0 0 1 10.2198386192322 
Displacing atoms ...

group GroupCreateAtomsTop_01 union GroupCreateAtomsTop_01 Particle
91183 atoms in group GroupCreateAtomsTop_01
region Particle delete
group Particle delete

next vloopParticle
jump SELF labelParticleCreation
print "Grain creation loop: ${vloopParticle}"
Grain creation loop: 5
variable perturb01 equal v_random01
if "(${vloopParticle} == 0) || (${vloopParticle} == ${nParticles})" then "variable perturb01 equal 0.00"

variable radius equal (0.75+0.25*${perturb01})*${radiusIdeal}
variable radius equal (0.75+0.25*0.216468870639801)*${radiusIdeal}
variable radius equal (0.75+0.25*0.216468870639801)*25
variable temp01 equal ${perturb01}*${radiusIdeal}  #((step/${nrun})%2)*${radius}
variable temp01 equal 0.734471201896667*${radiusIdeal}  
variable temp01 equal 0.734471201896667*25  
variable temp02 equal 2*${radiusIdeal}*(${vloopParticle}-1)+${radiusIdeal}
variable temp02 equal 2*25*(${vloopParticle}-1)+${radiusIdeal}
variable temp02 equal 2*25*(5-1)+${radiusIdeal}
variable temp02 equal 2*25*(5-1)+25
variable cx equal ${temp01}+${temp02} #((step/${nrun})%2)*10 + 100*${vloopParticle} - 50
variable cx equal 18.3617800474167+${temp02} 
variable cx equal 18.3617800474167+225 
variable cy equal (${y2}+${y3})/2
variable cy equal (250+${y3})/2
variable cy equal (250+300)/2
variable cz equal (${z2}+${z3})/2
variable cz equal (0+${z3})/2
variable cz equal (0+3)/2
print "Grain parameters cx: ${cx} cy: ${cy} cz: ${cz} radius: ${radius}"
Grain parameters cx: 243.361780047417 cy: 275 cz: 1.5 radius: 20.1029304414988
region Particle sphere ${cx} ${cy} ${cz} ${radius}
region Particle sphere 243.361780047417 ${cy} ${cz} ${radius}
region Particle sphere 243.361780047417 275 ${cz} ${radius}
region Particle sphere 243.361780047417 275 1.5 ${radius}
region Particle sphere 243.361780047417 275 1.5 20.1029304414988

create_atoms 1 region Particle
Created 17732 atoms
  using lattice units in orthogonal box = (-0.96306058 176 -0.0096088328) to (1060.4831 1763.52 10.569609)
  create_atoms CPU = 0.015 seconds
group Particle region Particle
17732 atoms in group Particle

variable theta_z equal ${random01}*90  # angle to rotate the grain
variable theta_z equal 0.0214923620223999*90  
displace_atoms Particle rotate ${cx} ${cy} ${cz} 0 0 1 ${theta_z} # rotate wrt z-axis
displace_atoms Particle rotate 243.361780047417 ${cy} ${cz} 0 0 1 ${theta_z} 
displace_atoms Particle rotate 243.361780047417 275 ${cz} 0 0 1 ${theta_z} 
displace_atoms Particle rotate 243.361780047417 275 1.5 0 0 1 ${theta_z} 
displace_atoms Particle rotate 243.361780047417 275 1.5 0 0 1 1.93431258201599 
Displacing atoms ...

group GroupCreateAtomsTop_01 union GroupCreateAtomsTop_01 Particle
108915 atoms in group GroupCreateAtomsTop_01
region Particle delete
group Particle delete

next vloopParticle
jump SELF labelParticleCreation
print "Grain creation loop: ${vloopParticle}"
Grain creation loop: 6
variable perturb01 equal v_random01
if "(${vloopParticle} == 0) || (${vloopParticle} == ${nParticles})" then "variable perturb01 equal 0.00"
variable perturb01 equal 0.00

variable radius equal (0.75+0.25*${perturb01})*${radiusIdeal}
variable radius equal (0.75+0.25*0)*${radiusIdeal}
variable radius equal (0.75+0.25*0)*25
variable temp01 equal ${perturb01}*${radiusIdeal}  #((step/${nrun})%2)*${radius}
variable temp01 equal 0*${radiusIdeal}  
variable temp01 equal 0*25  
variable temp02 equal 2*${radiusIdeal}*(${vloopParticle}-1)+${radiusIdeal}
variable temp02 equal 2*25*(${vloopParticle}-1)+${radiusIdeal}
variable temp02 equal 2*25*(6-1)+${radiusIdeal}
variable temp02 equal 2*25*(6-1)+25
variable cx equal ${temp01}+${temp02} #((step/${nrun})%2)*10 + 100*${vloopParticle} - 50
variable cx equal 0+${temp02} 
variable cx equal 0+275 
variable cy equal (${y2}+${y3})/2
variable cy equal (250+${y3})/2
variable cy equal (250+300)/2
variable cz equal (${z2}+${z3})/2
variable cz equal (0+${z3})/2
variable cz equal (0+3)/2
print "Grain parameters cx: ${cx} cy: ${cy} cz: ${cz} radius: ${radius}"
Grain parameters cx: 275 cy: 275 cz: 1.5 radius: 18.75
region Particle sphere ${cx} ${cy} ${cz} ${radius}
region Particle sphere 275 ${cy} ${cz} ${radius}
region Particle sphere 275 275 ${cz} ${radius}
region Particle sphere 275 275 1.5 ${radius}
region Particle sphere 275 275 1.5 18.75

create_atoms 1 region Particle
Created 15432 atoms
  using lattice units in orthogonal box = (-0.96306058 176 -0.0096088328) to (1060.4831 1763.52 10.569609)
  create_atoms CPU = 0.014 seconds
group Particle region Particle
16965 atoms in group Particle

variable theta_z equal ${random01}*90  # angle to rotate the grain
variable theta_z equal 0.62176388502121*90  
displace_atoms Particle rotate ${cx} ${cy} ${cz} 0 0 1 ${theta_z} # rotate wrt z-axis
displace_atoms Particle rotate 275 ${cy} ${cz} 0 0 1 ${theta_z} 
displace_atoms Particle rotate 275 275 ${cz} 0 0 1 ${theta_z} 
displace_atoms Particle rotate 275 275 1.5 0 0 1 ${theta_z} 
displace_atoms Particle rotate 275 275 1.5 0 0 1 55.9587496519089 
Displacing atoms ...

group GroupCreateAtomsTop_01 union GroupCreateAtomsTop_01 Particle
124347 atoms in group GroupCreateAtomsTop_01
region Particle delete
group Particle delete

next vloopParticle
jump SELF labelParticleCreation

### Assign velocity/Temperature to the newly created atoms
#group GroupCreateAtomsTop_01 region BlockCreateAtomsTop_01
delete_atoms overlap 2.25 GroupCreateAtomsTop_01 all  # atoms from the first group will be deleted
System init for delete_atoms ...
Neighbor list info ...
  update: every = 1 steps, delay = 10 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 7.65
  ghost atom cutoff = 7.65
  binsize = 3.825, bins = 278 416 3
  4 neighbor lists, perpetual/occasional/extra = 1 3 0
  (1) command delete_atoms, occasional
      attributes: full, newton on
      pair build: full/bin/atomonly
      stencil: full/bin/3d
      bin: standard
  (2) pair eam/alloy, perpetual
      attributes: half, newton on
      pair build: half/bin/atomonly/newton
      stencil: half/bin/3d
      bin: standard
  (3) compute cna/atom, occasional
      attributes: full, newton on
      pair build: full/bin/atomonly
      stencil: full/bin/3d
      bin: standard
  (4) compute centro/atom, occasional
      attributes: full, newton on
      pair build: full/bin/atomonly
      stencil: full/bin/3d
      bin: standard
Deleted 20726 atoms, new total = 746811
velocity	GroupCreateAtomsTop_01 create ${T2} 187723 #temp Temperature # assign velocity of the newly created atoms
velocity	GroupCreateAtomsTop_01 create 1600 187723 

### Redefine the group, fix etc.
group GroupDeleteAtomsBottom_01 region BlockDeleteAtomsBottom_01
181351 atoms in group GroupDeleteAtomsBottom_01
group GroupInside region BlockInside
558209 atoms in group GroupInside
#fix 1 GroupInside nve
fix  1 GroupInside npt temp $T $T 0.2 drag 0.5 x 0.0 0.0 5 z 0.0 0.0 5 couple none
fix  1 GroupInside npt temp 800 $T 0.2 drag 0.5 x 0.0 0.0 5 z 0.0 0.0 5 couple none
fix  1 GroupInside npt temp 800 800 0.2 drag 0.5 x 0.0 0.0 5 z 0.0 0.0 5 couple none
fix fPushParticles GroupCreateAtomsTop_01 addforce 0.0 -0.2 0.0 every 1
fix fLangevin GroupDeleteAtomsBottom_01 langevin ${T} ${T} 0.5 123456
fix fLangevin GroupDeleteAtomsBottom_01 langevin 800 ${T} 0.5 123456
fix fLangevin GroupDeleteAtomsBottom_01 langevin 800 800 0.5 123456

print "nAtomsAll: ${nAtomsAll}; nAtomsInitial: ${nAtomsInitial}; nAtomsNew: ${nAtomsNew}"
nAtomsAll: 746811; nAtomsInitial: 543606; nAtomsNew: 103621

balance 1.1 rcb  # load balancing
Balancing ...
Neighbor list info ...
  update: every = 1 steps, delay = 10 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 7.65
  ghost atom cutoff = 7.65
  binsize = 3.825, bins = 278 416 3
  3 neighbor lists, perpetual/occasional/extra = 1 2 0
  (1) pair eam/alloy, perpetual
      attributes: half, newton on
      pair build: half/bin/atomonly/newton
      stencil: half/bin/3d
      bin: standard
  (2) compute cna/atom, occasional
      attributes: full, newton on
      pair build: full/bin/atomonly
      stencil: full/bin/3d
      bin: standard
  (3) compute centro/atom, occasional
      attributes: full, newton on
      pair build: full/bin/atomonly
      stencil: full/bin/3d
      bin: standard
 rebalancing time: 0.113 seconds
  iteration count = 0
  initial/final maximal load/proc = 159454 124469
  initial/final imbalance factor  = 1.2810791 1.000004

run ${nrun}
run 4
Per MPI rank memory allocation (min/avg/max) = 211 | 224 | 241.3 Mbytes
   Step          Temp          PotEng         KinEng        v_Temp02   
        32   1318.8343     -3211786.3      127310.73      1603.2111    
        33   1304.625      -3210417.7      125939.06      1535.3436    
        34   1270.8472     -3207188.1      122678.4       1347.388     
        35   1226.8262     -3202948.3      118428.93      1083.2492    
        36   1182.8594     -3198691.3      114184.7       804.4043     
Loop time of 13.6841 on 6 procs for 4 steps with 746811 atoms

Performance: 0.126 ns/day, 190.056 hours/ns, 0.292 timesteps/s
95.2% CPU use with 6 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 3.357      | 3.4329     | 3.4925     |   2.4 | 25.09
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.062914   | 0.11931    | 0.1916     |  12.4 |  0.87
Output  | 10.009     | 10.009     | 10.009     |   0.0 | 73.14
Modify  | 0.11037    | 0.11426    | 0.11872    |   0.9 |  0.84
Other   |            | 0.008666   |            |       |  0.06

Nlocal:         124468 ave      124469 max      124467 min
Histogram: 1 0 0 0 0 1 0 0 0 4
Nghost:         211972 ave      216678 max      210146 min
Histogram: 4 0 0 0 0 1 0 0 0 1
Neighs:    1.06035e+07 ave 1.07339e+07 max 1.03467e+07 min
Histogram: 2 0 0 0 0 0 0 0 0 4
FullNghs:   2.1202e+07 ave 2.14317e+07 max  2.0752e+07 min
Histogram: 2 0 0 0 0 0 0 0 0 4

Total # of neighbors = 1.2721183e+08
Ave neighs/atom = 170.34006
Neighbor list builds = 0
Dangerous builds = 0

###----mimic the short pulse of laser to a localized region----
print "*** Laser pulse begins***"
*** Laser pulse begins***
## Create ellipsoidal region of atoms
variable ellipse_a equal ${Height}/2 # spread of laser shot
variable ellipse_a equal 50/2 
variable ellipse_b equal 2*${Height} # depth of laser shot, melt-pool depth for SLM
variable ellipse_b equal 2*50 
variable ellipse_c equal ${ellipse_a}
variable ellipse_c equal 25

variable DistanceLaserShot equal 1.0*${Height}  # center to center distance between laser shots
variable DistanceLaserShot equal 1.0*50  
variable nLaserShot equal floor(${lx}/${DistanceLaserShot})
variable nLaserShot equal floor(301/${DistanceLaserShot})
variable nLaserShot equal floor(301/50)
variable vloopLaser loop ${nLaserShot}
variable vloopLaser loop 6
label labelLaserPulse
print "Laser loop: ${vloopLaser}"
Laser loop: 1

variable temp01 equal 0.00 #((step/${nrun})%2)*${Height}
variable temp02 equal ${DistanceLaserShot}*(${vloopLaser}-1)+${Height}/2
variable temp02 equal 50*(${vloopLaser}-1)+${Height}/2
variable temp02 equal 50*(1-1)+${Height}/2
variable temp02 equal 50*(1-1)+50/2
variable cx equal ${temp01}+${temp02} #((step/${nrun})%2)*10 + 100*${vloopLaser} - 50
variable cx equal 0+${temp02} 
variable cx equal 0+25 
variable cy equal ${y3}
variable cy equal 300
variable cz equal (${z2}+${z3})/2
variable cz equal (0+${z3})/2
variable cz equal (0+3)/2
region AreaLaser01 ellipsoid ${cx} ${cy} ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 25 ${cy} ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 25 300 ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 25 300 1.5 ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 25 300 1.5 25 ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 25 300 1.5 25 100 ${ellipse_c}
region AreaLaser01 ellipsoid 25 300 1.5 25 100 25
group AreaLaser01 region AreaLaser01
20576 atoms in group AreaLaser01
#delete_atoms group AreaLaser01
displace_atoms AreaLaser01 random 0.05 0.1 0.05 123456
Displacing atoms ...
run ${nrun}
run 4
Per MPI rank memory allocation (min/avg/max) = 305 | 320.3 | 346.3 Mbytes
   Step          Temp          PotEng         KinEng        v_Temp02   
        36   1182.8594     -3191807.4      114184.7       804.4043     
        37   1153.3245     -3188970.8      111333.6       594.18468    
        38   1147.3718     -3188462.3      110758.98      513.24436    
        39   1159.9444     -3189766.8      111972.65      553.20199    
        40   1181.0027     -3191882.2      114005.46      670.30101    
Loop time of 13.7265 on 6 procs for 4 steps with 746811 atoms

Performance: 0.126 ns/day, 190.645 hours/ns, 0.291 timesteps/s
96.1% CPU use with 6 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 3.4267     | 3.4864     | 3.5452     |   2.5 | 25.40
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.037784   | 0.096908   | 0.15388    |  13.9 |  0.71
Output  | 10.018     | 10.018     | 10.018     |   0.0 | 72.98
Modify  | 0.11347    | 0.11697    | 0.12028    |   0.8 |  0.85
Other   |            | 0.008441   |            |       |  0.06

Nlocal:         124468 ave      124494 max      124434 min
Histogram: 1 0 1 0 0 1 1 0 0 2
Nghost:         211962 ave      216663 max      210118 min
Histogram: 4 0 0 0 0 1 0 0 0 1
Neighs:    1.05788e+07 ave 1.07347e+07 max 1.02819e+07 min
Histogram: 2 0 0 0 0 0 0 0 0 4
FullNghs:  2.11324e+07 ave 2.14247e+07 max 2.05516e+07 min
Histogram: 2 0 0 0 0 0 0 0 0 4

Total # of neighbors = 1.2679412e+08
Ave neighs/atom = 169.78073
Neighbor list builds = 0
Dangerous builds = 0

region AreaLaser01 delete
group AreaLaser01 delete

next vloopLaser
jump SELF labelLaserPulse
print "Laser loop: ${vloopLaser}"
Laser loop: 2

variable temp01 equal 0.00 #((step/${nrun})%2)*${Height}
variable temp02 equal ${DistanceLaserShot}*(${vloopLaser}-1)+${Height}/2
variable temp02 equal 50*(${vloopLaser}-1)+${Height}/2
variable temp02 equal 50*(2-1)+${Height}/2
variable temp02 equal 50*(2-1)+50/2
variable cx equal ${temp01}+${temp02} #((step/${nrun})%2)*10 + 100*${vloopLaser} - 50
variable cx equal 0+${temp02} 
variable cx equal 0+75 
variable cy equal ${y3}
variable cy equal 300
variable cz equal (${z2}+${z3})/2
variable cz equal (0+${z3})/2
variable cz equal (0+3)/2
region AreaLaser01 ellipsoid ${cx} ${cy} ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 75 ${cy} ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 75 300 ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 75 300 1.5 ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 75 300 1.5 25 ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 75 300 1.5 25 100 ${ellipse_c}
region AreaLaser01 ellipsoid 75 300 1.5 25 100 25
group AreaLaser01 region AreaLaser01
29953 atoms in group AreaLaser01
#delete_atoms group AreaLaser01
displace_atoms AreaLaser01 random 0.05 0.1 0.05 123456
Displacing atoms ...
run ${nrun}
run 4
Per MPI rank memory allocation (min/avg/max) = 305 | 320.4 | 346.3 Mbytes
   Step          Temp          PotEng         KinEng        v_Temp02   
        40   1181.0027     -3182001.4      114005.46      670.30101    
        41   1208.8633     -3184775        116694.92      837.78595    
        42   1240.7578     -3187937.3      119773.78      1022.4722    
        43   1265.8783     -3190413.2      122198.74      1169.5385    
        44   1277.8362     -3191570.3      123353.07      1248.9845    
Loop time of 13.4413 on 6 procs for 4 steps with 746811 atoms

Performance: 0.129 ns/day, 186.685 hours/ns, 0.298 timesteps/s
95.1% CPU use with 6 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 3.3138     | 3.3778     | 3.4106     |   2.1 | 25.13
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.067876   | 0.10149    | 0.16208    |  11.6 |  0.76
Output  | 9.8404     | 9.8405     | 9.8405     |   0.0 | 73.21
Modify  | 0.10949    | 0.11319    | 0.11786    |   0.8 |  0.84
Other   |            | 0.008378   |            |       |  0.06

Nlocal:         124468 ave      124496 max      124418 min
Histogram: 1 0 0 0 0 1 2 0 0 2
Nghost:         211957 ave      216628 max      210116 min
Histogram: 4 0 0 0 0 1 0 0 0 1
Neighs:    1.05569e+07 ave 1.07243e+07 max 1.02304e+07 min
Histogram: 2 0 0 0 0 0 0 0 0 4
FullNghs:  2.11008e+07 ave  2.1403e+07 max 2.04892e+07 min
Histogram: 2 0 0 0 0 0 0 0 0 4

Total # of neighbors = 1.26605e+08
Ave neighs/atom = 169.5275
Neighbor list builds = 0
Dangerous builds = 0

region AreaLaser01 delete
group AreaLaser01 delete

next vloopLaser
jump SELF labelLaserPulse
print "Laser loop: ${vloopLaser}"
Laser loop: 3

variable temp01 equal 0.00 #((step/${nrun})%2)*${Height}
variable temp02 equal ${DistanceLaserShot}*(${vloopLaser}-1)+${Height}/2
variable temp02 equal 50*(${vloopLaser}-1)+${Height}/2
variable temp02 equal 50*(3-1)+${Height}/2
variable temp02 equal 50*(3-1)+50/2
variable cx equal ${temp01}+${temp02} #((step/${nrun})%2)*10 + 100*${vloopLaser} - 50
variable cx equal 0+${temp02} 
variable cx equal 0+125 
variable cy equal ${y3}
variable cy equal 300
variable cz equal (${z2}+${z3})/2
variable cz equal (0+${z3})/2
variable cz equal (0+3)/2
region AreaLaser01 ellipsoid ${cx} ${cy} ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 125 ${cy} ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 125 300 ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 125 300 1.5 ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 125 300 1.5 25 ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 125 300 1.5 25 100 ${ellipse_c}
region AreaLaser01 ellipsoid 125 300 1.5 25 100 25
group AreaLaser01 region AreaLaser01
39542 atoms in group AreaLaser01
#delete_atoms group AreaLaser01
displace_atoms AreaLaser01 random 0.05 0.1 0.05 123456
Displacing atoms ...
run ${nrun}
run 4
Per MPI rank memory allocation (min/avg/max) = 305 | 320.4 | 346.3 Mbytes
   Step          Temp          PotEng         KinEng        v_Temp02   
        44   1277.8362     -3178358.2      123353.07      1248.9845    
        45   1287.2558     -3179269.1      124262.37      1305.2507    
        46   1304.6848     -3180979        125944.83      1387.1909    
        47   1325.4261     -3183006.5      127947.06      1482.9914    
        48   1343.7007     -3184768.4      129711.15      1575.0137    
Loop time of 14.022 on 6 procs for 4 steps with 746811 atoms

Performance: 0.123 ns/day, 194.749 hours/ns, 0.285 timesteps/s
95.1% CPU use with 6 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 3.2528     | 3.3307     | 3.372      |   2.5 | 23.75
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.049394   | 0.088507   | 0.1629     |  14.5 |  0.63
Output  | 10.482     | 10.482     | 10.482     |   0.0 | 74.76
Modify  | 0.10863    | 0.11085    | 0.11392    |   0.7 |  0.79
Other   |            | 0.009473   |            |       |  0.07

Nlocal:         124468 ave      124494 max      124427 min
Histogram: 1 0 0 1 0 1 0 0 2 1
Nghost:         211950 ave      216623 max      210127 min
Histogram: 4 0 0 0 0 1 0 0 0 1
Neighs:    1.05411e+07 ave 1.07121e+07 max 1.02011e+07 min
Histogram: 2 0 0 0 0 0 0 0 0 4
FullNghs:  2.10701e+07 ave 2.13797e+07 max 2.04317e+07 min
Histogram: 2 0 0 0 0 0 0 0 0 4

Total # of neighbors = 1.2642035e+08
Ave neighs/atom = 169.28025
Neighbor list builds = 0
Dangerous builds = 0

region AreaLaser01 delete
group AreaLaser01 delete

next vloopLaser
jump SELF labelLaserPulse
print "Laser loop: ${vloopLaser}"
Laser loop: 4

variable temp01 equal 0.00 #((step/${nrun})%2)*${Height}
variable temp02 equal ${DistanceLaserShot}*(${vloopLaser}-1)+${Height}/2
variable temp02 equal 50*(${vloopLaser}-1)+${Height}/2
variable temp02 equal 50*(4-1)+${Height}/2
variable temp02 equal 50*(4-1)+50/2
variable cx equal ${temp01}+${temp02} #((step/${nrun})%2)*10 + 100*${vloopLaser} - 50
variable cx equal 0+${temp02} 
variable cx equal 0+175 
variable cy equal ${y3}
variable cy equal 300
variable cz equal (${z2}+${z3})/2
variable cz equal (0+${z3})/2
variable cz equal (0+3)/2
region AreaLaser01 ellipsoid ${cx} ${cy} ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 175 ${cy} ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 175 300 ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 175 300 1.5 ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 175 300 1.5 25 ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 175 300 1.5 25 100 ${ellipse_c}
region AreaLaser01 ellipsoid 175 300 1.5 25 100 25
group AreaLaser01 region AreaLaser01
27615 atoms in group AreaLaser01
#delete_atoms group AreaLaser01
displace_atoms AreaLaser01 random 0.05 0.1 0.05 123456
Displacing atoms ...
run ${nrun}
run 4
Per MPI rank memory allocation (min/avg/max) = 305 | 320.4 | 346.3 Mbytes
   Step          Temp          PotEng         KinEng        v_Temp02   
        48   1343.7007     -3175750.6      129711.15      1575.0137    
        49   1363.2559     -3177632.7      131598.86      1687.2169    
        50   1387.4778     -3179976        133937.08      1836.6519    
        51   1409.99       -3182141.7      136110.23      1985.0493    
        52   1424.9377     -3183544.1      137553.18      2095.7084    
Loop time of 13.3662 on 6 procs for 4 steps with 746811 atoms

Performance: 0.129 ns/day, 185.642 hours/ns, 0.299 timesteps/s
95.5% CPU use with 6 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 3.278      | 3.3429     | 3.372      |   1.8 | 25.01
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.059414   | 0.085241   | 0.14641    |  10.6 |  0.64
Output  | 9.8178     | 9.8179     | 9.8179     |   0.0 | 73.45
Modify  | 0.10941    | 0.11224    | 0.11626    |   0.8 |  0.84
Other   |            | 0.007969   |            |       |  0.06

Nlocal:         124468 ave      124497 max      124437 min
Histogram: 1 0 0 1 1 0 1 1 0 1
Nghost:         211935 ave      216594 max      210131 min
Histogram: 4 0 0 0 0 1 0 0 0 1
Neighs:    1.05273e+07 ave 1.07037e+07 max 1.01812e+07 min
Histogram: 2 0 0 0 0 0 0 0 0 4
FullNghs:  2.10448e+07 ave 2.13645e+07 max 2.04047e+07 min
Histogram: 2 0 0 0 0 0 0 0 0 4

Total # of neighbors = 1.2626876e+08
Ave neighs/atom = 169.07726
Neighbor list builds = 0
Dangerous builds = 0

region AreaLaser01 delete
group AreaLaser01 delete

next vloopLaser
jump SELF labelLaserPulse
print "Laser loop: ${vloopLaser}"
Laser loop: 5

variable temp01 equal 0.00 #((step/${nrun})%2)*${Height}
variable temp02 equal ${DistanceLaserShot}*(${vloopLaser}-1)+${Height}/2
variable temp02 equal 50*(${vloopLaser}-1)+${Height}/2
variable temp02 equal 50*(5-1)+${Height}/2
variable temp02 equal 50*(5-1)+50/2
variable cx equal ${temp01}+${temp02} #((step/${nrun})%2)*10 + 100*${vloopLaser} - 50
variable cx equal 0+${temp02} 
variable cx equal 0+225 
variable cy equal ${y3}
variable cy equal 300
variable cz equal (${z2}+${z3})/2
variable cz equal (0+${z3})/2
variable cz equal (0+3)/2
region AreaLaser01 ellipsoid ${cx} ${cy} ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 225 ${cy} ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 225 300 ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 225 300 1.5 ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 225 300 1.5 25 ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 225 300 1.5 25 100 ${ellipse_c}
region AreaLaser01 ellipsoid 225 300 1.5 25 100 25
group AreaLaser01 region AreaLaser01
22127 atoms in group AreaLaser01
#delete_atoms group AreaLaser01
displace_atoms AreaLaser01 random 0.05 0.1 0.05 123456
Displacing atoms ...
run ${nrun}
run 4
Per MPI rank memory allocation (min/avg/max) = 305 | 320.4 | 346.3 Mbytes
   Step          Temp          PotEng         KinEng        v_Temp02   
        52   1424.9377     -3176371.6      137553.18      2095.7084    
        53   1435.5043     -3177337.4      138573.2       2173.795     
        54   1445.5523     -3178249.7      139543.17      2232.0705    
        55   1452.3692     -3178832.2      140201.22      2261.8576    
        56   1454.0737     -3178891.4      140365.76      2260.9152    
Loop time of 13.5617 on 6 procs for 4 steps with 746811 atoms

Performance: 0.127 ns/day, 188.356 hours/ns, 0.295 timesteps/s
95.9% CPU use with 6 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 3.5997     | 3.6698     | 3.7047     |   2.2 | 27.06
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.068127   | 0.10061    | 0.16737    |  12.9 |  0.74
Output  | 9.6643     | 9.6644     | 9.6645     |   0.0 | 71.26
Modify  | 0.11593    | 0.11829    | 0.12165    |   0.7 |  0.87
Other   |            | 0.008596   |            |       |  0.06

Nlocal:         124468 ave      124497 max      124429 min
Histogram: 1 0 0 0 1 1 1 1 0 1
Nghost:         211922 ave      216566 max      210132 min
Histogram: 4 0 0 0 0 1 0 0 0 1
Neighs:    1.05157e+07 ave 1.06948e+07 max 1.01636e+07 min
Histogram: 2 0 0 0 0 0 0 0 0 4
FullNghs:   2.1021e+07 ave 2.13516e+07 max 2.03547e+07 min
Histogram: 2 0 0 0 0 0 0 0 0 4

Total # of neighbors = 1.2612623e+08
Ave neighs/atom = 168.88642
Neighbor list builds = 0
Dangerous builds = 0

region AreaLaser01 delete
group AreaLaser01 delete

next vloopLaser
jump SELF labelLaserPulse
print "Laser loop: ${vloopLaser}"
Laser loop: 6

variable temp01 equal 0.00 #((step/${nrun})%2)*${Height}
variable temp02 equal ${DistanceLaserShot}*(${vloopLaser}-1)+${Height}/2
variable temp02 equal 50*(${vloopLaser}-1)+${Height}/2
variable temp02 equal 50*(6-1)+${Height}/2
variable temp02 equal 50*(6-1)+50/2
variable cx equal ${temp01}+${temp02} #((step/${nrun})%2)*10 + 100*${vloopLaser} - 50
variable cx equal 0+${temp02} 
variable cx equal 0+275 
variable cy equal ${y3}
variable cy equal 300
variable cz equal (${z2}+${z3})/2
variable cz equal (0+${z3})/2
variable cz equal (0+3)/2
region AreaLaser01 ellipsoid ${cx} ${cy} ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 275 ${cy} ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 275 300 ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 275 300 1.5 ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 275 300 1.5 25 ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 275 300 1.5 25 100 ${ellipse_c}
region AreaLaser01 ellipsoid 275 300 1.5 25 100 25
group AreaLaser01 region AreaLaser01
28127 atoms in group AreaLaser01
#delete_atoms group AreaLaser01
displace_atoms AreaLaser01 random 0.05 0.1 0.05 123456
Displacing atoms ...
run ${nrun}
run 4
Per MPI rank memory allocation (min/avg/max) = 305 | 320.4 | 346.3 Mbytes
   Step          Temp          PotEng         KinEng        v_Temp02   
        56   1454.0737     -3169789.1      140365.76      2260.9152    
        57   1458.5122     -3170110.7      140794.22      2265.2367    
        58   1471.6614     -3171287.3      142063.55      2307.1431    
        59   1488.5554     -3172818.2      143694.37      2373.1371    
        60   1503.5359     -3174138.4      145140.48      2443.566     
Loop time of 13.3585 on 6 procs for 4 steps with 746811 atoms

Performance: 0.129 ns/day, 185.535 hours/ns, 0.299 timesteps/s
95.5% CPU use with 6 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 3.3449     | 3.3865     | 3.4223     |   1.6 | 25.35
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.055402   | 0.090137   | 0.12803    |   9.2 |  0.67
Output  | 9.7602     | 9.7603     | 9.7603     |   0.0 | 73.06
Modify  | 0.10944    | 0.1122     | 0.11606    |   0.7 |  0.84
Other   |            | 0.009365   |            |       |  0.07

Nlocal:         124468 ave      124508 max      124424 min
Histogram: 1 0 0 0 2 0 2 0 0 1
Nghost:         211909 ave      216551 max      210133 min
Histogram: 4 0 0 0 0 1 0 0 0 1
Neighs:    1.05033e+07 ave 1.06902e+07 max 1.01395e+07 min
Histogram: 2 0 0 0 0 0 0 0 0 4
FullNghs:  2.09971e+07 ave 2.13463e+07 max 2.02979e+07 min
Histogram: 2 0 0 0 0 0 0 0 0 4

Total # of neighbors = 1.2598262e+08
Ave neighs/atom = 168.69411
Neighbor list builds = 0
Dangerous builds = 0

region AreaLaser01 delete
group AreaLaser01 delete

next vloopLaser
jump SELF labelLaserPulse

print "*** Idle run begins***"
*** Idle run begins***
run ${nrunIdle}
run 0
Per MPI rank memory allocation (min/avg/max) = 305 | 320.4 | 346.3 Mbytes
   Step          Temp          PotEng         KinEng        v_Temp02   
        60   1503.5359     -3174138.4      145140.48      2443.566     
Loop time of 3.07333e-05 on 6 procs for 0 steps with 746811 atoms

0.0% CPU use with 6 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0          | 0          | 0          |   0.0 |  0.00
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 3.073e-05  |            |       |100.00

Nlocal:         124468 ave      124534 max      124411 min
Histogram: 1 1 0 1 0 0 2 0 0 1
Nghost:         211904 ave      216508 max      210121 min
Histogram: 4 0 0 0 0 1 0 0 0 1
Neighs:    1.04944e+07 ave 1.06875e+07 max 1.01151e+07 min
Histogram: 2 0 0 0 0 0 0 0 0 4
FullNghs:  2.09971e+07 ave 2.13463e+07 max 2.02979e+07 min
Histogram: 2 0 0 0 0 0 0 0 0 4

Total # of neighbors = 1.2598262e+08
Ave neighs/atom = 168.69411
Neighbor list builds = 0
Dangerous builds = 0

print "******LAMMPS loop finished******"
******LAMMPS loop finished******


jump script_LAMMPS_Basic.inp labelAMLoop
print "loop: ${loop01}"
loop: 3
next loop01
jump script_LAMMPS_AM.inp
### command to run recurssively for AM simulation
### Delete previous fix, region, group etc. before redefining

### delete the bottom atom righ at the begining and reassign before the next run for T-control
delete_atoms region BlockDeleteAtomsBottom_01
Deleted 181379 atoms, new total = 565432

unfix 1
unfix fPushParticles
unfix fLangevin
region BlockInside delete
group GroupInside delete
region BlockDeleteAtomsBottom_01 delete
group GroupDeleteAtomsBottom_01 delete
region BlockCreateAtomsTop_01 delete
group GroupCreateAtomsTop_01 delete

variable delta_y equal (step/${nrun})*${Height}
variable delta_y equal (step/4)*${Height}
variable delta_y equal (step/4)*50
if "${nAtomsAll} > ${nAtomsInitial}" then "variable y1 equal ${y1}+${Height}" # This will make sure that total number of atom is close to initial atoms
variable y1 equal ${y1}+${Height}
variable y1 equal 100+${Height}
variable y1 equal 100+50
variable y2 equal ${y2}+${Height}
variable y2 equal 250+${Height}
variable y2 equal 250+50
variable y3 equal ${y3}+${Height}
variable y3 equal 300+${Height}
variable y3 equal 300+50
variable y_Inside equal ${y1}+2
variable y_Inside equal 150+2

### update other regions
region		BlockDeleteAtomsBottom_01 block INF INF INF ${y1} INF INF # delete all atom down the interface
region		BlockDeleteAtomsBottom_01 block INF INF INF 150 INF INF 
region		BlockCreateAtomsTop_01 block INF INF ${y2} ${y3} INF INF
region		BlockCreateAtomsTop_01 block INF INF 300 ${y3} INF INF
region		BlockCreateAtomsTop_01 block INF INF 300 350 INF INF
region		BlockInside block INF INF ${y_Inside} INF INF INF
region		BlockInside block INF INF 152 INF INF INF

###----create atoms i.e, spherical powder particles in a loop-----
print "*** Powder particle creation begins***"
*** Powder particle creation begins***
variable nParticles equal floor(${lx}/(${Height})) # square box shaped
variable nParticles equal floor(301/(${Height})) 
variable nParticles equal floor(301/(50)) 
variable radiusIdeal equal ${Height}/2
variable radiusIdeal equal 50/2
variable vloopParticle loop ${nParticles}
variable vloopParticle loop 6
label labelParticleCreation
print "Grain creation loop: ${vloopParticle}"
Grain creation loop: 1
variable perturb01 equal v_random01
if "(${vloopParticle} == 0) || (${vloopParticle} == ${nParticles})" then "variable perturb01 equal 0.00"

variable radius equal (0.75+0.25*${perturb01})*${radiusIdeal}
variable radius equal (0.75+0.25*0.337953329086304)*${radiusIdeal}
variable radius equal (0.75+0.25*0.337953329086304)*25
variable temp01 equal ${perturb01}*${radiusIdeal}  #((step/${nrun})%2)*${radius}
variable temp01 equal 0.499910116195679*${radiusIdeal}  
variable temp01 equal 0.499910116195679*25  
variable temp02 equal 2*${radiusIdeal}*(${vloopParticle}-1)+${radiusIdeal}
variable temp02 equal 2*25*(${vloopParticle}-1)+${radiusIdeal}
variable temp02 equal 2*25*(1-1)+${radiusIdeal}
variable temp02 equal 2*25*(1-1)+25
variable cx equal ${temp01}+${temp02} #((step/${nrun})%2)*10 + 100*${vloopParticle} - 50
variable cx equal 12.497752904892+${temp02} 
variable cx equal 12.497752904892+25 
variable cy equal (${y2}+${y3})/2
variable cy equal (300+${y3})/2
variable cy equal (300+350)/2
variable cz equal (${z2}+${z3})/2
variable cz equal (0+${z3})/2
variable cz equal (0+3)/2
print "Grain parameters cx: ${cx} cy: ${cy} cz: ${cz} radius: ${radius}"
Grain parameters cx: 37.497752904892 cy: 325 cz: 1.5 radius: 20.8622083067894
region Particle sphere ${cx} ${cy} ${cz} ${radius}
region Particle sphere 37.497752904892 ${cy} ${cz} ${radius}
region Particle sphere 37.497752904892 325 ${cz} ${radius}
region Particle sphere 37.497752904892 325 1.5 ${radius}
region Particle sphere 37.497752904892 325 1.5 20.8622083067894

create_atoms 1 region Particle
Created 19063 atoms
  using lattice units in orthogonal box = (-1.9255915 176 -0.019285942) to (1061.4456 1763.52 10.579286)
  create_atoms CPU = 0.016 seconds
group Particle region Particle
19063 atoms in group Particle

variable theta_z equal ${random01}*90  # angle to rotate the grain
variable theta_z equal 0.043809711933136*90  
displace_atoms Particle rotate ${cx} ${cy} ${cz} 0 0 1 ${theta_z} # rotate wrt z-axis
displace_atoms Particle rotate 37.497752904892 ${cy} ${cz} 0 0 1 ${theta_z} 
displace_atoms Particle rotate 37.497752904892 325 ${cz} 0 0 1 ${theta_z} 
displace_atoms Particle rotate 37.497752904892 325 1.5 0 0 1 ${theta_z} 
displace_atoms Particle rotate 37.497752904892 325 1.5 0 0 1 3.94287407398224 
Displacing atoms ...

group GroupCreateAtomsTop_01 union GroupCreateAtomsTop_01 Particle
19063 atoms in group GroupCreateAtomsTop_01
region Particle delete
group Particle delete

next vloopParticle
jump SELF labelParticleCreation
print "Grain creation loop: ${vloopParticle}"
Grain creation loop: 2
variable perturb01 equal v_random01
if "(${vloopParticle} == 0) || (${vloopParticle} == ${nParticles})" then "variable perturb01 equal 0.00"

variable radius equal (0.75+0.25*${perturb01})*${radiusIdeal}
variable radius equal (0.75+0.25*0.531158328056335)*${radiusIdeal}
variable radius equal (0.75+0.25*0.531158328056335)*25
variable temp01 equal ${perturb01}*${radiusIdeal}  #((step/${nrun})%2)*${radius}
variable temp01 equal 0.299755871295929*${radiusIdeal}  
variable temp01 equal 0.299755871295929*25  
variable temp02 equal 2*${radiusIdeal}*(${vloopParticle}-1)+${radiusIdeal}
variable temp02 equal 2*25*(${vloopParticle}-1)+${radiusIdeal}
variable temp02 equal 2*25*(2-1)+${radiusIdeal}
variable temp02 equal 2*25*(2-1)+25
variable cx equal ${temp01}+${temp02} #((step/${nrun})%2)*10 + 100*${vloopParticle} - 50
variable cx equal 7.49389678239823+${temp02} 
variable cx equal 7.49389678239823+75 
variable cy equal (${y2}+${y3})/2
variable cy equal (300+${y3})/2
variable cy equal (300+350)/2
variable cz equal (${z2}+${z3})/2
variable cz equal (0+${z3})/2
variable cz equal (0+3)/2
print "Grain parameters cx: ${cx} cy: ${cy} cz: ${cz} radius: ${radius}"
Grain parameters cx: 82.4938967823982 cy: 325 cz: 1.5 radius: 22.0697395503521
region Particle sphere ${cx} ${cy} ${cz} ${radius}
region Particle sphere 82.4938967823982 ${cy} ${cz} ${radius}
region Particle sphere 82.4938967823982 325 ${cz} ${radius}
region Particle sphere 82.4938967823982 325 1.5 ${radius}
region Particle sphere 82.4938967823982 325 1.5 22.0697395503521

create_atoms 1 region Particle
Created 21407 atoms
  using lattice units in orthogonal box = (-1.9255915 176 -0.019285942) to (1061.4456 1763.52 10.579286)
  create_atoms CPU = 0.016 seconds
group Particle region Particle
21407 atoms in group Particle

variable theta_z equal ${random01}*90  # angle to rotate the grain
variable theta_z equal 0.48324316740036*90  
displace_atoms Particle rotate ${cx} ${cy} ${cz} 0 0 1 ${theta_z} # rotate wrt z-axis
displace_atoms Particle rotate 82.4938967823982 ${cy} ${cz} 0 0 1 ${theta_z} 
displace_atoms Particle rotate 82.4938967823982 325 ${cz} 0 0 1 ${theta_z} 
displace_atoms Particle rotate 82.4938967823982 325 1.5 0 0 1 ${theta_z} 
displace_atoms Particle rotate 82.4938967823982 325 1.5 0 0 1 43.4918850660324 
Displacing atoms ...

group GroupCreateAtomsTop_01 union GroupCreateAtomsTop_01 Particle
40470 atoms in group GroupCreateAtomsTop_01
region Particle delete
group Particle delete

next vloopParticle
jump SELF labelParticleCreation
print "Grain creation loop: ${vloopParticle}"
Grain creation loop: 3
variable perturb01 equal v_random01
if "(${vloopParticle} == 0) || (${vloopParticle} == ${nParticles})" then "variable perturb01 equal 0.00"

variable radius equal (0.75+0.25*${perturb01})*${radiusIdeal}
variable radius equal (0.75+0.25*0.275726497173309)*${radiusIdeal}
variable radius equal (0.75+0.25*0.275726497173309)*25
variable temp01 equal ${perturb01}*${radiusIdeal}  #((step/${nrun})%2)*${radius}
variable temp01 equal 0.588827192783356*${radiusIdeal}  
variable temp01 equal 0.588827192783356*25  
variable temp02 equal 2*${radiusIdeal}*(${vloopParticle}-1)+${radiusIdeal}
variable temp02 equal 2*25*(${vloopParticle}-1)+${radiusIdeal}
variable temp02 equal 2*25*(3-1)+${radiusIdeal}
variable temp02 equal 2*25*(3-1)+25
variable cx equal ${temp01}+${temp02} #((step/${nrun})%2)*10 + 100*${vloopParticle} - 50
variable cx equal 14.7206798195839+${temp02} 
variable cx equal 14.7206798195839+125 
variable cy equal (${y2}+${y3})/2
variable cy equal (300+${y3})/2
variable cy equal (300+350)/2
variable cz equal (${z2}+${z3})/2
variable cz equal (0+${z3})/2
variable cz equal (0+3)/2
print "Grain parameters cx: ${cx} cy: ${cy} cz: ${cz} radius: ${radius}"
Grain parameters cx: 139.720679819584 cy: 325 cz: 1.5 radius: 20.4732906073332
region Particle sphere ${cx} ${cy} ${cz} ${radius}
region Particle sphere 139.720679819584 ${cy} ${cz} ${radius}
region Particle sphere 139.720679819584 325 ${cz} ${radius}
region Particle sphere 139.720679819584 325 1.5 ${radius}
region Particle sphere 139.720679819584 325 1.5 20.4732906073332

create_atoms 1 region Particle
Created 18397 atoms
  using lattice units in orthogonal box = (-1.9255915 176 -0.019285942) to (1061.4456 1763.52 10.579286)
  create_atoms CPU = 0.012 seconds
group Particle region Particle
18397 atoms in group Particle

variable theta_z equal ${random01}*90  # angle to rotate the grain
variable theta_z equal 0.655290603637695*90  
displace_atoms Particle rotate ${cx} ${cy} ${cz} 0 0 1 ${theta_z} # rotate wrt z-axis
displace_atoms Particle rotate 139.720679819584 ${cy} ${cz} 0 0 1 ${theta_z} 
displace_atoms Particle rotate 139.720679819584 325 ${cz} 0 0 1 ${theta_z} 
displace_atoms Particle rotate 139.720679819584 325 1.5 0 0 1 ${theta_z} 
displace_atoms Particle rotate 139.720679819584 325 1.5 0 0 1 58.9761543273925 
Displacing atoms ...

group GroupCreateAtomsTop_01 union GroupCreateAtomsTop_01 Particle
58867 atoms in group GroupCreateAtomsTop_01
region Particle delete
group Particle delete

next vloopParticle
jump SELF labelParticleCreation
print "Grain creation loop: ${vloopParticle}"
Grain creation loop: 4
variable perturb01 equal v_random01
if "(${vloopParticle} == 0) || (${vloopParticle} == ${nParticles})" then "variable perturb01 equal 0.00"

variable radius equal (0.75+0.25*${perturb01})*${radiusIdeal}
variable radius equal (0.75+0.25*0.816808521747589)*${radiusIdeal}
variable radius equal (0.75+0.25*0.816808521747589)*25
variable temp01 equal ${perturb01}*${radiusIdeal}  #((step/${nrun})%2)*${radius}
variable temp01 equal 0.275342524051666*${radiusIdeal}  
variable temp01 equal 0.275342524051666*25  
variable temp02 equal 2*${radiusIdeal}*(${vloopParticle}-1)+${radiusIdeal}
variable temp02 equal 2*25*(${vloopParticle}-1)+${radiusIdeal}
variable temp02 equal 2*25*(4-1)+${radiusIdeal}
variable temp02 equal 2*25*(4-1)+25
variable cx equal ${temp01}+${temp02} #((step/${nrun})%2)*10 + 100*${vloopParticle} - 50
variable cx equal 6.88356310129165+${temp02} 
variable cx equal 6.88356310129165+175 
variable cy equal (${y2}+${y3})/2
variable cy equal (300+${y3})/2
variable cy equal (300+350)/2
variable cz equal (${z2}+${z3})/2
variable cz equal (0+${z3})/2
variable cz equal (0+3)/2
print "Grain parameters cx: ${cx} cy: ${cy} cz: ${cz} radius: ${radius}"
Grain parameters cx: 181.883563101292 cy: 325 cz: 1.5 radius: 23.8550532609224
region Particle sphere ${cx} ${cy} ${cz} ${radius}
region Particle sphere 181.883563101292 ${cy} ${cz} ${radius}
region Particle sphere 181.883563101292 325 ${cz} ${radius}
region Particle sphere 181.883563101292 325 1.5 ${radius}
region Particle sphere 181.883563101292 325 1.5 23.8550532609224

create_atoms 1 region Particle
Created 24984 atoms
  using lattice units in orthogonal box = (-1.9255915 176 -0.019285942) to (1061.4456 1763.52 10.579286)
  create_atoms CPU = 0.019 seconds
group Particle region Particle
25257 atoms in group Particle

variable theta_z equal ${random01}*90  # angle to rotate the grain
variable theta_z equal 0.680057764053345*90  
displace_atoms Particle rotate ${cx} ${cy} ${cz} 0 0 1 ${theta_z} # rotate wrt z-axis
displace_atoms Particle rotate 181.883563101292 ${cy} ${cz} 0 0 1 ${theta_z} 
displace_atoms Particle rotate 181.883563101292 325 ${cz} 0 0 1 ${theta_z} 
displace_atoms Particle rotate 181.883563101292 325 1.5 0 0 1 ${theta_z} 
displace_atoms Particle rotate 181.883563101292 325 1.5 0 0 1 61.205198764801 
Displacing atoms ...

group GroupCreateAtomsTop_01 union GroupCreateAtomsTop_01 Particle
83851 atoms in group GroupCreateAtomsTop_01
region Particle delete
group Particle delete

next vloopParticle
jump SELF labelParticleCreation
print "Grain creation loop: ${vloopParticle}"
Grain creation loop: 5
variable perturb01 equal v_random01
if "(${vloopParticle} == 0) || (${vloopParticle} == ${nParticles})" then "variable perturb01 equal 0.00"

variable radius equal (0.75+0.25*${perturb01})*${radiusIdeal}
variable radius equal (0.75+0.25*0.160244345664978)*${radiusIdeal}
variable radius equal (0.75+0.25*0.160244345664978)*25
variable temp01 equal ${perturb01}*${radiusIdeal}  #((step/${nrun})%2)*${radius}
variable temp01 equal 0.804994821548462*${radiusIdeal}  
variable temp01 equal 0.804994821548462*25  
variable temp02 equal 2*${radiusIdeal}*(${vloopParticle}-1)+${radiusIdeal}
variable temp02 equal 2*25*(${vloopParticle}-1)+${radiusIdeal}
variable temp02 equal 2*25*(5-1)+${radiusIdeal}
variable temp02 equal 2*25*(5-1)+25
variable cx equal ${temp01}+${temp02} #((step/${nrun})%2)*10 + 100*${vloopParticle} - 50
variable cx equal 20.1248705387116+${temp02} 
variable cx equal 20.1248705387116+225 
variable cy equal (${y2}+${y3})/2
variable cy equal (300+${y3})/2
variable cy equal (300+350)/2
variable cz equal (${z2}+${z3})/2
variable cz equal (0+${z3})/2
variable cz equal (0+3)/2
print "Grain parameters cx: ${cx} cy: ${cy} cz: ${cz} radius: ${radius}"
Grain parameters cx: 245.124870538712 cy: 325 cz: 1.5 radius: 19.7515271604061
region Particle sphere ${cx} ${cy} ${cz} ${radius}
region Particle sphere 245.124870538712 ${cy} ${cz} ${radius}
region Particle sphere 245.124870538712 325 ${cz} ${radius}
region Particle sphere 245.124870538712 325 1.5 ${radius}
region Particle sphere 245.124870538712 325 1.5 19.7515271604061

create_atoms 1 region Particle
Created 17114 atoms
  using lattice units in orthogonal box = (-1.9255915 176 -0.019285942) to (1061.4456 1763.52 10.579286)
  create_atoms CPU = 0.016 seconds
group Particle region Particle
17114 atoms in group Particle

variable theta_z equal ${random01}*90  # angle to rotate the grain
variable theta_z equal 0.747154355049133*90  
displace_atoms Particle rotate ${cx} ${cy} ${cz} 0 0 1 ${theta_z} # rotate wrt z-axis
displace_atoms Particle rotate 245.124870538712 ${cy} ${cz} 0 0 1 ${theta_z} 
displace_atoms Particle rotate 245.124870538712 325 ${cz} 0 0 1 ${theta_z} 
displace_atoms Particle rotate 245.124870538712 325 1.5 0 0 1 ${theta_z} 
displace_atoms Particle rotate 245.124870538712 325 1.5 0 0 1 67.243891954422 
Displacing atoms ...

group GroupCreateAtomsTop_01 union GroupCreateAtomsTop_01 Particle
100965 atoms in group GroupCreateAtomsTop_01
region Particle delete
group Particle delete

next vloopParticle
jump SELF labelParticleCreation
print "Grain creation loop: ${vloopParticle}"
Grain creation loop: 6
variable perturb01 equal v_random01
if "(${vloopParticle} == 0) || (${vloopParticle} == ${nParticles})" then "variable perturb01 equal 0.00"
variable perturb01 equal 0.00

variable radius equal (0.75+0.25*${perturb01})*${radiusIdeal}
variable radius equal (0.75+0.25*0)*${radiusIdeal}
variable radius equal (0.75+0.25*0)*25
variable temp01 equal ${perturb01}*${radiusIdeal}  #((step/${nrun})%2)*${radius}
variable temp01 equal 0*${radiusIdeal}  
variable temp01 equal 0*25  
variable temp02 equal 2*${radiusIdeal}*(${vloopParticle}-1)+${radiusIdeal}
variable temp02 equal 2*25*(${vloopParticle}-1)+${radiusIdeal}
variable temp02 equal 2*25*(6-1)+${radiusIdeal}
variable temp02 equal 2*25*(6-1)+25
variable cx equal ${temp01}+${temp02} #((step/${nrun})%2)*10 + 100*${vloopParticle} - 50
variable cx equal 0+${temp02} 
variable cx equal 0+275 
variable cy equal (${y2}+${y3})/2
variable cy equal (300+${y3})/2
variable cy equal (300+350)/2
variable cz equal (${z2}+${z3})/2
variable cz equal (0+${z3})/2
variable cz equal (0+3)/2
print "Grain parameters cx: ${cx} cy: ${cy} cz: ${cz} radius: ${radius}"
Grain parameters cx: 275 cy: 325 cz: 1.5 radius: 18.75
region Particle sphere ${cx} ${cy} ${cz} ${radius}
region Particle sphere 275 ${cy} ${cz} ${radius}
region Particle sphere 275 325 ${cz} ${radius}
region Particle sphere 275 325 1.5 ${radius}
region Particle sphere 275 325 1.5 18.75

create_atoms 1 region Particle
Created 15432 atoms
  using lattice units in orthogonal box = (-1.9255915 176 -0.019285942) to (1061.4456 1763.52 10.579286)
  create_atoms CPU = 0.016 seconds
group Particle region Particle
17424 atoms in group Particle

variable theta_z equal ${random01}*90  # angle to rotate the grain
variable theta_z equal 0.0608575344085693*90  
displace_atoms Particle rotate ${cx} ${cy} ${cz} 0 0 1 ${theta_z} # rotate wrt z-axis
displace_atoms Particle rotate 275 ${cy} ${cz} 0 0 1 ${theta_z} 
displace_atoms Particle rotate 275 325 ${cz} 0 0 1 ${theta_z} 
displace_atoms Particle rotate 275 325 1.5 0 0 1 ${theta_z} 
displace_atoms Particle rotate 275 325 1.5 0 0 1 5.47717809677124 
Displacing atoms ...

group GroupCreateAtomsTop_01 union GroupCreateAtomsTop_01 Particle
116397 atoms in group GroupCreateAtomsTop_01
region Particle delete
group Particle delete

next vloopParticle
jump SELF labelParticleCreation

### Assign velocity/Temperature to the newly created atoms
#group GroupCreateAtomsTop_01 region BlockCreateAtomsTop_01
delete_atoms overlap 2.25 GroupCreateAtomsTop_01 all  # atoms from the first group will be deleted
System init for delete_atoms ...
Neighbor list info ...
  update: every = 1 steps, delay = 10 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 7.65
  ghost atom cutoff = 7.65
  binsize = 3.825, bins = 279 416 3
  4 neighbor lists, perpetual/occasional/extra = 1 3 0
  (1) command delete_atoms, occasional
      attributes: full, newton on
      pair build: full/bin/atomonly
      stencil: full/bin/3d
      bin: standard
  (2) pair eam/alloy, perpetual
      attributes: half, newton on
      pair build: half/bin/atomonly/newton
      stencil: half/bin/3d
      bin: standard
  (3) compute cna/atom, occasional
      attributes: full, newton on
      pair build: full/bin/atomonly
      stencil: full/bin/3d
      bin: standard
  (4) compute centro/atom, occasional
      attributes: full, newton on
      pair build: full/bin/atomonly
      stencil: full/bin/3d
      bin: standard
Deleted 18709 atoms, new total = 663120
velocity	GroupCreateAtomsTop_01 create ${T2} 187723 #temp Temperature # assign velocity of the newly created atoms
velocity	GroupCreateAtomsTop_01 create 1600 187723 

### Redefine the group, fix etc.
group GroupDeleteAtomsBottom_01 region BlockDeleteAtomsBottom_01
180740 atoms in group GroupDeleteAtomsBottom_01
group GroupInside region BlockInside
475183 atoms in group GroupInside
#fix 1 GroupInside nve
fix  1 GroupInside npt temp $T $T 0.2 drag 0.5 x 0.0 0.0 5 z 0.0 0.0 5 couple none
fix  1 GroupInside npt temp 800 $T 0.2 drag 0.5 x 0.0 0.0 5 z 0.0 0.0 5 couple none
fix  1 GroupInside npt temp 800 800 0.2 drag 0.5 x 0.0 0.0 5 z 0.0 0.0 5 couple none
fix fPushParticles GroupCreateAtomsTop_01 addforce 0.0 -0.2 0.0 every 1
fix fLangevin GroupDeleteAtomsBottom_01 langevin ${T} ${T} 0.5 123456
fix fLangevin GroupDeleteAtomsBottom_01 langevin 800 ${T} 0.5 123456
fix fLangevin GroupDeleteAtomsBottom_01 langevin 800 800 0.5 123456

print "nAtomsAll: ${nAtomsAll}; nAtomsInitial: ${nAtomsInitial}; nAtomsNew: ${nAtomsNew}"
nAtomsAll: 663120; nAtomsInitial: 543606; nAtomsNew: 97688

balance 1.1 rcb  # load balancing
Balancing ...
Neighbor list info ...
  update: every = 1 steps, delay = 10 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 7.65
  ghost atom cutoff = 7.65
  binsize = 3.825, bins = 279 416 3
  3 neighbor lists, perpetual/occasional/extra = 1 2 0
  (1) pair eam/alloy, perpetual
      attributes: half, newton on
      pair build: half/bin/atomonly/newton
      stencil: half/bin/3d
      bin: standard
  (2) compute cna/atom, occasional
      attributes: full, newton on
      pair build: full/bin/atomonly
      stencil: full/bin/3d
      bin: standard
  (3) compute centro/atom, occasional
      attributes: full, newton on
      pair build: full/bin/atomonly
      stencil: full/bin/3d
      bin: standard
 rebalancing time: 0.107 seconds
  iteration count = 0
  initial/final maximal load/proc = 176110 110521
  initial/final imbalance factor  = 1.5934672 1.000009

run ${nrun}
run 4
Per MPI rank memory allocation (min/avg/max) = 217.8 | 235.3 | 269 Mbytes
   Step          Temp          PotEng         KinEng        v_Temp02   
        60   1716.2627     -2815404.8      147109.21      1603.2102    
        61   1711.7244     -2815085.8      146720.22      1535.4977    
        62   1682.3162     -2812695.3      144199.5       1348.7469    
        63   1636.9309     -2808885.5      140309.3       1086.7016    
        64   1586.1733     -2804616.1      135958.62      809.26563    
Loop time of 11.3749 on 6 procs for 4 steps with 663120 atoms

Performance: 0.152 ns/day, 157.985 hours/ns, 0.352 timesteps/s
95.6% CPU use with 6 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2.8228     | 2.8533     | 2.8693     |   1.0 | 25.08
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.041749   | 0.06101    | 0.090306   |   6.7 |  0.54
Output  | 8.3565     | 8.3566     | 8.3566     |   0.0 | 73.46
Modify  | 0.094779   | 0.097026   | 0.099867   |   0.7 |  0.85
Other   |            | 0.007052   |            |       |  0.06

Nlocal:         110520 ave      110521 max      110519 min
Histogram: 2 0 0 0 0 2 0 0 0 2
Nghost:         182980 ave      187117 max      177821 min
Histogram: 2 0 0 0 0 0 0 3 0 1
Neighs:    9.26797e+06 ave 9.34056e+06 max 9.13696e+06 min
Histogram: 2 0 0 0 0 0 0 0 0 4
FullNghs:  1.85299e+07 ave 1.86579e+07 max 1.82926e+07 min
Histogram: 2 0 0 0 0 0 0 0 0 4

Total # of neighbors = 1.1117957e+08
Ave neighs/atom = 167.66131
Neighbor list builds = 0
Dangerous builds = 0

###----mimic the short pulse of laser to a localized region----
print "*** Laser pulse begins***"
*** Laser pulse begins***
## Create ellipsoidal region of atoms
variable ellipse_a equal ${Height}/2 # spread of laser shot
variable ellipse_a equal 50/2 
variable ellipse_b equal 2*${Height} # depth of laser shot, melt-pool depth for SLM
variable ellipse_b equal 2*50 
variable ellipse_c equal ${ellipse_a}
variable ellipse_c equal 25

variable DistanceLaserShot equal 1.0*${Height}  # center to center distance between laser shots
variable DistanceLaserShot equal 1.0*50  
variable nLaserShot equal floor(${lx}/${DistanceLaserShot})
variable nLaserShot equal floor(301/${DistanceLaserShot})
variable nLaserShot equal floor(301/50)
variable vloopLaser loop ${nLaserShot}
variable vloopLaser loop 6
label labelLaserPulse
print "Laser loop: ${vloopLaser}"
Laser loop: 1

variable temp01 equal 0.00 #((step/${nrun})%2)*${Height}
variable temp02 equal ${DistanceLaserShot}*(${vloopLaser}-1)+${Height}/2
variable temp02 equal 50*(${vloopLaser}-1)+${Height}/2
variable temp02 equal 50*(1-1)+${Height}/2
variable temp02 equal 50*(1-1)+50/2
variable cx equal ${temp01}+${temp02} #((step/${nrun})%2)*10 + 100*${vloopLaser} - 50
variable cx equal 0+${temp02} 
variable cx equal 0+25 
variable cy equal ${y3}
variable cy equal 350
variable cz equal (${z2}+${z3})/2
variable cz equal (0+${z3})/2
variable cz equal (0+3)/2
region AreaLaser01 ellipsoid ${cx} ${cy} ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 25 ${cy} ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 25 350 ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 25 350 1.5 ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 25 350 1.5 25 ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 25 350 1.5 25 100 ${ellipse_c}
region AreaLaser01 ellipsoid 25 350 1.5 25 100 25
group AreaLaser01 region AreaLaser01
20914 atoms in group AreaLaser01
#delete_atoms group AreaLaser01
displace_atoms AreaLaser01 random 0.05 0.1 0.05 123456
Displacing atoms ...
run ${nrun}
run 4
Per MPI rank memory allocation (min/avg/max) = 289.9 | 308.1 | 343.8 Mbytes
   Step          Temp          PotEng         KinEng        v_Temp02   
        64   1586.1733     -2797884.4      135958.62      809.26563    
        65   1547.5355     -2794690.4      132646.79      604.44993    
        66   1533.3635     -2793641.4      131432.04      534.1674     
        67   1540.6567     -2794461.2      132057.17      585.71128    
        68   1560.372      -2796348.7      133747.07      711.23096    
Loop time of 11.3258 on 6 procs for 4 steps with 663120 atoms

Performance: 0.153 ns/day, 157.303 hours/ns, 0.353 timesteps/s
94.9% CPU use with 6 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2.7332     | 2.759      | 2.7903     |   1.1 | 24.36
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.046323   | 0.078037   | 0.10349    |   6.4 |  0.69
Output  | 8.3853     | 8.3853     | 8.3854     |   0.0 | 74.04
Modify  | 0.093329   | 0.095776   | 0.098731   |   0.7 |  0.85
Other   |            | 0.007636   |            |       |  0.07

Nlocal:         110520 ave      110551 max      110494 min
Histogram: 2 0 0 0 1 1 1 0 0 1
Nghost:         182941 ave      187123 max      177716 min
Histogram: 2 0 0 0 0 0 0 3 0 1
Neighs:    9.24114e+06 ave 9.33661e+06 max 9.05849e+06 min
Histogram: 2 0 0 0 0 0 0 0 0 4
FullNghs:  1.84566e+07 ave 1.86475e+07 max 1.80925e+07 min
Histogram: 2 0 0 0 0 0 0 0 0 4

Total # of neighbors = 1.1073948e+08
Ave neighs/atom = 166.99765
Neighbor list builds = 0
Dangerous builds = 0

region AreaLaser01 delete
group AreaLaser01 delete

next vloopLaser
jump SELF labelLaserPulse
print "Laser loop: ${vloopLaser}"
Laser loop: 2

variable temp01 equal 0.00 #((step/${nrun})%2)*${Height}
variable temp02 equal ${DistanceLaserShot}*(${vloopLaser}-1)+${Height}/2
variable temp02 equal 50*(${vloopLaser}-1)+${Height}/2
variable temp02 equal 50*(2-1)+${Height}/2
variable temp02 equal 50*(2-1)+50/2
variable cx equal ${temp01}+${temp02} #((step/${nrun})%2)*10 + 100*${vloopLaser} - 50
variable cx equal 0+${temp02} 
variable cx equal 0+75 
variable cy equal ${y3}
variable cy equal 350
variable cz equal (${z2}+${z3})/2
variable cz equal (0+${z3})/2
variable cz equal (0+3)/2
region AreaLaser01 ellipsoid ${cx} ${cy} ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 75 ${cy} ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 75 350 ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 75 350 1.5 ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 75 350 1.5 25 ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 75 350 1.5 25 100 ${ellipse_c}
region AreaLaser01 ellipsoid 75 350 1.5 25 100 25
group AreaLaser01 region AreaLaser01
26505 atoms in group AreaLaser01
#delete_atoms group AreaLaser01
displace_atoms AreaLaser01 random 0.05 0.1 0.05 123456
Displacing atoms ...
run ${nrun}
run 4
Per MPI rank memory allocation (min/avg/max) = 289.9 | 308.1 | 343.8 Mbytes
   Step          Temp          PotEng         KinEng        v_Temp02   
        68   1560.372      -2787632.4      133747.07      711.23096    
        69   1590.688      -2790441        136345.6       893.37937    
        70   1627.5744     -2793821.3      139507.31      1104.8553    
        71   1658.5971     -2796676        142166.41      1280.0705    
        72   1675.7512     -2798302.3      143636.77      1379.4252    
Loop time of 10.5413 on 6 procs for 4 steps with 663120 atoms

Performance: 0.164 ns/day, 146.407 hours/ns, 0.379 timesteps/s
95.0% CPU use with 6 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2.5555     | 2.6209     | 2.6477     |   1.9 | 24.86
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.063258   | 0.088572   | 0.15215    |   9.8 |  0.84
Output  | 7.7294     | 7.7295     | 7.7295     |   0.0 | 73.33
Modify  | 0.093104   | 0.095419   | 0.099029   |   0.7 |  0.91
Other   |            | 0.006834   |            |       |  0.06

Nlocal:         110520 ave      110577 max      110459 min
Histogram: 2 0 0 0 0 0 1 2 0 1
Nghost:         182913 ave      187139 max      177649 min
Histogram: 2 0 0 0 0 0 0 3 0 1
Neighs:    9.21853e+06 ave  9.3307e+06 max 9.00536e+06 min
Histogram: 2 0 0 0 0 0 0 0 0 4
FullNghs:  1.84249e+07 ave 1.86295e+07 max 1.80281e+07 min
Histogram: 2 0 0 0 0 0 0 0 0 4

Total # of neighbors = 1.1054952e+08
Ave neighs/atom = 166.71118
Neighbor list builds = 0
Dangerous builds = 0

region AreaLaser01 delete
group AreaLaser01 delete

next vloopLaser
jump SELF labelLaserPulse
print "Laser loop: ${vloopLaser}"
Laser loop: 3

variable temp01 equal 0.00 #((step/${nrun})%2)*${Height}
variable temp02 equal ${DistanceLaserShot}*(${vloopLaser}-1)+${Height}/2
variable temp02 equal 50*(${vloopLaser}-1)+${Height}/2
variable temp02 equal 50*(3-1)+${Height}/2
variable temp02 equal 50*(3-1)+50/2
variable cx equal ${temp01}+${temp02} #((step/${nrun})%2)*10 + 100*${vloopLaser} - 50
variable cx equal 0+${temp02} 
variable cx equal 0+125 
variable cy equal ${y3}
variable cy equal 350
variable cz equal (${z2}+${z3})/2
variable cz equal (0+${z3})/2
variable cz equal (0+3)/2
region AreaLaser01 ellipsoid ${cx} ${cy} ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 125 ${cy} ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 125 350 ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 125 350 1.5 ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 125 350 1.5 25 ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 125 350 1.5 25 100 ${ellipse_c}
region AreaLaser01 ellipsoid 125 350 1.5 25 100 25
group AreaLaser01 region AreaLaser01
28849 atoms in group AreaLaser01
#delete_atoms group AreaLaser01
displace_atoms AreaLaser01 random 0.05 0.1 0.05 123456
Displacing atoms ...
run ${nrun}
run 4
Per MPI rank memory allocation (min/avg/max) = 289.9 | 308.1 | 343.8 Mbytes
   Step          Temp          PotEng         KinEng        v_Temp02   
        72   1675.7512     -2788809.6      143636.77      1379.4252    
        73   1686.6354     -2789893.7      144569.71      1425.3083    
        74   1699.8423     -2791192.2      145701.74      1456.1799    
        75   1712.4572     -2792434.8      146783.03      1481.8745    
        76   1721.3239     -2793333.1      147543.03      1508.6036    
Loop time of 13.307 on 6 procs for 4 steps with 663120 atoms

Performance: 0.130 ns/day, 184.819 hours/ns, 0.301 timesteps/s
91.3% CPU use with 6 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 3.7138     | 3.81       | 3.8798     |   2.6 | 28.63
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.058343   | 0.12853    | 0.21918    |  13.3 |  0.97
Output  | 9.1675     | 9.1681     | 9.1694     |   0.0 | 68.90
Modify  | 0.17288    | 0.19123    | 0.19868    |   2.0 |  1.44
Other   |            | 0.009205   |            |       |  0.07

Nlocal:         110520 ave      110587 max      110419 min
Histogram: 1 1 0 0 0 0 0 2 0 2
Nghost:         182898 ave      187168 max      177611 min
Histogram: 2 0 0 0 0 0 0 3 0 1
Neighs:    9.20509e+06 ave 9.32249e+06 max 8.98031e+06 min
Histogram: 2 0 0 0 0 0 0 0 0 4
FullNghs:   1.8398e+07 ave 1.86156e+07 max 1.79758e+07 min
Histogram: 2 0 0 0 0 0 0 0 0 4

Total # of neighbors = 1.1038821e+08
Ave neighs/atom = 166.46792
Neighbor list builds = 0
Dangerous builds = 0

region AreaLaser01 delete
group AreaLaser01 delete

next vloopLaser
jump SELF labelLaserPulse
print "Laser loop: ${vloopLaser}"
Laser loop: 4

variable temp01 equal 0.00 #((step/${nrun})%2)*${Height}
variable temp02 equal ${DistanceLaserShot}*(${vloopLaser}-1)+${Height}/2
variable temp02 equal 50*(${vloopLaser}-1)+${Height}/2
variable temp02 equal 50*(4-1)+${Height}/2
variable temp02 equal 50*(4-1)+50/2
variable cx equal ${temp01}+${temp02} #((step/${nrun})%2)*10 + 100*${vloopLaser} - 50
variable cx equal 0+${temp02} 
variable cx equal 0+175 
variable cy equal ${y3}
variable cy equal 350
variable cz equal (${z2}+${z3})/2
variable cz equal (0+${z3})/2
variable cz equal (0+3)/2
region AreaLaser01 ellipsoid ${cx} ${cy} ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 175 ${cy} ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 175 350 ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 175 350 1.5 ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 175 350 1.5 25 ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 175 350 1.5 25 100 ${ellipse_c}
region AreaLaser01 ellipsoid 175 350 1.5 25 100 25
group AreaLaser01 region AreaLaser01
34902 atoms in group AreaLaser01
#delete_atoms group AreaLaser01
displace_atoms AreaLaser01 random 0.05 0.1 0.05 123456
Displacing atoms ...
run ${nrun}
run 4
Per MPI rank memory allocation (min/avg/max) = 289.9 | 308.1 | 343.8 Mbytes
   Step          Temp          PotEng         KinEng        v_Temp02   
        76   1721.3239     -2781857.4      147543.03      1508.6036    
        77   1735.6906     -2783237.7      148774.47      1583.8712    
        78   1762.6214     -2785722.4      151082.84      1735.2024    
        79   1792.9524     -2788494.9      153682.66      1914.2298    
        80   1817.0572     -2790703        155748.8       2068.2912    
Loop time of 12.0847 on 6 procs for 4 steps with 663120 atoms

Performance: 0.143 ns/day, 167.843 hours/ns, 0.331 timesteps/s
93.9% CPU use with 6 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2.9061     | 2.9595     | 3.0057     |   2.2 | 24.49
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.033915   | 0.079448   | 0.13038    |  12.9 |  0.66
Output  | 8.9356     | 8.9358     | 8.9359     |   0.0 | 73.94
Modify  | 0.10074    | 0.10281    | 0.10608    |   0.7 |  0.85
Other   |            | 0.007085   |            |       |  0.06

Nlocal:         110520 ave      110615 max      110379 min
Histogram: 1 1 0 0 0 0 0 1 1 2
Nghost:         182864 ave      187168 max      177567 min
Histogram: 2 0 0 0 0 0 0 3 0 1
Neighs:    9.19042e+06 ave 9.31337e+06 max 8.96119e+06 min
Histogram: 2 0 0 0 0 0 0 0 0 4
FullNghs:  1.83682e+07 ave 1.85975e+07 max  1.7936e+07 min
Histogram: 2 0 0 0 0 0 0 0 0 4

Total # of neighbors = 1.1020936e+08
Ave neighs/atom = 166.19821
Neighbor list builds = 0
Dangerous builds = 0

region AreaLaser01 delete
group AreaLaser01 delete

next vloopLaser
jump SELF labelLaserPulse
print "Laser loop: ${vloopLaser}"
Laser loop: 5

variable temp01 equal 0.00 #((step/${nrun})%2)*${Height}
variable temp02 equal ${DistanceLaserShot}*(${vloopLaser}-1)+${Height}/2
variable temp02 equal 50*(${vloopLaser}-1)+${Height}/2
variable temp02 equal 50*(5-1)+${Height}/2
variable temp02 equal 50*(5-1)+50/2
variable cx equal ${temp01}+${temp02} #((step/${nrun})%2)*10 + 100*${vloopLaser} - 50
variable cx equal 0+${temp02} 
variable cx equal 0+225 
variable cy equal ${y3}
variable cy equal 350
variable cz equal (${z2}+${z3})/2
variable cz equal (0+${z3})/2
variable cz equal (0+3)/2
region AreaLaser01 ellipsoid ${cx} ${cy} ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 225 ${cy} ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 225 350 ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 225 350 1.5 ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 225 350 1.5 25 ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 225 350 1.5 25 100 ${ellipse_c}
region AreaLaser01 ellipsoid 225 350 1.5 25 100 25
group AreaLaser01 region AreaLaser01
17061 atoms in group AreaLaser01
#delete_atoms group AreaLaser01
displace_atoms AreaLaser01 random 0.05 0.1 0.05 123456
Displacing atoms ...
run ${nrun}
run 4
Per MPI rank memory allocation (min/avg/max) = 289.9 | 308.1 | 343.8 Mbytes
   Step          Temp          PotEng         KinEng        v_Temp02   
        80   1817.0572     -2785193        155748.8       2068.2912    
        81   1834.1796     -2786784.9      157216.44      2182.8066    
        82   1845.9748     -2787912.1      158227.47      2258.7565    
        83   1849.7588     -2788332.6      158551.81      2286.1263    
        84   1844.7522     -2787969.8      158122.68      2267.5846    
Loop time of 14.0556 on 6 procs for 4 steps with 663120 atoms

Performance: 0.123 ns/day, 195.216 hours/ns, 0.285 timesteps/s
86.9% CPU use with 6 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 3.6706     | 3.7875     | 3.8278     |   2.8 | 26.95
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.084382   | 0.12448    | 0.23852    |  15.0 |  0.89
Output  | 10.019     | 10.019     | 10.019     |   0.0 | 71.28
Modify  | 0.11418    | 0.11708    | 0.12154    |   0.9 |  0.83
Other   |            | 0.007424   |            |       |  0.05

Nlocal:         110520 ave      110624 max      110337 min
Histogram: 1 0 1 0 0 0 0 1 1 2
Nghost:         182825 ave      187172 max      177481 min
Histogram: 2 0 0 0 0 0 0 3 0 1
Neighs:    9.17651e+06 ave 9.30233e+06 max 8.93736e+06 min
Histogram: 2 0 0 0 0 0 0 0 0 4
FullNghs:  1.83398e+07 ave  1.8576e+07 max 1.78788e+07 min
Histogram: 2 0 0 0 0 0 0 0 0 4

Total # of neighbors = 1.1003905e+08
Ave neighs/atom = 165.94138
Neighbor list builds = 0
Dangerous builds = 0

region AreaLaser01 delete
group AreaLaser01 delete

next vloopLaser
jump SELF labelLaserPulse
print "Laser loop: ${vloopLaser}"
Laser loop: 6

variable temp01 equal 0.00 #((step/${nrun})%2)*${Height}
variable temp02 equal ${DistanceLaserShot}*(${vloopLaser}-1)+${Height}/2
variable temp02 equal 50*(${vloopLaser}-1)+${Height}/2
variable temp02 equal 50*(6-1)+${Height}/2
variable temp02 equal 50*(6-1)+50/2
variable cx equal ${temp01}+${temp02} #((step/${nrun})%2)*10 + 100*${vloopLaser} - 50
variable cx equal 0+${temp02} 
variable cx equal 0+275 
variable cy equal ${y3}
variable cy equal 350
variable cz equal (${z2}+${z3})/2
variable cz equal (0+${z3})/2
variable cz equal (0+3)/2
region AreaLaser01 ellipsoid ${cx} ${cy} ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 275 ${cy} ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 275 350 ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 275 350 1.5 ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 275 350 1.5 25 ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 275 350 1.5 25 100 ${ellipse_c}
region AreaLaser01 ellipsoid 275 350 1.5 25 100 25
group AreaLaser01 region AreaLaser01
28450 atoms in group AreaLaser01
#delete_atoms group AreaLaser01
displace_atoms AreaLaser01 random 0.05 0.1 0.05 123456
Displacing atoms ...
run ${nrun}
run 4
Per MPI rank memory allocation (min/avg/max) = 289.9 | 308.1 | 343.8 Mbytes
   Step          Temp          PotEng         KinEng        v_Temp02   
        84   1844.7522     -2778923.4      158122.68      2267.5846    
        85   1841.1018     -2778675        157809.78      2247.6268    
        86   1847.4068     -2779295.5      158350.21      2268.7084    
        87   1859.5476     -2780413.9      159390.86      2323.7272    
        88   1871.8818     -2781529        160448.08      2394.7539    
Loop time of 14.3813 on 6 procs for 4 steps with 663120 atoms

Performance: 0.120 ns/day, 199.741 hours/ns, 0.278 timesteps/s
88.3% CPU use with 6 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 3.6046     | 3.6663     | 3.6962     |   2.1 | 25.49
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.07433    | 0.10558    | 0.16798    |  12.0 |  0.73
Output  | 10.482     | 10.482     | 10.482     |   0.0 | 72.88
Modify  | 0.11675    | 0.11996    | 0.12302    |   0.7 |  0.83
Other   |            | 0.007703   |            |       |  0.05

Nlocal:         110520 ave      110640 max      110316 min
Histogram: 1 0 1 0 0 0 0 2 0 2
Nghost:         182816 ave      187187 max      177407 min
Histogram: 2 0 0 0 0 0 0 3 0 1
Neighs:    9.16064e+06 ave 9.29262e+06 max  8.9103e+06 min
Histogram: 2 0 0 0 0 0 0 0 0 4
FullNghs:  1.83069e+07 ave 1.85576e+07 max 1.78254e+07 min
Histogram: 2 0 0 0 0 0 0 0 0 4

Total # of neighbors = 1.0984124e+08
Ave neighs/atom = 165.64308
Neighbor list builds = 0
Dangerous builds = 0

region AreaLaser01 delete
group AreaLaser01 delete

next vloopLaser
jump SELF labelLaserPulse

print "*** Idle run begins***"
*** Idle run begins***
run ${nrunIdle}
run 0
Per MPI rank memory allocation (min/avg/max) = 289.9 | 308.1 | 343.8 Mbytes
   Step          Temp          PotEng         KinEng        v_Temp02   
        88   1871.8818     -2781529        160448.08      2394.7539    
Loop time of 1.26833e-05 on 6 procs for 0 steps with 663120 atoms

0.0% CPU use with 6 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0          | 0          | 0          |   0.0 |  0.00
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 1.268e-05  |            |       |100.00

Nlocal:         110520 ave      110665 max      110258 min
Histogram: 1 0 1 0 0 0 0 0 2 2
Nghost:         182771 ave      187178 max      177360 min
Histogram: 2 0 0 0 0 0 0 3 0 1
Neighs:    9.14648e+06 ave 9.28393e+06 max 8.88104e+06 min
Histogram: 2 0 0 0 0 0 0 0 0 4
FullNghs:  1.83069e+07 ave 1.85576e+07 max 1.78254e+07 min
Histogram: 2 0 0 0 0 0 0 0 0 4

Total # of neighbors = 1.0984124e+08
Ave neighs/atom = 165.64308
Neighbor list builds = 0
Dangerous builds = 0

print "******LAMMPS loop finished******"
******LAMMPS loop finished******


jump script_LAMMPS_Basic.inp labelAMLoop
print "loop: ${loop01}"
loop: 4
next loop01
jump script_LAMMPS_AM.inp
### command to run recurssively for AM simulation
### Delete previous fix, region, group etc. before redefining

### delete the bottom atom righ at the begining and reassign before the next run for T-control
delete_atoms region BlockDeleteAtomsBottom_01
Deleted 180767 atoms, new total = 482353

unfix 1
unfix fPushParticles
unfix fLangevin
region BlockInside delete
group GroupInside delete
region BlockDeleteAtomsBottom_01 delete
group GroupDeleteAtomsBottom_01 delete
region BlockCreateAtomsTop_01 delete
group GroupCreateAtomsTop_01 delete

variable delta_y equal (step/${nrun})*${Height}
variable delta_y equal (step/4)*${Height}
variable delta_y equal (step/4)*50
if "${nAtomsAll} > ${nAtomsInitial}" then "variable y1 equal ${y1}+${Height}" # This will make sure that total number of atom is close to initial atoms
variable y2 equal ${y2}+${Height}
variable y2 equal 300+${Height}
variable y2 equal 300+50
variable y3 equal ${y3}+${Height}
variable y3 equal 350+${Height}
variable y3 equal 350+50
variable y_Inside equal ${y1}+2
variable y_Inside equal 150+2

### update other regions
region		BlockDeleteAtomsBottom_01 block INF INF INF ${y1} INF INF # delete all atom down the interface
region		BlockDeleteAtomsBottom_01 block INF INF INF 150 INF INF 
region		BlockCreateAtomsTop_01 block INF INF ${y2} ${y3} INF INF
region		BlockCreateAtomsTop_01 block INF INF 350 ${y3} INF INF
region		BlockCreateAtomsTop_01 block INF INF 350 400 INF INF
region		BlockInside block INF INF ${y_Inside} INF INF INF
region		BlockInside block INF INF 152 INF INF INF

###----create atoms i.e, spherical powder particles in a loop-----
print "*** Powder particle creation begins***"
*** Powder particle creation begins***
variable nParticles equal floor(${lx}/(${Height})) # square box shaped
variable nParticles equal floor(301/(${Height})) 
variable nParticles equal floor(301/(50)) 
variable radiusIdeal equal ${Height}/2
variable radiusIdeal equal 50/2
variable vloopParticle loop ${nParticles}
variable vloopParticle loop 6
label labelParticleCreation
print "Grain creation loop: ${vloopParticle}"
Grain creation loop: 1
variable perturb01 equal v_random01
if "(${vloopParticle} == 0) || (${vloopParticle} == ${nParticles})" then "variable perturb01 equal 0.00"

variable radius equal (0.75+0.25*${perturb01})*${radiusIdeal}
variable radius equal (0.75+0.25*0.270549535751343)*${radiusIdeal}
variable radius equal (0.75+0.25*0.270549535751343)*25
variable temp01 equal ${perturb01}*${radiusIdeal}  #((step/${nrun})%2)*${radius}
variable temp01 equal 0.0845592617988586*${radiusIdeal}  
variable temp01 equal 0.0845592617988586*25  
variable temp02 equal 2*${radiusIdeal}*(${vloopParticle}-1)+${radiusIdeal}
variable temp02 equal 2*25*(${vloopParticle}-1)+${radiusIdeal}
variable temp02 equal 2*25*(1-1)+${radiusIdeal}
variable temp02 equal 2*25*(1-1)+25
variable cx equal ${temp01}+${temp02} #((step/${nrun})%2)*10 + 100*${vloopParticle} - 50
variable cx equal 2.11398154497147+${temp02} 
variable cx equal 2.11398154497147+25 
variable cy equal (${y2}+${y3})/2
variable cy equal (350+${y3})/2
variable cy equal (350+400)/2
variable cz equal (${z2}+${z3})/2
variable cz equal (0+${z3})/2
variable cz equal (0+3)/2
print "Grain parameters cx: ${cx} cy: ${cy} cz: ${cz} radius: ${radius}"
Grain parameters cx: 27.1139815449715 cy: 375 cz: 1.5 radius: 20.4409345984459
region Particle sphere ${cx} ${cy} ${cz} ${radius}
region Particle sphere 27.1139815449715 ${cy} ${cz} ${radius}
region Particle sphere 27.1139815449715 375 ${cz} ${radius}
region Particle sphere 27.1139815449715 375 1.5 ${radius}
region Particle sphere 27.1139815449715 375 1.5 20.4409345984459

create_atoms 1 region Particle
Created 18309 atoms
  using lattice units in orthogonal box = (-2.9981523 176 -0.029959315) to (1062.5182 1763.52 10.589959)
  create_atoms CPU = 0.021 seconds
group Particle region Particle
18309 atoms in group Particle

variable theta_z equal ${random01}*90  # angle to rotate the grain
variable theta_z equal 0.0938999056816101*90  
displace_atoms Particle rotate ${cx} ${cy} ${cz} 0 0 1 ${theta_z} # rotate wrt z-axis
displace_atoms Particle rotate 27.1139815449715 ${cy} ${cz} 0 0 1 ${theta_z} 
displace_atoms Particle rotate 27.1139815449715 375 ${cz} 0 0 1 ${theta_z} 
displace_atoms Particle rotate 27.1139815449715 375 1.5 0 0 1 ${theta_z} 
displace_atoms Particle rotate 27.1139815449715 375 1.5 0 0 1 8.45099151134491 
Displacing atoms ...

group GroupCreateAtomsTop_01 union GroupCreateAtomsTop_01 Particle
18309 atoms in group GroupCreateAtomsTop_01
region Particle delete
group Particle delete

next vloopParticle
jump SELF labelParticleCreation
print "Grain creation loop: ${vloopParticle}"
Grain creation loop: 2
variable perturb01 equal v_random01
if "(${vloopParticle} == 0) || (${vloopParticle} == ${nParticles})" then "variable perturb01 equal 0.00"

variable radius equal (0.75+0.25*${perturb01})*${radiusIdeal}
variable radius equal (0.75+0.25*0.647114932537079)*${radiusIdeal}
variable radius equal (0.75+0.25*0.647114932537079)*25
variable temp01 equal ${perturb01}*${radiusIdeal}  #((step/${nrun})%2)*${radius}
variable temp01 equal 0.368148803710938*${radiusIdeal}  
variable temp01 equal 0.368148803710938*25  
variable temp02 equal 2*${radiusIdeal}*(${vloopParticle}-1)+${radiusIdeal}
variable temp02 equal 2*25*(${vloopParticle}-1)+${radiusIdeal}
variable temp02 equal 2*25*(2-1)+${radiusIdeal}
variable temp02 equal 2*25*(2-1)+25
variable cx equal ${temp01}+${temp02} #((step/${nrun})%2)*10 + 100*${vloopParticle} - 50
variable cx equal 9.20372009277345+${temp02} 
variable cx equal 9.20372009277345+75 
variable cy equal (${y2}+${y3})/2
variable cy equal (350+${y3})/2
variable cy equal (350+400)/2
variable cz equal (${z2}+${z3})/2
variable cz equal (0+${z3})/2
variable cz equal (0+3)/2
print "Grain parameters cx: ${cx} cy: ${cy} cz: ${cz} radius: ${radius}"
Grain parameters cx: 84.2037200927735 cy: 375 cz: 1.5 radius: 22.7944683283567
region Particle sphere ${cx} ${cy} ${cz} ${radius}
region Particle sphere 84.2037200927735 ${cy} ${cz} ${radius}
region Particle sphere 84.2037200927735 375 ${cz} ${radius}
region Particle sphere 84.2037200927735 375 1.5 ${radius}
region Particle sphere 84.2037200927735 375 1.5 22.7944683283567

create_atoms 1 region Particle
Created 22802 atoms
  using lattice units in orthogonal box = (-2.9981523 176 -0.029959315) to (1062.5182 1763.52 10.589959)
  create_atoms CPU = 0.030 seconds
group Particle region Particle
22802 atoms in group Particle

variable theta_z equal ${random01}*90  # angle to rotate the grain
variable theta_z equal 0.630071818828583*90  
displace_atoms Particle rotate ${cx} ${cy} ${cz} 0 0 1 ${theta_z} # rotate wrt z-axis
displace_atoms Particle rotate 84.2037200927735 ${cy} ${cz} 0 0 1 ${theta_z} 
displace_atoms Particle rotate 84.2037200927735 375 ${cz} 0 0 1 ${theta_z} 
displace_atoms Particle rotate 84.2037200927735 375 1.5 0 0 1 ${theta_z} 
displace_atoms Particle rotate 84.2037200927735 375 1.5 0 0 1 56.7064636945725 
Displacing atoms ...

group GroupCreateAtomsTop_01 union GroupCreateAtomsTop_01 Particle
41111 atoms in group GroupCreateAtomsTop_01
region Particle delete
group Particle delete

next vloopParticle
jump SELF labelParticleCreation
print "Grain creation loop: ${vloopParticle}"
Grain creation loop: 3
variable perturb01 equal v_random01
if "(${vloopParticle} == 0) || (${vloopParticle} == ${nParticles})" then "variable perturb01 equal 0.00"

variable radius equal (0.75+0.25*${perturb01})*${radiusIdeal}
variable radius equal (0.75+0.25*0.648374080657959)*${radiusIdeal}
variable radius equal (0.75+0.25*0.648374080657959)*25
variable temp01 equal ${perturb01}*${radiusIdeal}  #((step/${nrun})%2)*${radius}
variable temp01 equal 0.664631485939026*${radiusIdeal}  
variable temp01 equal 0.664631485939026*25  
variable temp02 equal 2*${radiusIdeal}*(${vloopParticle}-1)+${radiusIdeal}
variable temp02 equal 2*25*(${vloopParticle}-1)+${radiusIdeal}
variable temp02 equal 2*25*(3-1)+${radiusIdeal}
variable temp02 equal 2*25*(3-1)+25
variable cx equal ${temp01}+${temp02} #((step/${nrun})%2)*10 + 100*${vloopParticle} - 50
variable cx equal 16.6157871484757+${temp02} 
variable cx equal 16.6157871484757+125 
variable cy equal (${y2}+${y3})/2
variable cy equal (350+${y3})/2
variable cy equal (350+400)/2
variable cz equal (${z2}+${z3})/2
variable cz equal (0+${z3})/2
variable cz equal (0+3)/2
print "Grain parameters cx: ${cx} cy: ${cy} cz: ${cz} radius: ${radius}"
Grain parameters cx: 141.615787148476 cy: 375 cz: 1.5 radius: 22.8023380041122
region Particle sphere ${cx} ${cy} ${cz} ${radius}
region Particle sphere 141.615787148476 ${cy} ${cz} ${radius}
region Particle sphere 141.615787148476 375 ${cz} ${radius}
region Particle sphere 141.615787148476 375 1.5 ${radius}
region Particle sphere 141.615787148476 375 1.5 22.8023380041122

create_atoms 1 region Particle
Created 22835 atoms
  using lattice units in orthogonal box = (-2.9981523 176 -0.029959315) to (1062.5182 1763.52 10.589959)
  create_atoms CPU = 0.099 seconds
group Particle region Particle
22835 atoms in group Particle

variable theta_z equal ${random01}*90  # angle to rotate the grain
variable theta_z equal 0.368454277515411*90  
displace_atoms Particle rotate ${cx} ${cy} ${cz} 0 0 1 ${theta_z} # rotate wrt z-axis
displace_atoms Particle rotate 141.615787148476 ${cy} ${cz} 0 0 1 ${theta_z} 
displace_atoms Particle rotate 141.615787148476 375 ${cz} 0 0 1 ${theta_z} 
displace_atoms Particle rotate 141.615787148476 375 1.5 0 0 1 ${theta_z} 
displace_atoms Particle rotate 141.615787148476 375 1.5 0 0 1 33.160884976387 
Displacing atoms ...

group GroupCreateAtomsTop_01 union GroupCreateAtomsTop_01 Particle
63946 atoms in group GroupCreateAtomsTop_01
region Particle delete
group Particle delete

next vloopParticle
jump SELF labelParticleCreation
print "Grain creation loop: ${vloopParticle}"
Grain creation loop: 4
variable perturb01 equal v_random01
if "(${vloopParticle} == 0) || (${vloopParticle} == ${nParticles})" then "variable perturb01 equal 0.00"

variable radius equal (0.75+0.25*${perturb01})*${radiusIdeal}
variable radius equal (0.75+0.25*0.276816070079803)*${radiusIdeal}
variable radius equal (0.75+0.25*0.276816070079803)*25
variable temp01 equal ${perturb01}*${radiusIdeal}  #((step/${nrun})%2)*${radius}
variable temp01 equal 0.632176995277405*${radiusIdeal}  
variable temp01 equal 0.632176995277405*25  
variable temp02 equal 2*${radiusIdeal}*(${vloopParticle}-1)+${radiusIdeal}
variable temp02 equal 2*25*(${vloopParticle}-1)+${radiusIdeal}
variable temp02 equal 2*25*(4-1)+${radiusIdeal}
variable temp02 equal 2*25*(4-1)+25
variable cx equal ${temp01}+${temp02} #((step/${nrun})%2)*10 + 100*${vloopParticle} - 50
variable cx equal 15.8044248819351+${temp02} 
variable cx equal 15.8044248819351+175 
variable cy equal (${y2}+${y3})/2
variable cy equal (350+${y3})/2
variable cy equal (350+400)/2
variable cz equal (${z2}+${z3})/2
variable cz equal (0+${z3})/2
variable cz equal (0+3)/2
print "Grain parameters cx: ${cx} cy: ${cy} cz: ${cz} radius: ${radius}"
Grain parameters cx: 190.804424881935 cy: 375 cz: 1.5 radius: 20.4801004379988
region Particle sphere ${cx} ${cy} ${cz} ${radius}
region Particle sphere 190.804424881935 ${cy} ${cz} ${radius}
region Particle sphere 190.804424881935 375 ${cz} ${radius}
region Particle sphere 190.804424881935 375 1.5 ${radius}
region Particle sphere 190.804424881935 375 1.5 20.4801004379988

create_atoms 1 region Particle
Created 18391 atoms
  using lattice units in orthogonal box = (-2.9981523 176 -0.029959315) to (1062.5182 1763.52 10.589959)
  create_atoms CPU = 0.040 seconds
group Particle region Particle
18391 atoms in group Particle

variable theta_z equal ${random01}*90  # angle to rotate the grain
variable theta_z equal 0.429328143596649*90  
displace_atoms Particle rotate ${cx} ${cy} ${cz} 0 0 1 ${theta_z} # rotate wrt z-axis
displace_atoms Particle rotate 190.804424881935 ${cy} ${cz} 0 0 1 ${theta_z} 
displace_atoms Particle rotate 190.804424881935 375 ${cz} 0 0 1 ${theta_z} 
displace_atoms Particle rotate 190.804424881935 375 1.5 0 0 1 ${theta_z} 
displace_atoms Particle rotate 190.804424881935 375 1.5 0 0 1 38.6395329236984 
Displacing atoms ...

group GroupCreateAtomsTop_01 union GroupCreateAtomsTop_01 Particle
82337 atoms in group GroupCreateAtomsTop_01
region Particle delete
group Particle delete

next vloopParticle
jump SELF labelParticleCreation
print "Grain creation loop: ${vloopParticle}"
Grain creation loop: 5
variable perturb01 equal v_random01
if "(${vloopParticle} == 0) || (${vloopParticle} == ${nParticles})" then "variable perturb01 equal 0.00"

variable radius equal (0.75+0.25*${perturb01})*${radiusIdeal}
variable radius equal (0.75+0.25*0.607195496559143)*${radiusIdeal}
variable radius equal (0.75+0.25*0.607195496559143)*25
variable temp01 equal ${perturb01}*${radiusIdeal}  #((step/${nrun})%2)*${radius}
variable temp01 equal 0.0492294430732727*${radiusIdeal}  
variable temp01 equal 0.0492294430732727*25  
variable temp02 equal 2*${radiusIdeal}*(${vloopParticle}-1)+${radiusIdeal}
variable temp02 equal 2*25*(${vloopParticle}-1)+${radiusIdeal}
variable temp02 equal 2*25*(5-1)+${radiusIdeal}
variable temp02 equal 2*25*(5-1)+25
variable cx equal ${temp01}+${temp02} #((step/${nrun})%2)*10 + 100*${vloopParticle} - 50
variable cx equal 1.23073607683182+${temp02} 
variable cx equal 1.23073607683182+225 
variable cy equal (${y2}+${y3})/2
variable cy equal (350+${y3})/2
variable cy equal (350+400)/2
variable cz equal (${z2}+${z3})/2
variable cz equal (0+${z3})/2
variable cz equal (0+3)/2
print "Grain parameters cx: ${cx} cy: ${cy} cz: ${cz} radius: ${radius}"
Grain parameters cx: 226.230736076832 cy: 375 cz: 1.5 radius: 22.5449718534946
region Particle sphere ${cx} ${cy} ${cz} ${radius}
region Particle sphere 226.230736076832 ${cy} ${cz} ${radius}
region Particle sphere 226.230736076832 375 ${cz} ${radius}
region Particle sphere 226.230736076832 375 1.5 ${radius}
region Particle sphere 226.230736076832 375 1.5 22.5449718534946

create_atoms 1 region Particle
Created 22317 atoms
  using lattice units in orthogonal box = (-2.9981523 176 -0.029959315) to (1062.5182 1763.52 10.589959)
  create_atoms CPU = 0.035 seconds
group Particle region Particle
24072 atoms in group Particle

variable theta_z equal ${random01}*90  # angle to rotate the grain
variable theta_z equal 0.266732037067413*90  
displace_atoms Particle rotate ${cx} ${cy} ${cz} 0 0 1 ${theta_z} # rotate wrt z-axis
displace_atoms Particle rotate 226.230736076832 ${cy} ${cz} 0 0 1 ${theta_z} 
displace_atoms Particle rotate 226.230736076832 375 ${cz} 0 0 1 ${theta_z} 
displace_atoms Particle rotate 226.230736076832 375 1.5 0 0 1 ${theta_z} 
displace_atoms Particle rotate 226.230736076832 375 1.5 0 0 1 24.0058833360672 
Displacing atoms ...

group GroupCreateAtomsTop_01 union GroupCreateAtomsTop_01 Particle
104654 atoms in group GroupCreateAtomsTop_01
region Particle delete
group Particle delete

next vloopParticle
jump SELF labelParticleCreation
print "Grain creation loop: ${vloopParticle}"
Grain creation loop: 6
variable perturb01 equal v_random01
if "(${vloopParticle} == 0) || (${vloopParticle} == ${nParticles})" then "variable perturb01 equal 0.00"
variable perturb01 equal 0.00

variable radius equal (0.75+0.25*${perturb01})*${radiusIdeal}
variable radius equal (0.75+0.25*0)*${radiusIdeal}
variable radius equal (0.75+0.25*0)*25
variable temp01 equal ${perturb01}*${radiusIdeal}  #((step/${nrun})%2)*${radius}
variable temp01 equal 0*${radiusIdeal}  
variable temp01 equal 0*25  
variable temp02 equal 2*${radiusIdeal}*(${vloopParticle}-1)+${radiusIdeal}
variable temp02 equal 2*25*(${vloopParticle}-1)+${radiusIdeal}
variable temp02 equal 2*25*(6-1)+${radiusIdeal}
variable temp02 equal 2*25*(6-1)+25
variable cx equal ${temp01}+${temp02} #((step/${nrun})%2)*10 + 100*${vloopParticle} - 50
variable cx equal 0+${temp02} 
variable cx equal 0+275 
variable cy equal (${y2}+${y3})/2
variable cy equal (350+${y3})/2
variable cy equal (350+400)/2
variable cz equal (${z2}+${z3})/2
variable cz equal (0+${z3})/2
variable cz equal (0+3)/2
print "Grain parameters cx: ${cx} cy: ${cy} cz: ${cz} radius: ${radius}"
Grain parameters cx: 275 cy: 375 cz: 1.5 radius: 18.75
region Particle sphere ${cx} ${cy} ${cz} ${radius}
region Particle sphere 275 ${cy} ${cz} ${radius}
region Particle sphere 275 375 ${cz} ${radius}
region Particle sphere 275 375 1.5 ${radius}
region Particle sphere 275 375 1.5 18.75

create_atoms 1 region Particle
Created 15432 atoms
  using lattice units in orthogonal box = (-2.9981523 176 -0.029959315) to (1062.5182 1763.52 10.589959)
  create_atoms CPU = 0.043 seconds
group Particle region Particle
15432 atoms in group Particle

variable theta_z equal ${random01}*90  # angle to rotate the grain
variable theta_z equal 0.100761890411377*90  
displace_atoms Particle rotate ${cx} ${cy} ${cz} 0 0 1 ${theta_z} # rotate wrt z-axis
displace_atoms Particle rotate 275 ${cy} ${cz} 0 0 1 ${theta_z} 
displace_atoms Particle rotate 275 375 ${cz} 0 0 1 ${theta_z} 
displace_atoms Particle rotate 275 375 1.5 0 0 1 ${theta_z} 
displace_atoms Particle rotate 275 375 1.5 0 0 1 9.06857013702393 
Displacing atoms ...

group GroupCreateAtomsTop_01 union GroupCreateAtomsTop_01 Particle
120086 atoms in group GroupCreateAtomsTop_01
region Particle delete
group Particle delete

next vloopParticle
jump SELF labelParticleCreation

### Assign velocity/Temperature to the newly created atoms
#group GroupCreateAtomsTop_01 region BlockCreateAtomsTop_01
delete_atoms overlap 2.25 GroupCreateAtomsTop_01 all  # atoms from the first group will be deleted
System init for delete_atoms ...
Neighbor list info ...
  update: every = 1 steps, delay = 10 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 7.65
  ghost atom cutoff = 7.65
  binsize = 3.825, bins = 279 416 3
  4 neighbor lists, perpetual/occasional/extra = 1 3 0
  (1) command delete_atoms, occasional
      attributes: full, newton on
      pair build: full/bin/atomonly
      stencil: full/bin/3d
      bin: standard
  (2) pair eam/alloy, perpetual
      attributes: half, newton on
      pair build: half/bin/atomonly/newton
      stencil: half/bin/3d
      bin: standard
  (3) compute cna/atom, occasional
      attributes: full, newton on
      pair build: full/bin/atomonly
      stencil: full/bin/3d
      bin: standard
  (4) compute centro/atom, occasional
      attributes: full, newton on
      pair build: full/bin/atomonly
      stencil: full/bin/3d
      bin: standard
Deleted 18730 atoms, new total = 583709
velocity	GroupCreateAtomsTop_01 create ${T2} 187723 #temp Temperature # assign velocity of the newly created atoms
velocity	GroupCreateAtomsTop_01 create 1600 187723 

### Redefine the group, fix etc.
group GroupDeleteAtomsBottom_01 region BlockDeleteAtomsBottom_01
0 atoms in group GroupDeleteAtomsBottom_01
group GroupInside region BlockInside
576163 atoms in group GroupInside
#fix 1 GroupInside nve
fix  1 GroupInside npt temp $T $T 0.2 drag 0.5 x 0.0 0.0 5 z 0.0 0.0 5 couple none
fix  1 GroupInside npt temp 800 $T 0.2 drag 0.5 x 0.0 0.0 5 z 0.0 0.0 5 couple none
fix  1 GroupInside npt temp 800 800 0.2 drag 0.5 x 0.0 0.0 5 z 0.0 0.0 5 couple none
fix fPushParticles GroupCreateAtomsTop_01 addforce 0.0 -0.2 0.0 every 1
fix fLangevin GroupDeleteAtomsBottom_01 langevin ${T} ${T} 0.5 123456
fix fLangevin GroupDeleteAtomsBottom_01 langevin 800 ${T} 0.5 123456
fix fLangevin GroupDeleteAtomsBottom_01 langevin 800 800 0.5 123456

print "nAtomsAll: ${nAtomsAll}; nAtomsInitial: ${nAtomsInitial}; nAtomsNew: ${nAtomsNew}"
nAtomsAll: 583709; nAtomsInitial: 543606; nAtomsNew: 101356

balance 1.1 rcb  # load balancing
Balancing ...
Neighbor list info ...
  update: every = 1 steps, delay = 10 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 7.65
  ghost atom cutoff = 7.65
  binsize = 3.825, bins = 279 416 3
  3 neighbor lists, perpetual/occasional/extra = 1 2 0
  (1) pair eam/alloy, perpetual
      attributes: half, newton on
      pair build: half/bin/atomonly/newton
      stencil: half/bin/3d
      bin: standard
  (2) compute cna/atom, occasional
      attributes: full, newton on
      pair build: full/bin/atomonly
      stencil: full/bin/3d
      bin: standard
  (3) compute centro/atom, occasional
      attributes: full, newton on
      pair build: full/bin/atomonly
      stencil: full/bin/3d
      bin: standard
 rebalancing time: 0.098 seconds
  iteration count = 0
  initial/final maximal load/proc = 163487 97285
  initial/final imbalance factor  = 1.6804983 1.0000017

run ${nrun}
run 4
Per MPI rank memory allocation (min/avg/max) = 212 | 230.9 | 268.1 Mbytes
   Step          Temp          PotEng         KinEng        v_Temp02   
        88   2166.7529     -2441786.1      163481.9       1603.2108    
        89   2162.378      -2441607.8      163151.81      1535.583     
        90   2129.4708     -2439372.6      160668.96      1349.8263    
        91   2077.7509     -2435673.9      156766.68      1089.3185    
        92   2018.6876     -2431454.5      152310.34      813.31881    
Loop time of 10.0116 on 6 procs for 4 steps with 583709 atoms

Performance: 0.173 ns/day, 139.050 hours/ns, 0.400 timesteps/s
94.3% CPU use with 6 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2.4983     | 2.5305     | 2.5778     |   2.1 | 25.28
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.047229   | 0.095015   | 0.12731    |  11.0 |  0.95
Output  | 7.2886     | 7.2887     | 7.2887     |   0.0 | 72.80
Modify  | 0.090629   | 0.09165    | 0.092174   |   0.2 |  0.92
Other   |            | 0.005734   |            |       |  0.06

Nlocal:        97284.8 ave       97286 max       97284 min
Histogram: 2 0 0 0 0 3 0 0 0 1
Nghost:         159783 ave      165082 max      156184 min
Histogram: 1 1 1 0 1 1 0 0 0 1
Neighs:    7.99549e+06 ave 8.11352e+06 max 7.91623e+06 min
Histogram: 1 1 2 0 0 0 0 1 0 1
FullNghs:  1.59806e+07 ave 1.62679e+07 max 1.58019e+07 min
Histogram: 1 2 1 0 0 0 1 0 0 1

Total # of neighbors = 95883622
Ave neighs/atom = 164.26614
Neighbor list builds = 0
Dangerous builds = 0

###----mimic the short pulse of laser to a localized region----
print "*** Laser pulse begins***"
*** Laser pulse begins***
## Create ellipsoidal region of atoms
variable ellipse_a equal ${Height}/2 # spread of laser shot
variable ellipse_a equal 50/2 
variable ellipse_b equal 2*${Height} # depth of laser shot, melt-pool depth for SLM
variable ellipse_b equal 2*50 
variable ellipse_c equal ${ellipse_a}
variable ellipse_c equal 25

variable DistanceLaserShot equal 1.0*${Height}  # center to center distance between laser shots
variable DistanceLaserShot equal 1.0*50  
variable nLaserShot equal floor(${lx}/${DistanceLaserShot})
variable nLaserShot equal floor(301/${DistanceLaserShot})
variable nLaserShot equal floor(301/50)
variable vloopLaser loop ${nLaserShot}
variable vloopLaser loop 6
label labelLaserPulse
print "Laser loop: ${vloopLaser}"
Laser loop: 1

variable temp01 equal 0.00 #((step/${nrun})%2)*${Height}
variable temp02 equal ${DistanceLaserShot}*(${vloopLaser}-1)+${Height}/2
variable temp02 equal 50*(${vloopLaser}-1)+${Height}/2
variable temp02 equal 50*(1-1)+${Height}/2
variable temp02 equal 50*(1-1)+50/2
variable cx equal ${temp01}+${temp02} #((step/${nrun})%2)*10 + 100*${vloopLaser} - 50
variable cx equal 0+${temp02} 
variable cx equal 0+25 
variable cy equal ${y3}
variable cy equal 400
variable cz equal (${z2}+${z3})/2
variable cz equal (0+${z3})/2
variable cz equal (0+3)/2
region AreaLaser01 ellipsoid ${cx} ${cy} ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 25 ${cy} ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 25 400 ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 25 400 1.5 ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 25 400 1.5 25 ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 25 400 1.5 25 100 ${ellipse_c}
region AreaLaser01 ellipsoid 25 400 1.5 25 100 25
group AreaLaser01 region AreaLaser01
25569 atoms in group AreaLaser01
#delete_atoms group AreaLaser01
displace_atoms AreaLaser01 random 0.05 0.1 0.05 123456
Displacing atoms ...
run ${nrun}
run 4
Per MPI rank memory allocation (min/avg/max) = 273.5 | 292.9 | 331 Mbytes
   Step          Temp          PotEng         KinEng        v_Temp02   
        92   2018.6876     -2423186.5      152310.34      813.31881    
        93   1974.2801     -2420110.8      148959.79      611.83379    
        94   1960.0132     -2419368.3      147883.35      548.85597    
        95   1971.0718     -2420574.8      148717.72      608.77666    
        96   1995.5015     -2422796.7      150560.95      740.85056    
Loop time of 10.0814 on 6 procs for 4 steps with 583709 atoms

Performance: 0.171 ns/day, 140.019 hours/ns, 0.397 timesteps/s
94.3% CPU use with 6 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2.4757     | 2.5338     | 2.5707     |   2.1 | 25.13
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.037455   | 0.074017   | 0.13097    |  12.1 |  0.73
Output  | 7.3739     | 7.374      | 7.374      |   0.0 | 73.14
Modify  | 0.091069   | 0.09218    | 0.092772   |   0.2 |  0.91
Other   |            | 0.007369   |            |       |  0.07

Nlocal:        97284.8 ave       97319 max       97253 min
Histogram: 1 0 1 0 2 0 0 1 0 1
Nghost:         159736 ave      165045 max      156142 min
Histogram: 1 1 1 0 1 1 0 0 0 1
Neighs:     7.9621e+06 ave 8.03847e+06 max 7.90815e+06 min
Histogram: 1 0 1 1 2 0 0 0 0 1
FullNghs:  1.58955e+07 ave 1.60537e+07 max 1.57839e+07 min
Histogram: 1 0 1 1 2 0 0 0 0 1

Total # of neighbors = 95372964
Ave neighs/atom = 163.39129
Neighbor list builds = 0
Dangerous builds = 0

region AreaLaser01 delete
group AreaLaser01 delete

next vloopLaser
jump SELF labelLaserPulse
print "Laser loop: ${vloopLaser}"
Laser loop: 2

variable temp01 equal 0.00 #((step/${nrun})%2)*${Height}
variable temp02 equal ${DistanceLaserShot}*(${vloopLaser}-1)+${Height}/2
variable temp02 equal 50*(${vloopLaser}-1)+${Height}/2
variable temp02 equal 50*(2-1)+${Height}/2
variable temp02 equal 50*(2-1)+50/2
variable cx equal ${temp01}+${temp02} #((step/${nrun})%2)*10 + 100*${vloopLaser} - 50
variable cx equal 0+${temp02} 
variable cx equal 0+75 
variable cy equal ${y3}
variable cy equal 400
variable cz equal (${z2}+${z3})/2
variable cz equal (0+${z3})/2
variable cz equal (0+3)/2
region AreaLaser01 ellipsoid ${cx} ${cy} ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 75 ${cy} ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 75 400 ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 75 400 1.5 ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 75 400 1.5 25 ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 75 400 1.5 25 100 ${ellipse_c}
region AreaLaser01 ellipsoid 75 400 1.5 25 100 25
group AreaLaser01 region AreaLaser01
30615 atoms in group AreaLaser01
#delete_atoms group AreaLaser01
displace_atoms AreaLaser01 random 0.05 0.1 0.05 123456
Displacing atoms ...
run ${nrun}
run 4
Per MPI rank memory allocation (min/avg/max) = 273.5 | 292.9 | 331 Mbytes
   Step          Temp          PotEng         KinEng        v_Temp02   
        96   1995.5015     -2412591.2      150560.95      740.85056    
        97   2031.5961     -2415713        153284.29      920.43147    
        98   2075.9374     -2419476.8      156629.86      1118.4139    
        99   2113.098      -2422683.6      159433.62      1275.7482    
       100   2132.7975     -2424535.8      160919.96      1359.0979    
Loop time of 9.96333 on 6 procs for 4 steps with 583709 atoms

Performance: 0.173 ns/day, 138.380 hours/ns, 0.401 timesteps/s
94.4% CPU use with 6 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2.5169     | 2.541      | 2.5749     |   1.3 | 25.50
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.029489   | 0.064421   | 0.088426   |   8.3 |  0.65
Output  | 7.2592     | 7.2593     | 7.2593     |   0.0 | 72.86
Modify  | 0.091717   | 0.09284    | 0.093973   |   0.3 |  0.93
Other   |            | 0.005719   |            |       |  0.06

Nlocal:        97284.8 ave       97348 max       97211 min
Histogram: 1 0 0 1 1 1 0 0 1 1
Nghost:         159702 ave      165066 max      156057 min
Histogram: 1 1 1 0 1 1 0 0 0 1
Neighs:     7.9369e+06 ave 7.98072e+06 max 7.89639e+06 min
Histogram: 1 0 0 1 2 0 1 0 0 1
FullNghs:  1.58603e+07 ave 1.59989e+07 max 1.57581e+07 min
Histogram: 1 0 0 3 0 1 0 0 0 1

Total # of neighbors = 95161780
Ave neighs/atom = 163.02949
Neighbor list builds = 0
Dangerous builds = 0

region AreaLaser01 delete
group AreaLaser01 delete

next vloopLaser
jump SELF labelLaserPulse
print "Laser loop: ${vloopLaser}"
Laser loop: 3

variable temp01 equal 0.00 #((step/${nrun})%2)*${Height}
variable temp02 equal ${DistanceLaserShot}*(${vloopLaser}-1)+${Height}/2
variable temp02 equal 50*(${vloopLaser}-1)+${Height}/2
variable temp02 equal 50*(3-1)+${Height}/2
variable temp02 equal 50*(3-1)+50/2
variable cx equal ${temp01}+${temp02} #((step/${nrun})%2)*10 + 100*${vloopLaser} - 50
variable cx equal 0+${temp02} 
variable cx equal 0+125 
variable cy equal ${y3}
variable cy equal 400
variable cz equal (${z2}+${z3})/2
variable cz equal (0+${z3})/2
variable cz equal (0+3)/2
region AreaLaser01 ellipsoid ${cx} ${cy} ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 125 ${cy} ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 125 400 ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 125 400 1.5 ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 125 400 1.5 25 ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 125 400 1.5 25 100 ${ellipse_c}
region AreaLaser01 ellipsoid 125 400 1.5 25 100 25
group AreaLaser01 region AreaLaser01
23704 atoms in group AreaLaser01
#delete_atoms group AreaLaser01
displace_atoms AreaLaser01 random 0.05 0.1 0.05 123456
Displacing atoms ...
run ${nrun}
run 4
Per MPI rank memory allocation (min/avg/max) = 273.5 | 292.9 | 331 Mbytes
   Step          Temp          PotEng         KinEng        v_Temp02   
       100   2132.7975     -2416790.8      160919.96      1359.0979    
       101   2141.3827     -2417793.6      161567.71      1397.9933    
       102   2148.0389     -2418659.3      162069.92      1433.7777    
       103   2152.7358     -2419373.7      162424.3       1471.9251    
       104   2155.08       -2419895.6      162601.18      1512.8391    
Loop time of 10.0223 on 6 procs for 4 steps with 583709 atoms

Performance: 0.172 ns/day, 139.199 hours/ns, 0.399 timesteps/s
94.6% CPU use with 6 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2.4899     | 2.5152     | 2.551      |   1.5 | 25.10
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.035651   | 0.070762   | 0.097321   |   9.0 |  0.71
Output  | 7.3375     | 7.3376     | 7.3376     |   0.0 | 73.21
Modify  | 0.091248   | 0.092304   | 0.092908   |   0.2 |  0.92
Other   |            | 0.006432   |            |       |  0.06

Nlocal:        97284.8 ave       97368 max       97162 min
Histogram: 1 0 0 0 2 0 1 0 0 2
Nghost:         159666 ave      165044 max      156008 min
Histogram: 1 1 1 0 1 1 0 0 0 1
Neighs:    7.92204e+06 ave 7.96462e+06 max 7.88215e+06 min
Histogram: 1 0 1 0 2 0 0 1 0 1
FullNghs:  1.58301e+07 ave 1.59702e+07 max 1.57299e+07 min
Histogram: 1 0 0 3 0 1 0 0 0 1

Total # of neighbors = 94980785
Ave neighs/atom = 162.71941
Neighbor list builds = 0
Dangerous builds = 0

region AreaLaser01 delete
group AreaLaser01 delete

next vloopLaser
jump SELF labelLaserPulse
print "Laser loop: ${vloopLaser}"
Laser loop: 4

variable temp01 equal 0.00 #((step/${nrun})%2)*${Height}
variable temp02 equal ${DistanceLaserShot}*(${vloopLaser}-1)+${Height}/2
variable temp02 equal 50*(${vloopLaser}-1)+${Height}/2
variable temp02 equal 50*(4-1)+${Height}/2
variable temp02 equal 50*(4-1)+50/2
variable cx equal ${temp01}+${temp02} #((step/${nrun})%2)*10 + 100*${vloopLaser} - 50
variable cx equal 0+${temp02} 
variable cx equal 0+175 
variable cy equal ${y3}
variable cy equal 400
variable cz equal (${z2}+${z3})/2
variable cz equal (0+${z3})/2
variable cz equal (0+3)/2
region AreaLaser01 ellipsoid ${cx} ${cy} ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 175 ${cy} ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 175 400 ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 175 400 1.5 ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 175 400 1.5 25 ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 175 400 1.5 25 100 ${ellipse_c}
region AreaLaser01 ellipsoid 175 400 1.5 25 100 25
group AreaLaser01 region AreaLaser01
31756 atoms in group AreaLaser01
#delete_atoms group AreaLaser01
displace_atoms AreaLaser01 random 0.05 0.1 0.05 123456
Displacing atoms ...
run ${nrun}
run 4
Per MPI rank memory allocation (min/avg/max) = 273.5 | 292.9 | 331 Mbytes
   Step          Temp          PotEng         KinEng        v_Temp02   
       104   2155.08       -2409533.7      162601.18      1512.8391    
       105   2166.6075     -2410766.8      163470.93      1587.2446    
       106   2194.1104     -2413237        165546.02      1712.2285    
       107   2226.6531     -2416087.1      168001.38      1851.6194    
       108   2252.6379     -2418414.3      169961.94      1967.3068    
Loop time of 9.78754 on 6 procs for 4 steps with 583709 atoms

Performance: 0.177 ns/day, 135.938 hours/ns, 0.409 timesteps/s
94.4% CPU use with 6 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2.4746     | 2.504      | 2.5548     |   1.7 | 25.58
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.02536    | 0.077108   | 0.10779    |   9.9 |  0.79
Output  | 7.1039     | 7.104      | 7.104      |   0.0 | 72.58
Modify  | 0.093678   | 0.09591    | 0.098605   |   0.5 |  0.98
Other   |            | 0.006528   |            |       |  0.07

Nlocal:        97284.8 ave       97406 max       97134 min
Histogram: 1 0 0 1 1 0 1 0 1 1
Nghost:         159636 ave      165111 max      155954 min
Histogram: 1 1 1 0 1 1 0 0 0 1
Neighs:    7.90629e+06 ave 7.94126e+06 max 7.86951e+06 min
Histogram: 1 0 1 0 2 0 0 0 1 1
FullNghs:   1.5799e+07 ave 1.59286e+07 max 1.57031e+07 min
Histogram: 1 0 0 3 0 1 0 0 0 1

Total # of neighbors = 94793832
Ave neighs/atom = 162.39913
Neighbor list builds = 0
Dangerous builds = 0

region AreaLaser01 delete
group AreaLaser01 delete

next vloopLaser
jump SELF labelLaserPulse
print "Laser loop: ${vloopLaser}"
Laser loop: 5

variable temp01 equal 0.00 #((step/${nrun})%2)*${Height}
variable temp02 equal ${DistanceLaserShot}*(${vloopLaser}-1)+${Height}/2
variable temp02 equal 50*(${vloopLaser}-1)+${Height}/2
variable temp02 equal 50*(5-1)+${Height}/2
variable temp02 equal 50*(5-1)+50/2
variable cx equal ${temp01}+${temp02} #((step/${nrun})%2)*10 + 100*${vloopLaser} - 50
variable cx equal 0+${temp02} 
variable cx equal 0+225 
variable cy equal ${y3}
variable cy equal 400
variable cz equal (${z2}+${z3})/2
variable cz equal (0+${z3})/2
variable cz equal (0+3)/2
region AreaLaser01 ellipsoid ${cx} ${cy} ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 225 ${cy} ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 225 400 ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 225 400 1.5 ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 225 400 1.5 25 ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 225 400 1.5 25 100 ${ellipse_c}
region AreaLaser01 ellipsoid 225 400 1.5 25 100 25
group AreaLaser01 region AreaLaser01
25971 atoms in group AreaLaser01
#delete_atoms group AreaLaser01
displace_atoms AreaLaser01 random 0.05 0.1 0.05 123456
Displacing atoms ...
run ${nrun}
run 4
Per MPI rank memory allocation (min/avg/max) = 273.5 | 292.9 | 331 Mbytes
   Step          Temp          PotEng         KinEng        v_Temp02   
       108   2252.6379     -2410023.6      169961.94      1967.3068    
       109   2273.658      -2411969        171547.91      2074.3205    
       110   2292.5517     -2413755.6      172973.44      2186.382     
       111   2303.5533     -2414929.4      173803.52      2274.0897    
       112   2303.3298     -2415224.9      173786.65      2317.4737    
Loop time of 9.7716 on 6 procs for 4 steps with 583709 atoms

Performance: 0.177 ns/day, 135.717 hours/ns, 0.409 timesteps/s
94.5% CPU use with 6 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2.5126     | 2.5352     | 2.5574     |   1.0 | 25.94
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.033252   | 0.055256   | 0.077619   |   7.3 |  0.57
Output  | 7.0822     | 7.0823     | 7.0825     |   0.0 | 72.48
Modify  | 0.089555   | 0.092035   | 0.093114   |   0.4 |  0.94
Other   |            | 0.006811   |            |       |  0.07

Nlocal:        97284.8 ave       97424 max       97100 min
Histogram: 1 0 0 0 1 1 1 0 1 1
Nghost:         159628 ave      165173 max      155911 min
Histogram: 1 1 1 0 1 1 0 0 0 1
Neighs:    7.89036e+06 ave  7.9208e+06 max  7.8544e+06 min
Histogram: 1 0 1 0 0 2 0 0 0 2
FullNghs:  1.57662e+07 ave  1.5887e+07 max  1.5674e+07 min
Histogram: 1 0 1 2 0 0 1 0 0 1

Total # of neighbors = 94596991
Ave neighs/atom = 162.0619
Neighbor list builds = 0
Dangerous builds = 0

region AreaLaser01 delete
group AreaLaser01 delete

next vloopLaser
jump SELF labelLaserPulse
print "Laser loop: ${vloopLaser}"
Laser loop: 6

variable temp01 equal 0.00 #((step/${nrun})%2)*${Height}
variable temp02 equal ${DistanceLaserShot}*(${vloopLaser}-1)+${Height}/2
variable temp02 equal 50*(${vloopLaser}-1)+${Height}/2
variable temp02 equal 50*(6-1)+${Height}/2
variable temp02 equal 50*(6-1)+50/2
variable cx equal ${temp01}+${temp02} #((step/${nrun})%2)*10 + 100*${vloopLaser} - 50
variable cx equal 0+${temp02} 
variable cx equal 0+275 
variable cy equal ${y3}
variable cy equal 400
variable cz equal (${z2}+${z3})/2
variable cz equal (0+${z3})/2
variable cz equal (0+3)/2
region AreaLaser01 ellipsoid ${cx} ${cy} ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 275 ${cy} ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 275 400 ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 275 400 1.5 ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 275 400 1.5 25 ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 275 400 1.5 25 100 ${ellipse_c}
region AreaLaser01 ellipsoid 275 400 1.5 25 100 25
group AreaLaser01 region AreaLaser01
25671 atoms in group AreaLaser01
#delete_atoms group AreaLaser01
displace_atoms AreaLaser01 random 0.05 0.1 0.05 123456
Displacing atoms ...
run ${nrun}
run 4
Per MPI rank memory allocation (min/avg/max) = 273.5 | 292.9 | 331 Mbytes
   Step          Temp          PotEng         KinEng        v_Temp02   
       112   2303.3298     -2406977.2      173786.65      2317.4737    
       113   2301.0331     -2407110.6      173613.36      2338.2867    
       114   2305.4607     -2407762.3      173947.42      2365.3294    
       115   2313.2721     -2408665.1      174536.8       2396.7906    
       116   2320.0699     -2409472        175049.69      2427.6838    
Loop time of 9.81563 on 6 procs for 4 steps with 583709 atoms

Performance: 0.176 ns/day, 136.328 hours/ns, 0.408 timesteps/s
94.5% CPU use with 6 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2.6607     | 2.7019     | 2.7415     |   1.6 | 27.53
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.032514   | 0.073058   | 0.11498    |   9.8 |  0.74
Output  | 6.9393     | 6.9394     | 6.9394     |   0.0 | 70.70
Modify  | 0.093847   | 0.094884   | 0.096085   |   0.3 |  0.97
Other   |            | 0.006449   |            |       |  0.07

Nlocal:        97284.8 ave       97448 max       97073 min
Histogram: 1 0 0 1 0 1 1 0 1 1
Nghost:         159585 ave      165198 max      155877 min
Histogram: 1 1 1 0 1 1 0 0 0 1
Neighs:    7.87337e+06 ave 7.90114e+06 max 7.83904e+06 min
Histogram: 1 1 0 0 0 1 1 0 0 2
FullNghs:  1.57313e+07 ave 1.58393e+07 max 1.56451e+07 min
Histogram: 1 1 0 1 1 0 1 0 0 1

Total # of neighbors = 94387526
Ave neighs/atom = 161.70305
Neighbor list builds = 0
Dangerous builds = 0

region AreaLaser01 delete
group AreaLaser01 delete

next vloopLaser
jump SELF labelLaserPulse

print "*** Idle run begins***"
*** Idle run begins***
run ${nrunIdle}
run 0
Per MPI rank memory allocation (min/avg/max) = 273.5 | 292.9 | 331 Mbytes
   Step          Temp          PotEng         KinEng        v_Temp02   
       116   2320.0699     -2409472        175049.69      2427.6838    
Loop time of 8.41667e-06 on 6 procs for 0 steps with 583709 atoms

0.0% CPU use with 6 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0          | 0          | 0          |   0.0 |  0.00
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 8.417e-06  |            |       |100.00

Nlocal:        97284.8 ave       97478 max       97027 min
Histogram: 1 0 0 0 1 2 0 0 1 1
Nghost:         159542 ave      165241 max      155773 min
Histogram: 1 1 1 0 1 1 0 0 0 1
Neighs:    7.85787e+06 ave 7.88637e+06 max 7.82586e+06 min
Histogram: 2 0 0 0 0 1 1 0 0 2
FullNghs:  1.57313e+07 ave 1.58393e+07 max 1.56451e+07 min
Histogram: 1 1 0 1 1 0 1 0 0 1

Total # of neighbors = 94387526
Ave neighs/atom = 161.70305
Neighbor list builds = 0
Dangerous builds = 0

print "******LAMMPS loop finished******"
******LAMMPS loop finished******


jump script_LAMMPS_Basic.inp labelAMLoop
print "loop: ${loop01}"
loop: 5
next loop01
jump script_LAMMPS_AM.inp
### command to run recurssively for AM simulation
### Delete previous fix, region, group etc. before redefining

### delete the bottom atom righ at the begining and reassign before the next run for T-control
delete_atoms region BlockDeleteAtomsBottom_01
Deleted 10 atoms, new total = 583699

unfix 1
unfix fPushParticles
unfix fLangevin
region BlockInside delete
group GroupInside delete
region BlockDeleteAtomsBottom_01 delete
group GroupDeleteAtomsBottom_01 delete
region BlockCreateAtomsTop_01 delete
group GroupCreateAtomsTop_01 delete

variable delta_y equal (step/${nrun})*${Height}
variable delta_y equal (step/4)*${Height}
variable delta_y equal (step/4)*50
if "${nAtomsAll} > ${nAtomsInitial}" then "variable y1 equal ${y1}+${Height}" # This will make sure that total number of atom is close to initial atoms
variable y1 equal ${y1}+${Height}
variable y1 equal 150+${Height}
variable y1 equal 150+50
variable y2 equal ${y2}+${Height}
variable y2 equal 350+${Height}
variable y2 equal 350+50
variable y3 equal ${y3}+${Height}
variable y3 equal 400+${Height}
variable y3 equal 400+50
variable y_Inside equal ${y1}+2
variable y_Inside equal 200+2

### update other regions
region		BlockDeleteAtomsBottom_01 block INF INF INF ${y1} INF INF # delete all atom down the interface
region		BlockDeleteAtomsBottom_01 block INF INF INF 200 INF INF 
region		BlockCreateAtomsTop_01 block INF INF ${y2} ${y3} INF INF
region		BlockCreateAtomsTop_01 block INF INF 400 ${y3} INF INF
region		BlockCreateAtomsTop_01 block INF INF 400 450 INF INF
region		BlockInside block INF INF ${y_Inside} INF INF INF
region		BlockInside block INF INF 202 INF INF INF

###----create atoms i.e, spherical powder particles in a loop-----
print "*** Powder particle creation begins***"
*** Powder particle creation begins***
variable nParticles equal floor(${lx}/(${Height})) # square box shaped
variable nParticles equal floor(301/(${Height})) 
variable nParticles equal floor(301/(50)) 
variable radiusIdeal equal ${Height}/2
variable radiusIdeal equal 50/2
variable vloopParticle loop ${nParticles}
variable vloopParticle loop 6
label labelParticleCreation
print "Grain creation loop: ${vloopParticle}"
Grain creation loop: 1
variable perturb01 equal v_random01
if "(${vloopParticle} == 0) || (${vloopParticle} == ${nParticles})" then "variable perturb01 equal 0.00"

variable radius equal (0.75+0.25*${perturb01})*${radiusIdeal}
variable radius equal (0.75+0.25*0.763651669025421)*${radiusIdeal}
variable radius equal (0.75+0.25*0.763651669025421)*25
variable temp01 equal ${perturb01}*${radiusIdeal}  #((step/${nrun})%2)*${radius}
variable temp01 equal 0.398847758769989*${radiusIdeal}  
variable temp01 equal 0.398847758769989*25  
variable temp02 equal 2*${radiusIdeal}*(${vloopParticle}-1)+${radiusIdeal}
variable temp02 equal 2*25*(${vloopParticle}-1)+${radiusIdeal}
variable temp02 equal 2*25*(1-1)+${radiusIdeal}
variable temp02 equal 2*25*(1-1)+25
variable cx equal ${temp01}+${temp02} #((step/${nrun})%2)*10 + 100*${vloopParticle} - 50
variable cx equal 9.97119396924973+${temp02} 
variable cx equal 9.97119396924973+25 
variable cy equal (${y2}+${y3})/2
variable cy equal (400+${y3})/2
variable cy equal (400+450)/2
variable cz equal (${z2}+${z3})/2
variable cz equal (0+${z3})/2
variable cz equal (0+3)/2
print "Grain parameters cx: ${cx} cy: ${cy} cz: ${cz} radius: ${radius}"
Grain parameters cx: 34.9711939692497 cy: 425 cz: 1.5 radius: 23.5228229314089
region Particle sphere ${cx} ${cy} ${cz} ${radius}
region Particle sphere 34.9711939692497 ${cy} ${cz} ${radius}
region Particle sphere 34.9711939692497 425 ${cz} ${radius}
region Particle sphere 34.9711939692497 425 1.5 ${radius}
region Particle sphere 34.9711939692497 425 1.5 23.5228229314089

create_atoms 1 region Particle
Created 24267 atoms
  using lattice units in orthogonal box = (-4.1939037 176 -0.041753547) to (1063.7139 1763.52 10.601754)
  create_atoms CPU = 0.019 seconds
group Particle region Particle
24267 atoms in group Particle

variable theta_z equal ${random01}*90  # angle to rotate the grain
variable theta_z equal 0.534315586090088*90  
displace_atoms Particle rotate ${cx} ${cy} ${cz} 0 0 1 ${theta_z} # rotate wrt z-axis
displace_atoms Particle rotate 34.9711939692497 ${cy} ${cz} 0 0 1 ${theta_z} 
displace_atoms Particle rotate 34.9711939692497 425 ${cz} 0 0 1 ${theta_z} 
displace_atoms Particle rotate 34.9711939692497 425 1.5 0 0 1 ${theta_z} 
displace_atoms Particle rotate 34.9711939692497 425 1.5 0 0 1 48.0884027481079 
Displacing atoms ...

group GroupCreateAtomsTop_01 union GroupCreateAtomsTop_01 Particle
24267 atoms in group GroupCreateAtomsTop_01
region Particle delete
group Particle delete

next vloopParticle
jump SELF labelParticleCreation
print "Grain creation loop: ${vloopParticle}"
Grain creation loop: 2
variable perturb01 equal v_random01
if "(${vloopParticle} == 0) || (${vloopParticle} == ${nParticles})" then "variable perturb01 equal 0.00"

variable radius equal (0.75+0.25*${perturb01})*${radiusIdeal}
variable radius equal (0.75+0.25*0.271753013134003)*${radiusIdeal}
variable radius equal (0.75+0.25*0.271753013134003)*25
variable temp01 equal ${perturb01}*${radiusIdeal}  #((step/${nrun})%2)*${radius}
variable temp01 equal 0.0996348857879639*${radiusIdeal}  
variable temp01 equal 0.0996348857879639*25  
variable temp02 equal 2*${radiusIdeal}*(${vloopParticle}-1)+${radiusIdeal}
variable temp02 equal 2*25*(${vloopParticle}-1)+${radiusIdeal}
variable temp02 equal 2*25*(2-1)+${radiusIdeal}
variable temp02 equal 2*25*(2-1)+25
variable cx equal ${temp01}+${temp02} #((step/${nrun})%2)*10 + 100*${vloopParticle} - 50
variable cx equal 2.4908721446991+${temp02} 
variable cx equal 2.4908721446991+75 
variable cy equal (${y2}+${y3})/2
variable cy equal (400+${y3})/2
variable cy equal (400+450)/2
variable cz equal (${z2}+${z3})/2
variable cz equal (0+${z3})/2
variable cz equal (0+3)/2
print "Grain parameters cx: ${cx} cy: ${cy} cz: ${cz} radius: ${radius}"
Grain parameters cx: 77.4908721446991 cy: 425 cz: 1.5 radius: 20.4484563320875
region Particle sphere ${cx} ${cy} ${cz} ${radius}
region Particle sphere 77.4908721446991 ${cy} ${cz} ${radius}
region Particle sphere 77.4908721446991 425 ${cz} ${radius}
region Particle sphere 77.4908721446991 425 1.5 ${radius}
region Particle sphere 77.4908721446991 425 1.5 20.4484563320875

create_atoms 1 region Particle
Created 18331 atoms
  using lattice units in orthogonal box = (-4.1939037 176 -0.041753547) to (1063.7139 1763.52 10.601754)
  create_atoms CPU = 0.015 seconds
group Particle region Particle
18474 atoms in group Particle

variable theta_z equal ${random01}*90  # angle to rotate the grain
variable theta_z equal 0.828628540039062*90  
displace_atoms Particle rotate ${cx} ${cy} ${cz} 0 0 1 ${theta_z} # rotate wrt z-axis
displace_atoms Particle rotate 77.4908721446991 ${cy} ${cz} 0 0 1 ${theta_z} 
displace_atoms Particle rotate 77.4908721446991 425 ${cz} 0 0 1 ${theta_z} 
displace_atoms Particle rotate 77.4908721446991 425 1.5 0 0 1 ${theta_z} 
displace_atoms Particle rotate 77.4908721446991 425 1.5 0 0 1 74.5765686035156 
Displacing atoms ...

group GroupCreateAtomsTop_01 union GroupCreateAtomsTop_01 Particle
42598 atoms in group GroupCreateAtomsTop_01
region Particle delete
group Particle delete

next vloopParticle
jump SELF labelParticleCreation
print "Grain creation loop: ${vloopParticle}"
Grain creation loop: 3
variable perturb01 equal v_random01
if "(${vloopParticle} == 0) || (${vloopParticle} == ${nParticles})" then "variable perturb01 equal 0.00"

variable radius equal (0.75+0.25*${perturb01})*${radiusIdeal}
variable radius equal (0.75+0.25*0.346259474754333)*${radiusIdeal}
variable radius equal (0.75+0.25*0.346259474754333)*25
variable temp01 equal ${perturb01}*${radiusIdeal}  #((step/${nrun})%2)*${radius}
variable temp01 equal 0.559885859489441*${radiusIdeal}  
variable temp01 equal 0.559885859489441*25  
variable temp02 equal 2*${radiusIdeal}*(${vloopParticle}-1)+${radiusIdeal}
variable temp02 equal 2*25*(${vloopParticle}-1)+${radiusIdeal}
variable temp02 equal 2*25*(3-1)+${radiusIdeal}
variable temp02 equal 2*25*(3-1)+25
variable cx equal ${temp01}+${temp02} #((step/${nrun})%2)*10 + 100*${vloopParticle} - 50
variable cx equal 13.997146487236+${temp02} 
variable cx equal 13.997146487236+125 
variable cy equal (${y2}+${y3})/2
variable cy equal (400+${y3})/2
variable cy equal (400+450)/2
variable cz equal (${z2}+${z3})/2
variable cz equal (0+${z3})/2
variable cz equal (0+3)/2
print "Grain parameters cx: ${cx} cy: ${cy} cz: ${cz} radius: ${radius}"
Grain parameters cx: 138.997146487236 cy: 425 cz: 1.5 radius: 20.9141217172146
region Particle sphere ${cx} ${cy} ${cz} ${radius}
region Particle sphere 138.997146487236 ${cy} ${cz} ${radius}
region Particle sphere 138.997146487236 425 ${cz} ${radius}
region Particle sphere 138.997146487236 425 1.5 ${radius}
region Particle sphere 138.997146487236 425 1.5 20.9141217172146

create_atoms 1 region Particle
Created 19208 atoms
  using lattice units in orthogonal box = (-4.1939037 176 -0.041753547) to (1063.7139 1763.52 10.601754)
  create_atoms CPU = 0.014 seconds
group Particle region Particle
19208 atoms in group Particle

variable theta_z equal ${random01}*90  # angle to rotate the grain
variable theta_z equal 0.956634700298309*90  
displace_atoms Particle rotate ${cx} ${cy} ${cz} 0 0 1 ${theta_z} # rotate wrt z-axis
displace_atoms Particle rotate 138.997146487236 ${cy} ${cz} 0 0 1 ${theta_z} 
displace_atoms Particle rotate 138.997146487236 425 ${cz} 0 0 1 ${theta_z} 
displace_atoms Particle rotate 138.997146487236 425 1.5 0 0 1 ${theta_z} 
displace_atoms Particle rotate 138.997146487236 425 1.5 0 0 1 86.0971230268478 
Displacing atoms ...

group GroupCreateAtomsTop_01 union GroupCreateAtomsTop_01 Particle
61806 atoms in group GroupCreateAtomsTop_01
region Particle delete
group Particle delete

next vloopParticle
jump SELF labelParticleCreation
print "Grain creation loop: ${vloopParticle}"
Grain creation loop: 4
variable perturb01 equal v_random01
if "(${vloopParticle} == 0) || (${vloopParticle} == ${nParticles})" then "variable perturb01 equal 0.00"

variable radius equal (0.75+0.25*${perturb01})*${radiusIdeal}
variable radius equal (0.75+0.25*0.18527215719223)*${radiusIdeal}
variable radius equal (0.75+0.25*0.18527215719223)*25
variable temp01 equal ${perturb01}*${radiusIdeal}  #((step/${nrun})%2)*${radius}
variable temp01 equal 0.518305599689484*${radiusIdeal}  
variable temp01 equal 0.518305599689484*25  
variable temp02 equal 2*${radiusIdeal}*(${vloopParticle}-1)+${radiusIdeal}
variable temp02 equal 2*25*(${vloopParticle}-1)+${radiusIdeal}
variable temp02 equal 2*25*(4-1)+${radiusIdeal}
variable temp02 equal 2*25*(4-1)+25
variable cx equal ${temp01}+${temp02} #((step/${nrun})%2)*10 + 100*${vloopParticle} - 50
variable cx equal 12.9576399922371+${temp02} 
variable cx equal 12.9576399922371+175 
variable cy equal (${y2}+${y3})/2
variable cy equal (400+${y3})/2
variable cy equal (400+450)/2
variable cz equal (${z2}+${z3})/2
variable cz equal (0+${z3})/2
variable cz equal (0+3)/2
print "Grain parameters cx: ${cx} cy: ${cy} cz: ${cz} radius: ${radius}"
Grain parameters cx: 187.957639992237 cy: 425 cz: 1.5 radius: 19.9079509824514
region Particle sphere ${cx} ${cy} ${cz} ${radius}
region Particle sphere 187.957639992237 ${cy} ${cz} ${radius}
region Particle sphere 187.957639992237 425 ${cz} ${radius}
region Particle sphere 187.957639992237 425 1.5 ${radius}
region Particle sphere 187.957639992237 425 1.5 19.9079509824514

create_atoms 1 region Particle
Created 17372 atoms
  using lattice units in orthogonal box = (-4.1939037 176 -0.041753547) to (1063.7139 1763.52 10.601754)
  create_atoms CPU = 0.016 seconds
group Particle region Particle
17372 atoms in group Particle

variable theta_z equal ${random01}*90  # angle to rotate the grain
variable theta_z equal 0.849549531936646*90  
displace_atoms Particle rotate ${cx} ${cy} ${cz} 0 0 1 ${theta_z} # rotate wrt z-axis
displace_atoms Particle rotate 187.957639992237 ${cy} ${cz} 0 0 1 ${theta_z} 
displace_atoms Particle rotate 187.957639992237 425 ${cz} 0 0 1 ${theta_z} 
displace_atoms Particle rotate 187.957639992237 425 1.5 0 0 1 ${theta_z} 
displace_atoms Particle rotate 187.957639992237 425 1.5 0 0 1 76.4594578742981 
Displacing atoms ...

group GroupCreateAtomsTop_01 union GroupCreateAtomsTop_01 Particle
79178 atoms in group GroupCreateAtomsTop_01
region Particle delete
group Particle delete

next vloopParticle
jump SELF labelParticleCreation
print "Grain creation loop: ${vloopParticle}"
Grain creation loop: 5
variable perturb01 equal v_random01
if "(${vloopParticle} == 0) || (${vloopParticle} == ${nParticles})" then "variable perturb01 equal 0.00"

variable radius equal (0.75+0.25*${perturb01})*${radiusIdeal}
variable radius equal (0.75+0.25*0.650080978870392)*${radiusIdeal}
variable radius equal (0.75+0.25*0.650080978870392)*25
variable temp01 equal ${perturb01}*${radiusIdeal}  #((step/${nrun})%2)*${radius}
variable temp01 equal 0.900030791759491*${radiusIdeal}  
variable temp01 equal 0.900030791759491*25  
variable temp02 equal 2*${radiusIdeal}*(${vloopParticle}-1)+${radiusIdeal}
variable temp02 equal 2*25*(${vloopParticle}-1)+${radiusIdeal}
variable temp02 equal 2*25*(5-1)+${radiusIdeal}
variable temp02 equal 2*25*(5-1)+25
variable cx equal ${temp01}+${temp02} #((step/${nrun})%2)*10 + 100*${vloopParticle} - 50
variable cx equal 22.5007697939873+${temp02} 
variable cx equal 22.5007697939873+225 
variable cy equal (${y2}+${y3})/2
variable cy equal (400+${y3})/2
variable cy equal (400+450)/2
variable cz equal (${z2}+${z3})/2
variable cz equal (0+${z3})/2
variable cz equal (0+3)/2
print "Grain parameters cx: ${cx} cy: ${cy} cz: ${cz} radius: ${radius}"
Grain parameters cx: 247.500769793987 cy: 425 cz: 1.5 radius: 22.8130061179399
region Particle sphere ${cx} ${cy} ${cz} ${radius}
region Particle sphere 247.500769793987 ${cy} ${cz} ${radius}
region Particle sphere 247.500769793987 425 ${cz} ${radius}
region Particle sphere 247.500769793987 425 1.5 ${radius}
region Particle sphere 247.500769793987 425 1.5 22.8130061179399

create_atoms 1 region Particle
Created 22851 atoms
  using lattice units in orthogonal box = (-4.1939037 176 -0.041753547) to (1063.7139 1763.52 10.601754)
  create_atoms CPU = 0.019 seconds
group Particle region Particle
22851 atoms in group Particle

variable theta_z equal ${random01}*90  # angle to rotate the grain
variable theta_z equal 0.197160243988037*90  
displace_atoms Particle rotate ${cx} ${cy} ${cz} 0 0 1 ${theta_z} # rotate wrt z-axis
displace_atoms Particle rotate 247.500769793987 ${cy} ${cz} 0 0 1 ${theta_z} 
displace_atoms Particle rotate 247.500769793987 425 ${cz} 0 0 1 ${theta_z} 
displace_atoms Particle rotate 247.500769793987 425 1.5 0 0 1 ${theta_z} 
displace_atoms Particle rotate 247.500769793987 425 1.5 0 0 1 17.7444219589233 
Displacing atoms ...

group GroupCreateAtomsTop_01 union GroupCreateAtomsTop_01 Particle
102029 atoms in group GroupCreateAtomsTop_01
region Particle delete
group Particle delete

next vloopParticle
jump SELF labelParticleCreation
print "Grain creation loop: ${vloopParticle}"
Grain creation loop: 6
variable perturb01 equal v_random01
if "(${vloopParticle} == 0) || (${vloopParticle} == ${nParticles})" then "variable perturb01 equal 0.00"
variable perturb01 equal 0.00

variable radius equal (0.75+0.25*${perturb01})*${radiusIdeal}
variable radius equal (0.75+0.25*0)*${radiusIdeal}
variable radius equal (0.75+0.25*0)*25
variable temp01 equal ${perturb01}*${radiusIdeal}  #((step/${nrun})%2)*${radius}
variable temp01 equal 0*${radiusIdeal}  
variable temp01 equal 0*25  
variable temp02 equal 2*${radiusIdeal}*(${vloopParticle}-1)+${radiusIdeal}
variable temp02 equal 2*25*(${vloopParticle}-1)+${radiusIdeal}
variable temp02 equal 2*25*(6-1)+${radiusIdeal}
variable temp02 equal 2*25*(6-1)+25
variable cx equal ${temp01}+${temp02} #((step/${nrun})%2)*10 + 100*${vloopParticle} - 50
variable cx equal 0+${temp02} 
variable cx equal 0+275 
variable cy equal (${y2}+${y3})/2
variable cy equal (400+${y3})/2
variable cy equal (400+450)/2
variable cz equal (${z2}+${z3})/2
variable cz equal (0+${z3})/2
variable cz equal (0+3)/2
print "Grain parameters cx: ${cx} cy: ${cy} cz: ${cz} radius: ${radius}"
Grain parameters cx: 275 cy: 425 cz: 1.5 radius: 18.75
region Particle sphere ${cx} ${cy} ${cz} ${radius}
region Particle sphere 275 ${cy} ${cz} ${radius}
region Particle sphere 275 425 ${cz} ${radius}
region Particle sphere 275 425 1.5 ${radius}
region Particle sphere 275 425 1.5 18.75

create_atoms 1 region Particle
Created 15432 atoms
  using lattice units in orthogonal box = (-4.1939037 176 -0.041753547) to (1063.7139 1763.52 10.601754)
  create_atoms CPU = 0.016 seconds
group Particle region Particle
19630 atoms in group Particle

variable theta_z equal ${random01}*90  # angle to rotate the grain
variable theta_z equal 0.760915815830231*90  
displace_atoms Particle rotate ${cx} ${cy} ${cz} 0 0 1 ${theta_z} # rotate wrt z-axis
displace_atoms Particle rotate 275 ${cy} ${cz} 0 0 1 ${theta_z} 
displace_atoms Particle rotate 275 425 ${cz} 0 0 1 ${theta_z} 
displace_atoms Particle rotate 275 425 1.5 0 0 1 ${theta_z} 
displace_atoms Particle rotate 275 425 1.5 0 0 1 68.4824234247208 
Displacing atoms ...

group GroupCreateAtomsTop_01 union GroupCreateAtomsTop_01 Particle
117461 atoms in group GroupCreateAtomsTop_01
region Particle delete
group Particle delete

next vloopParticle
jump SELF labelParticleCreation

### Assign velocity/Temperature to the newly created atoms
#group GroupCreateAtomsTop_01 region BlockCreateAtomsTop_01
delete_atoms overlap 2.25 GroupCreateAtomsTop_01 all  # atoms from the first group will be deleted
System init for delete_atoms ...
Neighbor list info ...
  update: every = 1 steps, delay = 10 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 7.65
  ghost atom cutoff = 7.65
  binsize = 3.825, bins = 280 416 3
  4 neighbor lists, perpetual/occasional/extra = 1 3 0
  (1) command delete_atoms, occasional
      attributes: full, newton on
      pair build: full/bin/atomonly
      stencil: full/bin/3d
      bin: standard
  (2) pair eam/alloy, perpetual
      attributes: half, newton on
      pair build: half/bin/atomonly/newton
      stencil: half/bin/3d
      bin: standard
  (3) compute cna/atom, occasional
      attributes: full, newton on
      pair build: full/bin/atomonly
      stencil: full/bin/3d
      bin: standard
  (4) compute centro/atom, occasional
      attributes: full, newton on
      pair build: full/bin/atomonly
      stencil: full/bin/3d
      bin: standard
Deleted 20664 atoms, new total = 680496
velocity	GroupCreateAtomsTop_01 create ${T2} 187723 #temp Temperature # assign velocity of the newly created atoms
velocity	GroupCreateAtomsTop_01 create 1600 187723 

### Redefine the group, fix etc.
group GroupDeleteAtomsBottom_01 region BlockDeleteAtomsBottom_01
179119 atoms in group GroupDeleteAtomsBottom_01
group GroupInside region BlockInside
498732 atoms in group GroupInside
#fix 1 GroupInside nve
fix  1 GroupInside npt temp $T $T 0.2 drag 0.5 x 0.0 0.0 5 z 0.0 0.0 5 couple none
fix  1 GroupInside npt temp 800 $T 0.2 drag 0.5 x 0.0 0.0 5 z 0.0 0.0 5 couple none
fix  1 GroupInside npt temp 800 800 0.2 drag 0.5 x 0.0 0.0 5 z 0.0 0.0 5 couple none
fix fPushParticles GroupCreateAtomsTop_01 addforce 0.0 -0.2 0.0 every 1
fix fLangevin GroupDeleteAtomsBottom_01 langevin ${T} ${T} 0.5 123456
fix fLangevin GroupDeleteAtomsBottom_01 langevin 800 ${T} 0.5 123456
fix fLangevin GroupDeleteAtomsBottom_01 langevin 800 800 0.5 123456

print "nAtomsAll: ${nAtomsAll}; nAtomsInitial: ${nAtomsInitial}; nAtomsNew: ${nAtomsNew}"
nAtomsAll: 680496; nAtomsInitial: 543606; nAtomsNew: 96797

balance 1.1 rcb  # load balancing
Balancing ...
Neighbor list info ...
  update: every = 1 steps, delay = 10 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 7.65
  ghost atom cutoff = 7.65
  binsize = 3.825, bins = 280 416 3
  3 neighbor lists, perpetual/occasional/extra = 1 2 0
  (1) pair eam/alloy, perpetual
      attributes: half, newton on
      pair build: half/bin/atomonly/newton
      stencil: half/bin/3d
      bin: standard
  (2) compute cna/atom, occasional
      attributes: full, newton on
      pair build: full/bin/atomonly
      stencil: full/bin/3d
      bin: standard
  (3) compute centro/atom, occasional
      attributes: full, newton on
      pair build: full/bin/atomonly
      stencil: full/bin/3d
      bin: standard
 rebalancing time: 0.106 seconds
  iteration count = 0
  initial/final maximal load/proc = 146067 113417
  initial/final imbalance factor  = 1.2878871 1.0000088

run ${nrun}
run 4
Per MPI rank memory allocation (min/avg/max) = 217 | 236 | 273.3 Mbytes
   Step          Temp          PotEng         KinEng        v_Temp02   
       116   2217.6645     -2835698.9      195067.73      1603.21      
       117   2211.07       -2835271.1      194487.67      1536.7009    
       118   2182.779      -2833024.7      191999.17      1353.973     
       119   2140.7137     -2829542.7      188299.06      1097.1855    
       120   2093.8145     -2825672.7      184173.77      824.35156    
Loop time of 11.5385 on 6 procs for 4 steps with 680496 atoms

Performance: 0.150 ns/day, 160.256 hours/ns, 0.347 timesteps/s
94.2% CPU use with 6 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2.8625     | 2.9162     | 2.9391     |   1.5 | 25.27
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.040437   | 0.066544   | 0.11753    |   9.9 |  0.58
Output  | 8.4385     | 8.4386     | 8.4386     |   0.0 | 73.13
Modify  | 0.10339    | 0.10973    | 0.11311    |   1.3 |  0.95
Other   |            | 0.007358   |            |       |  0.06

Nlocal:         113416 ave      113418 max      113415 min
Histogram: 2 0 0 3 0 0 0 0 0 1
Nghost:         186219 ave      189951 max      183676 min
Histogram: 2 1 1 0 0 0 0 0 0 2
Neighs:    9.22443e+06 ave 9.36339e+06 max 9.03195e+06 min
Histogram: 2 0 0 0 0 0 0 1 2 1
FullNghs:  1.84329e+07 ave 1.87189e+07 max 1.80518e+07 min
Histogram: 2 0 0 0 0 0 0 2 0 2

Total # of neighbors = 1.1059725e+08
Ave neighs/atom = 162.52447
Neighbor list builds = 0
Dangerous builds = 0

###----mimic the short pulse of laser to a localized region----
print "*** Laser pulse begins***"
*** Laser pulse begins***
## Create ellipsoidal region of atoms
variable ellipse_a equal ${Height}/2 # spread of laser shot
variable ellipse_a equal 50/2 
variable ellipse_b equal 2*${Height} # depth of laser shot, melt-pool depth for SLM
variable ellipse_b equal 2*50 
variable ellipse_c equal ${ellipse_a}
variable ellipse_c equal 25

variable DistanceLaserShot equal 1.0*${Height}  # center to center distance between laser shots
variable DistanceLaserShot equal 1.0*50  
variable nLaserShot equal floor(${lx}/${DistanceLaserShot})
variable nLaserShot equal floor(301/${DistanceLaserShot})
variable nLaserShot equal floor(301/50)
variable vloopLaser loop ${nLaserShot}
variable vloopLaser loop 6
label labelLaserPulse
print "Laser loop: ${vloopLaser}"
Laser loop: 1

variable temp01 equal 0.00 #((step/${nrun})%2)*${Height}
variable temp02 equal ${DistanceLaserShot}*(${vloopLaser}-1)+${Height}/2
variable temp02 equal 50*(${vloopLaser}-1)+${Height}/2
variable temp02 equal 50*(1-1)+${Height}/2
variable temp02 equal 50*(1-1)+50/2
variable cx equal ${temp01}+${temp02} #((step/${nrun})%2)*10 + 100*${vloopLaser} - 50
variable cx equal 0+${temp02} 
variable cx equal 0+25 
variable cy equal ${y3}
variable cy equal 450
variable cz equal (${z2}+${z3})/2
variable cz equal (0+${z3})/2
variable cz equal (0+3)/2
region AreaLaser01 ellipsoid ${cx} ${cy} ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 25 ${cy} ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 25 450 ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 25 450 1.5 ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 25 450 1.5 25 ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 25 450 1.5 25 100 ${ellipse_c}
region AreaLaser01 ellipsoid 25 450 1.5 25 100 25
group AreaLaser01 region AreaLaser01
31191 atoms in group AreaLaser01
#delete_atoms group AreaLaser01
displace_atoms AreaLaser01 random 0.05 0.1 0.05 123456
Displacing atoms ...
run ${nrun}
run 4
Per MPI rank memory allocation (min/avg/max) = 287.2 | 307.6 | 345.7 Mbytes
   Step          Temp          PotEng         KinEng        v_Temp02   
       120   2093.8145     -2815412.1      184173.77      824.35156    
       121   2061.4909     -2812865.5      181330.56      630.75956    
       122   2056.624      -2812800.1      180902.46      584.99877    
       123   2072.4348     -2814590        182293.2       663.45913    
       124   2096.8024     -2817133.6      184436.59      808.10105    
Loop time of 11.5038 on 6 procs for 4 steps with 680496 atoms

Performance: 0.150 ns/day, 159.774 hours/ns, 0.348 timesteps/s
95.1% CPU use with 6 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2.8569     | 2.8894     | 2.9441     |   1.8 | 25.12
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.029335   | 0.086299   | 0.11605    |  10.2 |  0.75
Output  | 8.4135     | 8.4136     | 8.4136     |   0.0 | 73.14
Modify  | 0.10139    | 0.10739    | 0.11085    |   1.2 |  0.93
Other   |            | 0.007037   |            |       |  0.06

Nlocal:         113416 ave      113463 max      113382 min
Histogram: 1 1 1 1 0 0 0 1 0 1
Nghost:         186178 ave      189906 max      183545 min
Histogram: 2 0 2 0 0 0 0 0 0 2
Neighs:    9.18629e+06 ave 9.30034e+06 max 9.01347e+06 min
Histogram: 2 0 0 0 0 0 0 1 1 2
FullNghs:  1.83429e+07 ave 1.85469e+07 max 1.80158e+07 min
Histogram: 2 0 0 0 0 0 0 0 2 2

Total # of neighbors = 1.100575e+08
Ave neighs/atom = 161.7313
Neighbor list builds = 0
Dangerous builds = 0

region AreaLaser01 delete
group AreaLaser01 delete

next vloopLaser
jump SELF labelLaserPulse
print "Laser loop: ${vloopLaser}"
Laser loop: 2

variable temp01 equal 0.00 #((step/${nrun})%2)*${Height}
variable temp02 equal ${DistanceLaserShot}*(${vloopLaser}-1)+${Height}/2
variable temp02 equal 50*(${vloopLaser}-1)+${Height}/2
variable temp02 equal 50*(2-1)+${Height}/2
variable temp02 equal 50*(2-1)+50/2
variable cx equal ${temp01}+${temp02} #((step/${nrun})%2)*10 + 100*${vloopLaser} - 50
variable cx equal 0+${temp02} 
variable cx equal 0+75 
variable cy equal ${y3}
variable cy equal 450
variable cz equal (${z2}+${z3})/2
variable cz equal (0+${z3})/2
variable cz equal (0+3)/2
region AreaLaser01 ellipsoid ${cx} ${cy} ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 75 ${cy} ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 75 450 ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 75 450 1.5 ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 75 450 1.5 25 ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 75 450 1.5 25 100 ${ellipse_c}
region AreaLaser01 ellipsoid 75 450 1.5 25 100 25
group AreaLaser01 region AreaLaser01
30910 atoms in group AreaLaser01
#delete_atoms group AreaLaser01
displace_atoms AreaLaser01 random 0.05 0.1 0.05 123456
Displacing atoms ...
run ${nrun}
run 4
Per MPI rank memory allocation (min/avg/max) = 287.2 | 307.6 | 345.7 Mbytes
   Step          Temp          PotEng         KinEng        v_Temp02   
       124   2096.8024     -2807129.4      184436.59      808.10105    
       125   2127.666      -2810258.7      187151.38      993.83367    
       126   2162.4456     -2813748.6      190210.63      1192.8009    
       127   2189.5546     -2816547.9      192595.15      1347.5797    
       128   2201.8776     -2818011.3      193679.09      1426.8408    
Loop time of 11.415 on 6 procs for 4 steps with 680496 atoms

Performance: 0.151 ns/day, 158.542 hours/ns, 0.350 timesteps/s
94.5% CPU use with 6 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2.8086     | 2.8687     | 2.9353     |   2.8 | 25.13
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.028557   | 0.09959    | 0.1552     |  14.2 |  0.87
Output  | 8.3325     | 8.3326     | 8.3327     |   0.0 | 73.00
Modify  | 0.097799   | 0.10573    | 0.10921    |   1.4 |  0.93
Other   |            | 0.008414   |            |       |  0.07

Nlocal:         113416 ave      113495 max      113346 min
Histogram: 2 0 0 0 2 0 0 0 1 1
Nghost:         186154 ave      189833 max      183490 min
Histogram: 2 0 2 0 0 0 0 0 0 2
Neighs:     9.1602e+06 ave 9.29725e+06 max 8.99411e+06 min
Histogram: 2 0 0 0 0 0 2 0 0 2
FullNghs:  1.83047e+07 ave 1.85371e+07 max 1.79735e+07 min
Histogram: 2 0 0 0 0 0 0 2 0 2

Total # of neighbors = 1.0982846e+08
Ave neighs/atom = 161.39472
Neighbor list builds = 0
Dangerous builds = 0

region AreaLaser01 delete
group AreaLaser01 delete

next vloopLaser
jump SELF labelLaserPulse
print "Laser loop: ${vloopLaser}"
Laser loop: 3

variable temp01 equal 0.00 #((step/${nrun})%2)*${Height}
variable temp02 equal ${DistanceLaserShot}*(${vloopLaser}-1)+${Height}/2
variable temp02 equal 50*(${vloopLaser}-1)+${Height}/2
variable temp02 equal 50*(3-1)+${Height}/2
variable temp02 equal 50*(3-1)+50/2
variable cx equal ${temp01}+${temp02} #((step/${nrun})%2)*10 + 100*${vloopLaser} - 50
variable cx equal 0+${temp02} 
variable cx equal 0+125 
variable cy equal ${y3}
variable cy equal 450
variable cz equal (${z2}+${z3})/2
variable cz equal (0+${z3})/2
variable cz equal (0+3)/2
region AreaLaser01 ellipsoid ${cx} ${cy} ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 125 ${cy} ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 125 450 ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 125 450 1.5 ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 125 450 1.5 25 ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 125 450 1.5 25 100 ${ellipse_c}
region AreaLaser01 ellipsoid 125 450 1.5 25 100 25
group AreaLaser01 region AreaLaser01
22408 atoms in group AreaLaser01
#delete_atoms group AreaLaser01
displace_atoms AreaLaser01 random 0.05 0.1 0.05 123456
Displacing atoms ...
run ${nrun}
run 4
Per MPI rank memory allocation (min/avg/max) = 287.2 | 307.6 | 345.7 Mbytes
   Step          Temp          PotEng         KinEng        v_Temp02   
       128   2201.8776     -2810709.3      193679.09      1426.8408    
       129   2205.3883     -2811388.8      193987.9       1457.8176    
       130   2208.328      -2812027.7      194246.48      1481.0315    
       131   2210.836      -2812627        194467.08      1506.4366    
       132   2212.3172     -2813122.5      194597.37      1538.0925    
Loop time of 11.3692 on 6 procs for 4 steps with 680496 atoms

Performance: 0.152 ns/day, 157.906 hours/ns, 0.352 timesteps/s
94.3% CPU use with 6 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2.807      | 2.8498     | 2.9016     |   1.8 | 25.07
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.040224   | 0.095243   | 0.13483    |   9.7 |  0.84
Output  | 8.3084     | 8.3086     | 8.3086     |   0.0 | 73.08
Modify  | 0.10187    | 0.10797    | 0.11134    |   1.2 |  0.95
Other   |            | 0.00769    |            |       |  0.07

Nlocal:         113416 ave      113527 max      113306 min
Histogram: 2 0 0 0 1 1 0 0 0 2
Nghost:         186099 ave      189743 max      183395 min
Histogram: 2 0 2 0 0 0 0 0 0 2
Neighs:    9.14333e+06 ave 9.29061e+06 max 8.97447e+06 min
Histogram: 2 0 0 0 0 1 1 0 0 2
FullNghs:  1.82711e+07 ave 1.85242e+07 max 1.79279e+07 min
Histogram: 2 0 0 0 0 0 0 2 0 2

Total # of neighbors = 1.096265e+08
Ave neighs/atom = 161.09794
Neighbor list builds = 0
Dangerous builds = 0

region AreaLaser01 delete
group AreaLaser01 delete

next vloopLaser
jump SELF labelLaserPulse
print "Laser loop: ${vloopLaser}"
Laser loop: 4

variable temp01 equal 0.00 #((step/${nrun})%2)*${Height}
variable temp02 equal ${DistanceLaserShot}*(${vloopLaser}-1)+${Height}/2
variable temp02 equal 50*(${vloopLaser}-1)+${Height}/2
variable temp02 equal 50*(4-1)+${Height}/2
variable temp02 equal 50*(4-1)+50/2
variable cx equal ${temp01}+${temp02} #((step/${nrun})%2)*10 + 100*${vloopLaser} - 50
variable cx equal 0+${temp02} 
variable cx equal 0+175 
variable cy equal ${y3}
variable cy equal 450
variable cz equal (${z2}+${z3})/2
variable cz equal (0+${z3})/2
variable cz equal (0+3)/2
region AreaLaser01 ellipsoid ${cx} ${cy} ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 175 ${cy} ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 175 450 ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 175 450 1.5 ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 175 450 1.5 25 ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 175 450 1.5 25 100 ${ellipse_c}
region AreaLaser01 ellipsoid 175 450 1.5 25 100 25
group AreaLaser01 region AreaLaser01
24467 atoms in group AreaLaser01
#delete_atoms group AreaLaser01
displace_atoms AreaLaser01 random 0.05 0.1 0.05 123456
Displacing atoms ...
run ${nrun}
run 4
Per MPI rank memory allocation (min/avg/max) = 287.2 | 307.6 | 345.7 Mbytes
   Step          Temp          PotEng         KinEng        v_Temp02   
       132   2212.3172     -2805196.3      194597.37      1538.0925    
       133   2219.7975     -2806229.2      195255.35      1606.5988    
       134   2237.6086     -2808191.4      196822.03      1727.683     
       135   2258.7237     -2810441.5      198679.33      1866.0566    
       136   2275.6294     -2812298.2      200166.37      1983.7083    
Loop time of 11.3167 on 6 procs for 4 steps with 680496 atoms

Performance: 0.153 ns/day, 157.176 hours/ns, 0.353 timesteps/s
94.8% CPU use with 6 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2.8198     | 2.8671     | 2.9361     |   2.6 | 25.34
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.043877   | 0.10576    | 0.14888    |  12.9 |  0.93
Output  | 8.2269     | 8.2271     | 8.2271     |   0.0 | 72.70
Modify  | 0.10295    | 0.10949    | 0.11351    |   1.3 |  0.97
Other   |            | 0.007253   |            |       |  0.06

Nlocal:         113416 ave      113562 max      113276 min
Histogram: 2 0 0 0 1 1 0 0 0 2
Nghost:         186074 ave      189715 max      183317 min
Histogram: 2 0 1 1 0 0 0 0 1 1
Neighs:    9.12578e+06 ave 9.28337e+06 max 8.95237e+06 min
Histogram: 2 0 0 0 0 1 1 0 0 2
FullNghs:  1.82355e+07 ave 1.85093e+07 max 1.78837e+07 min
Histogram: 2 0 0 0 0 0 1 1 0 2

Total # of neighbors = 1.0941325e+08
Ave neighs/atom = 160.78456
Neighbor list builds = 0
Dangerous builds = 0

region AreaLaser01 delete
group AreaLaser01 delete

next vloopLaser
jump SELF labelLaserPulse
print "Laser loop: ${vloopLaser}"
Laser loop: 5

variable temp01 equal 0.00 #((step/${nrun})%2)*${Height}
variable temp02 equal ${DistanceLaserShot}*(${vloopLaser}-1)+${Height}/2
variable temp02 equal 50*(${vloopLaser}-1)+${Height}/2
variable temp02 equal 50*(5-1)+${Height}/2
variable temp02 equal 50*(5-1)+50/2
variable cx equal ${temp01}+${temp02} #((step/${nrun})%2)*10 + 100*${vloopLaser} - 50
variable cx equal 0+${temp02} 
variable cx equal 0+225 
variable cy equal ${y3}
variable cy equal 450
variable cz equal (${z2}+${z3})/2
variable cz equal (0+${z3})/2
variable cz equal (0+3)/2
region AreaLaser01 ellipsoid ${cx} ${cy} ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 225 ${cy} ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 225 450 ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 225 450 1.5 ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 225 450 1.5 25 ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 225 450 1.5 25 100 ${ellipse_c}
region AreaLaser01 ellipsoid 225 450 1.5 25 100 25
group AreaLaser01 region AreaLaser01
27306 atoms in group AreaLaser01
#delete_atoms group AreaLaser01
displace_atoms AreaLaser01 random 0.05 0.1 0.05 123456
Displacing atoms ...
run ${nrun}
run 4
Per MPI rank memory allocation (min/avg/max) = 287.2 | 307.6 | 345.7 Mbytes
   Step          Temp          PotEng         KinEng        v_Temp02   
       136   2275.6294     -2803392        200166.37      1983.7083    
       137   2291.6438     -2805169.9      201575.01      2078.9965    
       138   2309.5998     -2807126.8      203154.44      2156.9146    
       139   2323.0229     -2808669.9      204335.15      2202.361     
       140   2327.199      -2809366.8      204702.47      2209.9565    
Loop time of 11.3694 on 6 procs for 4 steps with 680496 atoms

Performance: 0.152 ns/day, 157.908 hours/ns, 0.352 timesteps/s
94.3% CPU use with 6 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2.8738     | 2.9096     | 2.9586     |   1.9 | 25.59
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.059205   | 0.10386    | 0.14002    |   9.2 |  0.91
Output  | 8.2385     | 8.2386     | 8.2386     |   0.0 | 72.46
Modify  | 0.10366    | 0.10957    | 0.11317    |   1.2 |  0.96
Other   |            | 0.007762   |            |       |  0.07

Nlocal:         113416 ave      113604 max      113243 min
Histogram: 2 0 0 0 1 1 0 0 0 2
Nghost:         186007 ave      189592 max      183178 min
Histogram: 1 1 0 2 0 0 0 0 1 1
Neighs:    9.10814e+06 ave 9.27701e+06 max 8.92991e+06 min
Histogram: 2 0 0 0 0 2 0 0 0 2
FullNghs:  1.82005e+07 ave 1.84978e+07 max 1.78402e+07 min
Histogram: 2 0 0 0 0 0 2 0 0 2

Total # of neighbors = 1.0920297e+08
Ave neighs/atom = 160.47555
Neighbor list builds = 0
Dangerous builds = 0

region AreaLaser01 delete
group AreaLaser01 delete

next vloopLaser
jump SELF labelLaserPulse
print "Laser loop: ${vloopLaser}"
Laser loop: 6

variable temp01 equal 0.00 #((step/${nrun})%2)*${Height}
variable temp02 equal ${DistanceLaserShot}*(${vloopLaser}-1)+${Height}/2
variable temp02 equal 50*(${vloopLaser}-1)+${Height}/2
variable temp02 equal 50*(6-1)+${Height}/2
variable temp02 equal 50*(6-1)+50/2
variable cx equal ${temp01}+${temp02} #((step/${nrun})%2)*10 + 100*${vloopLaser} - 50
variable cx equal 0+${temp02} 
variable cx equal 0+275 
variable cy equal ${y3}
variable cy equal 450
variable cz equal (${z2}+${z3})/2
variable cz equal (0+${z3})/2
variable cz equal (0+3)/2
region AreaLaser01 ellipsoid ${cx} ${cy} ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 275 ${cy} ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 275 450 ${cz} ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 275 450 1.5 ${ellipse_a} ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 275 450 1.5 25 ${ellipse_b} ${ellipse_c}
region AreaLaser01 ellipsoid 275 450 1.5 25 100 ${ellipse_c}
region AreaLaser01 ellipsoid 275 450 1.5 25 100 25
group AreaLaser01 region AreaLaser01
29491 atoms in group AreaLaser01
#delete_atoms group AreaLaser01
displace_atoms AreaLaser01 random 0.05 0.1 0.05 123456
Displacing atoms ...
run ${nrun}
run 4
Per MPI rank memory allocation (min/avg/max) = 287.2 | 307.6 | 345.7 Mbytes
   Step          Temp          PotEng         KinEng        v_Temp02   
       140   2327.199      -2800039.5      204702.47      2209.9565    
       141   2329.4555     -2800562.4      204900.96      2218.8451    
       142   2337.2249     -2801582.8      205584.36      2265.041     
       143   2346.708      -2802749.2      206418.51      2334.9543    
       144   2353.6475     -2803670.3      207028.91      2408.8234    
Loop time of 11.9845 on 6 procs for 4 steps with 680496 atoms

Performance: 0.144 ns/day, 166.451 hours/ns, 0.334 timesteps/s
93.8% CPU use with 6 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2.9652     | 3.0203     | 3.0582     |   2.1 | 25.20
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.043428   | 0.079503   | 0.13121    |  11.7 |  0.66
Output  | 8.7634     | 8.7635     | 8.7635     |   0.0 | 73.12
Modify  | 0.10491    | 0.11164    | 0.11594    |   1.4 |  0.93
Other   |            | 0.009516   |            |       |  0.08

Nlocal:         113416 ave      113646 max      113213 min
Histogram: 2 0 0 1 1 0 0 0 0 2
Nghost:         185953 ave      189533 max      183053 min
Histogram: 1 1 0 2 0 0 0 0 1 1
Neighs:    9.08941e+06 ave 9.27154e+06 max 8.90749e+06 min
Histogram: 2 0 0 0 1 1 0 0 0 2
FullNghs:  1.81624e+07 ave 1.84864e+07 max 1.77961e+07 min
Histogram: 2 0 0 0 0 1 1 0 0 2

Total # of neighbors = 1.089742e+08
Ave neighs/atom = 160.13937
Neighbor list builds = 0
Dangerous builds = 0

region AreaLaser01 delete
group AreaLaser01 delete

next vloopLaser
jump SELF labelLaserPulse

print "*** Idle run begins***"
*** Idle run begins***
run ${nrunIdle}
run 0
Per MPI rank memory allocation (min/avg/max) = 287.2 | 307.6 | 345.7 Mbytes
   Step          Temp          PotEng         KinEng        v_Temp02   
       144   2353.6475     -2803670.3      207028.91      2408.8234    
Loop time of 8.1e-06 on 6 procs for 0 steps with 680496 atoms

0.0% CPU use with 6 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0          | 0          | 0          |   0.0 |  0.00
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 8.1e-06    |            |       |100.00

Nlocal:         113416 ave      113687 max      113178 min
Histogram: 2 0 0 1 1 0 0 0 0 2
Nghost:         185911 ave      189520 max      182892 min
Histogram: 1 1 0 2 0 0 0 0 1 1
Neighs:    9.07294e+06 ave 9.26502e+06 max 8.88829e+06 min
Histogram: 2 0 0 0 1 1 0 0 0 2
FullNghs:  1.81624e+07 ave 1.84864e+07 max 1.77961e+07 min
Histogram: 2 0 0 0 0 1 1 0 0 2

Total # of neighbors = 1.089742e+08
Ave neighs/atom = 160.13937
Neighbor list builds = 0
Dangerous builds = 0

print "******LAMMPS loop finished******"
******LAMMPS loop finished******


jump script_LAMMPS_Basic.inp labelAMLoop
print "loop: ${loop01}"
loop: 6
next loop01
jump script_LAMMPS_AM.inp
print "===ALL loop finished===="
===ALL loop finished====



Total wall time: 0:08:19
